<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta charset="utf-8"/><meta name="description" content="Personal blog of Yegor Bugayenko about programming, mostly in Java, but also in PHP, JavaScript, Ruby, Python and Lisp"/><meta name="keywords" content="high quality programming, java, java blog, javascript blog, php blog, programming blog, quality of software, ruby blog, software blog, software development blog, software testing, static analysis, yegor bugayenko blog"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="twitter:account_id" content="4503599630178231"/><link rel="icon" type="image/png" href="http://img.yegor256.com/icon-128x128.png"><link rel="shortcut icon" href="//img.yegor256.com/icon-128x128.png"/><link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.yegor256.com/rss.xml"/><link rel="author" href="//plus.google.com/u/0/114792568016408327418?rel=author"/><link rel="stylesheet" href="/css/layout.css?110786a"/><link rel="canonical" href="http://www.yegor256.com/p/2/index.html"/> <script src="/js/search.min.js?110786a"></script><script src="/js/all.js?110786a"></script><title>Yegor Bugayenko About Programming (page 2)</title></head><body><div class="wrapper"> <header class="header"><div> <a href="/about-me.html"> <img src="//img.yegor256.com/yegor-bugayenko.jpg" class="photo" alt="photo"/> </a></div> <nav role="navigation"><ul class="menu"><li><a href="/" title="home page"><i class="ico ico-home"></i></a></li><li><a href="http://www.twitter.com/yegor256" title="follow me in Twitter"><i class="ico ico-tweet"></i></a></li><li><a href="/rss" title="RSS feed"><i class="ico ico-rss"></i></a></li><li><a href="https://github.com/yegor256" title="my Github profile"><i class="ico ico-x-github"></i></a></li><li><a href="http://stackoverflow.com/users/187141/yegor256" title="my StackOverflow profile"><i class="ico ico-x-stackoverflow"></i></a></li><li><a href="https://www.facebook.com/yegor.bugayenko" title="follow me in Facebook"><i class="ico ico-x-facebook"></i></a></li><li><a href="https://plus.google.com/+YegorBugayenko/posts" title="follow me in Google+"><i class="ico ico-x-google"></i></a></li><li><a href="https://www.linkedin.com/in/yegor256" title="my LinkedIn profile"><i class="ico ico-x-linkedin"></i></a></li><li><a href="mailto:yegor@teamed.io" title="yegor@teamed.io"><i class="ico ico-email"></i></a></li></ul> </nav><div id="search"> <input id="search-query" class="field field-text" name="q" placeholder="Search" autocomplete="off"/><div id="search-results" style="display:none"><div class="entries"></div></div></div> <script id="search-results-template" type="text/mustache">
          {{#entries}}
            <div>
              <a href="{{url}}">{{title}}</a>
            </div>
          {{/entries}}
        </script></header></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-06-24T00:00:00+00:00"> 24 June 2014 </time></p> <header><h1> <a href="/2014/06/24/jekyll-github-deploy.html"> Deploy Jekyll to Github Pages </a></h1> </header><p>This blog is written in <a href="http://jekyllrb.com/">Jekyll</a> and is hosted at <a href="https://pages.github.com/">Github Pages</a>. It uses half a dozen custom plugins, which <a href="https://help.github.com/articles/using-jekyll-plugins-with-github-pages">are not allowed there</a>.</p><p>Here is how I deploy it:</p><div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>jgd</code></pre></div><p>That's it. <a href="http://rubygems.org/gems/jgd">jgd</a> is my Ruby gem (stands for "Jekyll Github Deploy"), which does the trick. Here is <a href="https://github.com/yegor256/jekyll-github-deploy/blob/master/bash/deploy.sh">what it does</a>:</p><p> <a href="/2014/06/24/jekyll-github-deploy.html"> read on... </a></p><p class="gray small desktop-only"> 191 words, a minute to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-06-21T00:00:00+00:00"> 21 June 2014 </time></p> <header><h1> <a href="/2014/06/21/casperjs-with-maven.html"> CasperJS Tests in Maven Build </a></h1> </header><p>I'm a big fan of automated testing in general and integration testing in particular. I strongly believe that effort spent on writing tests are direct investments into quality and stability of the product under development.</p><p><a href="http://casperjs.org/">CasperJS</a> is a testing framework on top of <a href="http://phantomjs.org/">PhantomJS</a>, which is a headless browser. Using CasperJS, we can ensure that our application responds correctly to requests sent by a regular web browser.</p><p> <a href="/2014/06/21/casperjs-with-maven.html"> read on... </a></p><p class="gray small desktop-only"> 601 words, three minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-06-20T00:00:00+00:00"> 20 June 2014 </time></p> <header><h1> <a href="/2014/06/20/limit-method-execution-time.html"> Limit Java Method Execution Time </a></h1> </header> <figure class='badge'><a href='http://aspects.jcabi.com'><img src='http://img.jcabi.com/logo-square.svg' style='width:64px' alt='badge'/></a></figure><p>Say, you want to allow a Java method to work for a maximum of five seconds and want an exception to be thrown if the timeframe is exceeded. Here is how you can do it with <a href="http://aspects.jcabi.com">jcabi-aspects</a> and <a href="http://eclipse.org/aspectj/">AspectJ</a>:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Resource</span> <span class="o">{</span>
  <span class="nd">@Timeable</span><span class="o">(</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">5</span><span class="o">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">load</span><span class="o">(</span><span class="n">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div><p> <a href="/2014/06/20/limit-method-execution-time.html"> read on... </a></p><p class="gray small desktop-only"> 329 words, two minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-06-19T00:00:00+00:00"> 19 June 2014 </time></p> <header><h1> <a href="/2014/06/19/avoid-string-concatenation.html"> Avoid String Concatenation </a></h1> </header><p>This is "string concatentation", and it is a bad practice:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// bad practice, don't reuse!</span>
<span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="s">"Hello, "</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">"!"</span><span class="o">;</span></code></pre></div><p>Why? Some may say that it is slow, mostly because parts of the resulting string are copied multiple times. Indeed, on every <code>+</code> operator, <code>String</code> class allocates a new block in memory and copies everything it has into it; plus a suffix being concatenated. This is true, but this is not the point here.</p><p> <a href="/2014/06/19/avoid-string-concatenation.html"> read on... </a></p><p class="gray small desktop-only"> 520 words, two minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-06-09T00:00:00+00:00"> 9 June 2014 </time></p> <header><h1> <a href="/2014/06/09/objects-should-be-immutable.html"> Objects Should Be Immutable </a></h1> </header><p>In object-oriented programming, an object is <a href="http://en.wikipedia.org/wiki/Immutable_object">immutable</a> if its state can't be modified after it is created.</p><p>In Java, a good example of an immutable object is <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html"><code>String</code></a>. Once created, we can't modify its state. We can request that it creates new strings, but its own state will never change.</p><p>However, there are not so many immutable classes in JDK. Take, for example, class <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Date.html"><code>Date</code></a>. It is possible to modify its state using <code>setTime()</code>.</p><p>I don't know why the JDK designers decided to make these two very similar classes differently. However, I believe that the design of a mutable <code>Date</code> has a many flaws, while the immutable <code>String</code> is much more in the spirit of the object-oriented paradigm.</p><p>Moreover, I think that <strong>all classes should be immutable in a perfect object-oriented world</strong>. Unfortunately, sometimes, it is technically not possible due to limitations in JVM. Nevertheless, we should always aim for the best.</p><p>This is an incomplete list of arguments in favor of immutability:</p><ul><li>immutable objects are simpler to construct, test, and use</li><li>truly immutable objects are always thread-safe</li><li>they help to avoid temporal coupling</li><li>their usage is side-effect free (no defensive copies)</li><li>identity mutability problem is avoided</li><li>they always have failure atomicity</li><li>they are much easier to cache</li><li>they prevent NULL references, <a href="/2014/05/13/why-null-is-bad.html">which are bad</a></li></ul><p>Let's discuss the most important arguments one by one.</p><p> <a href="/2014/06/09/objects-should-be-immutable.html"> read on... </a></p><p class="gray small desktop-only"> 1223 words, five minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-06-01T00:00:00+00:00"> 1 June 2014 </time></p> <header><h1> <a href="/2014/06/01/aop-aspectj-java-method-logging.html"> Java Method Logging with AOP and Annotations </a></h1> </header><p>Sometimes, I want to log (through <a href="http://www.slf4j.org">slf4j</a> and <a href="http://logging.apache.org/log4j/2.x/">log4j</a>) every execution of a method, seeing what arguments it receives, what it returns and how much time every execution takes. This is how I'm doing it, with help of <a href="http://eclipse.org/aspectj/">AspectJ</a>, <a href="http://aspects.jcabi.com">jcabi-aspects</a> and Java 6 annotations:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="nd">@Loggable</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">power</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="kt">int</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div><p>This is what I see in log4j output:</p><div class="highlight"><pre><code class="language-text" data-lang="text">[INFO] com.example.Foo #power(2, 10): 1024 in 12μs
[INFO] com.example.Foo #power(3, 3): 27 in 4μs</code></pre></div><p>Nice, isn't it? Now, let's see how it works.</p><p> <a href="/2014/06/01/aop-aspectj-java-method-logging.html"> read on... </a></p><p class="gray small desktop-only"> 975 words, four minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-05-26T00:00:00+00:00"> 26 May 2014 </time></p> <header><h1> <a href="/2014/05/26/amazon-s3-java-oop-adapter.html"> Object-Oriented Java Adapter of Amazon S3 SDK </a></h1> </header> <figure class='badge'><img src='http://img.yegor256.com/2014/05/s3-logo.png' style='width:150px' alt='badge'/></figure><p>I'm a big fan of Amazon Web Services (AWS). I'm using them in almost all of my projects. One of their most popular services is <a href="http://aws.amazon.com/s3/">Simple Storage Service (S3)</a>. It is a storage for binary objects (files) with unique names, accessible through HTTP or RESTful API.</p><p>Using S3 is very simple. You create a "bucket" with a unique name, upload your "object" into the bucket through their web interface or through RESTful API, and then download it again (either through HTTP or the API.)</p><p>Amazon ships the <a href="https://aws.amazon.com/sdkforjava/">Java SDK</a> that wraps their RESTful API. However, this SDK is not object-oriented at all. It is purely imperative and procedural — it just mirrors the API.</p><p>For example, in order to download an existing object <code>doc.txt</code> from bucket <code>test-1</code>, you have to do something like this:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">AWSCredentials</span> <span class="n">creds</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">BasicAWSCredentials</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">secret</span><span class="o">);</span>
<span class="n">AmazonS3</span> <span class="n">aws</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">AmazonS3Client</span><span class="o">(</span><span class="n">creds</span><span class="o">);</span>
<span class="n">S3Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">aws</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">GetObjectRequest</span><span class="o">(</span><span class="s">"test-1"</span><span class="o">,</span> <span class="s">"doc.txt"</span><span class="o">)</span>
<span class="o">);</span>
<span class="n">InputStream</span> <span class="n">input</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">getObjectContent</span><span class="o">();</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="n">IOUtils</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">input</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
<span class="n">input</span><span class="o">.</span><span class="na">close</span><span class="o">();</span></code></pre></div><figure class='badge'><img src='http://img.jcabi.com/logo-square.svg' style='width:64px' alt='badge'/></figure><p>As always, procedural programming has its inevitable disadvantages. To overcome them all, I designed <a href="http://s3.jcabi.com">jcabi-s3</a>, which is a small object-oriented adapter for Amazon SDK. This is how the same object-reading task can be accomplished with <a href="http://s3.jcabi.com">jcabi-s3</a>:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Region</span> <span class="n">region</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Region</span><span class="o">.</span><span class="na">Simple</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">secret</span><span class="o">);</span>
<span class="n">Bucket</span> <span class="n">bucket</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="na">bucket</span><span class="o">(</span><span class="s">"test-1"</span><span class="o">);</span>
<span class="n">Ocket</span> <span class="n">ocket</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="na">ocket</span><span class="o">(</span><span class="s">"doc.txt"</span><span class="o">);</span>
<span class="n">String</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Ocket</span><span class="o">.</span><span class="na">Text</span><span class="o">(</span><span class="n">ocket</span><span class="o">).</span><span class="na">read</span><span class="o">();</span></code></pre></div><p>Why is this approach better? Well, there are a number of obvious advantages.</p><p> <a href="/2014/05/26/amazon-s3-java-oop-adapter.html"> read on... </a></p><p class="gray small desktop-only"> 556 words, three minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-05-23T00:00:00+00:00"> 23 May 2014 </time></p> <header><h1> <a href="/2014/05/23/avoid-java-static-logger.html"> Get Rid of Java Static Loggers </a></h1> </header><p>This is a very common practice in Java (using <a href="http://www.slf4j.org/apidocs/org/slf4j/LoggerFactory.html"><code>LoggerFactory</code></a> from <a href="http://www.slf4j.org/">slf4j</a>):</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">LOGGER</span> <span class="o">=</span>
    <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">Foo</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="n">String</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// save the file</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">Foo</span><span class="o">.</span><span class="na">LOGGER</span><span class="o">.</span><span class="na">isInfoEnabled</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">Foo</span><span class="o">.</span><span class="na">LOGGER</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"file {} saved successfuly"</span><span class="o">,</span> <span class="n">file</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div><p>What's wrong with it? Code duplication.</p><p> <a href="/2014/05/23/avoid-java-static-logger.html"> read on... </a></p><p class="gray small desktop-only"> 148 words, a minute to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-05-21T00:00:00+00:00"> 21 May 2014 </time></p> <header><h1> <a href="/2014/05/21/mysql-maven-plugin.html"> MySQL Maven Plugin </a></h1> </header><p>I was using MySQL in a few Java web projects and found out there was no Maven plugin that would help me to test my DAO classes against a real MySQL server. There are plenty of mechanisms to mock a database persistence layer both in memory and on disc. However, it is always good to make sure that your classes are tested against a database identical to the one you have in production environment.</p><figure class='badge'><a href='http://mysql.jcabi.com'><img src='http://img.jcabi.com/logo-square.svg' style='width:64px' alt='badge'/></a></figure><p>I've created my own Maven plugin, <a href="http://mysql.jcabi.com">jcabi-mysql-maven-plugin</a>, that does exactly two things: starts a MySQL server on <code>pre-integration-test</code> phase and shuts it down on <code>post-integration-test</code>.</p><p> <a href="/2014/05/21/mysql-maven-plugin.html"> read on... </a></p><p class="gray small desktop-only"> 591 words, three minutes to read</p> </section></div><div class="wrapper"> <section class="front"><p> <time datetime="2014-05-18T00:00:00+00:00"> 18 May 2014 </time></p> <header><h1> <a href="/2014/05/18/cloud-autoincrement-counters.html"> Atomic Counters at Stateful.co </a></h1> </header> <figure class='badge'><img src='http://img.yegor256.com/2014/04/dynamodb-logo.jpg' style='width:150px' alt='badge'/></figure><p>Amazon DynamoDB is a great NoSQL cloud database. It is cheap, highly reliable and rather powerful. I'm using it in many web systems.</p><p>There is one feature that it lacks, though — auto-increment attributes.</p><p>Say that you have a table with a list of messages:</p><div class="highlight"><pre><code class="language-text" data-lang="text">+------+----------------------------+
| id   | Attributes                 |
+------+----------------------------+
| 205  | author="jeff", text="..."  |
| 206  | author="bob", text="..."   |
| 207  | author="alice", text="..." |
+------+----------------------------+</code></pre></div><p>Every time you add a new item to the table, a new value of <code>id</code> has to be set. And this has to be done with concurrency in mind. SQL databases like PostgreSQL, Oracle, MySQL and others support auto-increment features. When you add a new record to the table, the value of the primary key is omitted and the server retrieves the next one automatically. If a number of <code>INSERT</code> requests arrive at the same time the server guarantees that the numbers won't be duplicated.</p><p>However, DynamoDB doesn't have this feature. Instead, DynamoDB has <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/WorkingWithItems.html#WorkingWithItems.AtomicCounters">Atomic Counters</a> and <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/WorkingWithItems.html#WorkingWithItems.ConditionalUpdate">Conditional Updates</a>, which are very similar features. Still, they're not exactly the same.</p><p>In case of an atomic counter, you should create a supplementary table and keep the latest value of <code>id</code> in it.</p><p>In case of conditional updates, you should retry a few times in case of collisions.</p><figure class='badge'><img src='http://img.stateful.co/pomegranate.svg' style='width:128px' alt='badge'/></figure><p>To make life easier in a few of my applications, I created a simple web service — <a href="http://www.stateful.co">stateful.co</a>. It provides a simple atomic counter feature through its RESTful API.</p><p> <a href="/2014/05/18/cloud-autoincrement-counters.html"> read on... </a></p><p class="gray small desktop-only"> 360 words, two minutes to read</p> </section></div><div class="wrapper"><div class="pagination"><div style="float:left"> <a href="/"><i class="ico ico-back"></i></a></div> page 2 of 4<div style="float:right"> <a href="/p/3"><i class="ico ico-forward"></i></a></div></div></div></body></html>