<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope itemtype="http://schema.org/WebPage"><head><base href="http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html"/><meta charset="utf-8"/><meta itemprop="name" content="Immutable Objects Are Not Dumb"/><meta itemprop="author" content="Yegor Bugayenko"/><meta itemprop="breadcrumb" content="http://www.yegor256.com"/><meta itemprop="keywords" content="immutable objects, immutable objects advantages, immutable objects are thread safe, immutable objects in java, immutable objects in java example"/><meta itemprop="description" content="Immutable objects are not the same as passive data structures without setters, despite a very common misbelief."/><meta name="description" content="Immutable objects are not the same as passive data structures without setters, despite a very common misbelief."/><meta name="keywords" content="immutable objects, immutable objects advantages, immutable objects are thread safe, immutable objects in java, immutable objects in java example"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="twitter:creator" content="@yegor256"/><meta property="twitter:account_id" content="4503599630178231"/><meta property="og:url" content="http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html"/><meta property="og:site_name" content="yegor256"/><meta property="og:title" content="Immutable Objects Are Not Dumb"/><meta property="og:description" content="Immutable objects are not the same as passive data structures without setters, despite a very common misbelief."/><meta property="og:type" content="article"/><meta property="og:locale" content="en_US"/><meta property="fb:admins" content="10203747823006002"/><meta name="twitter:site" content="@yegor256"/><meta name="twitter:creator" content="@yegor256"/><meta name="twitter:url" content="http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html"/><meta property="article:author" content="https://www.facebook.com/yegor.bugayenko"/><link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="yegor256"/><link rel="shortcut icon" href="/favicon.ico?12e178f"/><link rel="apple-touch-icon" href="/favicon.ico?12e178f"/><link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/><link rel="author" href="http://plus.google.com/u/0/114792568016408327418?rel=author"/><link rel="publisher" href="http://plus.google.com/u/0/114792568016408327418"/><link rel="stylesheet" href="/css/layout.css?12e178f"/><link rel="canonical" href="http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html"/><title>Immutable Objects Are Not Dumb - Yegor Bugayenko</title></head><body><div class="wrapper"> <header class="header"><div> <a href="/about-me.html"> <img src="/images/yegor-bugayenko-192x192.png" class="photo" alt="photo of Yegor Bugayenko"/> </a></div> <nav><ul class="menu social notranslate"><li><a href="http://www.twitter.com/yegor256" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li><li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li><li><a href="https://github.com/yegor256" title="my Github profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li><li><a href="http://stackoverflow.com/users/187141/yegor256" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li><li><a href="https://www.facebook.com/yegor.bugayenko" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li><li><a href="https://plus.google.com/+YegorBugayenko/posts" title="follow me in Google+"><i class="icon icon-googleplus notranslate" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/in/yegor256" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li><li><a href="http://www.youtube.com/user/technoparkcorp" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li><li><a href="mailto:yegor@teamed.io" title="yegor@teamed.io"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"><li> <a href="/best.html" title="best articles to read">12 best articles</a> · <a href="/contents.html" title="blog contents">all 143</a> · <a href="/webinars.html" title="webinars">webinars</a> · <a href="/" title="home page">home page</a></li></ul><ul class="menu" style="color:#81b341"><li>Don't miss the next webinar #6:<br/> <strong><a href="https://plus.google.com/u/0/events/cfvjhha1ltr0lovutlllk9n0cq4">A Few Thoughts About Constructors in OOP</a></strong><br/> 7th of October, at 11am PST</li></ul> </nav><div id="search"> <input id="search-query" class="field field-text" name="q" placeholder="Search" autocomplete="off"/><div id="search-results" style="display:none"><div class="entries"></div></div></div> <script id="search-results-template" type="text/mustache">
          {{#entries}}
            <div>
              <a href="{{url}}">{{title}}</a>
            </div>
          {{/entries}}
        </script></header></div> <section itemscope itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <code>http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html</code></p><h1 itemprop="name">Immutable Objects Are Not Dumb</h1><ul class="subline"><li> <time itemprop="datePublished" datetime="2014-12-22T00:00:00+00:00"> 22 December 2014 </time></li><li><a href='https://github.com/yegor256/blog/commits/master/_posts/2014/dec/2014-12-22-immutable-objects-not-dumb.md'>modified</a> on <time itemprop='dateModified' datetime='2015-06-07T19:52:25+0000'>7 June 2015</time></li><li class="printable">Yegor Bugayenko</li><li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html#disqus_thread">comments</a></li></ul><p class="unprintable"><a href='/tag/oop.html' class='tag notranslate'>oop</a></p><div class="buttons notranslate desktop-only"> <nav class="share" role="navigation"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html" title="Share on Facebook" class="button"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html&amp;text=Immutable+Objects+Are+Not+Dumb" title="Share on Twitter" class="button"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html" title="Share on Google+" class="button"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html" title="Share on LinkedIn" class="button"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html&amp;title=Immutable+Objects+Are+Not+Dumb" title="Share on StumbleUpon" class="button"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html%3F2014-51&amp;title=Immutable+Objects+Are+Not+Dumb" title="Share on Reddit" class="button"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html%3F2014-51&amp;t=Immutable+Objects+Are+Not+Dumb" title="Share on Hacker News" class="button"> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div> </header> <main> <article class="main" itemprop="articleBody"> <iframe class='video video-left' src='https://www.youtube.com/embed/KwP7Ay9Z-hc?controls=2' allowfullscreen></iframe><p>After a few recent posts about immutability, including <a href="/2014/06/09/objects-should-be-immutable.html">"Objects Should Be Immutable"</a> and <a href="/2014/12/09/immutable-object-state-and-behavior.html">"How an Immutable Object Can Have State and Behavior?"</a>, I was surprised by the number of comments saying that I badly misunderstood the idea. Most of those comments stated that an immutable object must always behave the same way — that is what immutability is about. What kind of immutability is it, if a method returns different results each time we call it? This is not how well-known immutable classes behave. Take, for example, <code>String</code>, <code>BigInteger</code>, <code>Locale</code>, <code>URI</code>, <code>URL</code>, <code>Inet4Address</code>, <code>UUID</code>, or wrapper classes for primitives, like <code>Double</code> and <code>Integer</code>. Other comments argued against <a href="/2014/11/20/seven-virtues-of-good-object.html">the very definition</a> of an immutable object as a representative of a mutable real-world entity. How could an immutable object represent a mutable entity? Huh?</p><p>I'm very surprised. This post is going to clarify the definition of an immutable object. First, here is a quick answer. How can an immutable object represent a mutable entity? Look at an immutable class, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html"><code>File</code></a>, and its methods, for example <code>length()</code> and <code>delete()</code>. The class is immutable, according to Oracle documentation, and its methods may return different values each time we call them. An object of class <code>File</code>, being perfectly immutable, represents a mutable real-world entity, a file on disk.</p><figure><img src='http://www.yegor256.com/images/2014/12/usual-suspects-kobayashi.png' style='width:600px' alt='The Usual Suspects (1995) by Bryan Singer'/><figcaption>The Usual Suspects (1995) by Bryan Singer</figcaption></figure><figure class='badge'><a href='http://www.amazon.com/gp/product/0321349601/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0321349601&amp;linkCode=as2&amp;tag=yegor256com-20&amp;linkId=PHMGYYT46MJV2JLO'><img src='http://www.yegor256.com/images/2014/12/java-concurrency-in-practice.png' style='width:100px' alt='badge'/></a></figure><p>In <a href="/2014/06/09/objects-should-be-immutable.html">this post</a>, I said that "an object is immutable if its state can't be modified after it is created." This definition is not mine; it's taken from <a href="http://www.amazon.com/gp/product/0321349601/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0321349601&amp;linkCode=as2&amp;tag=yegor256com-20&amp;linkId=PHMGYYT46MJV2JLO">Java Concurrency in Practice by Goetz et al.</a>, Section 3.4 (by the way, I highly recommend you read it). Now look at this class (I'm using <a href="http://http.jcabi.com">jcabi-http</a> to read and write over HTTP):</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Immutable</span>
<span class="kd">class</span> <span class="nc">Page</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">URI</span> <span class="n">uri</span><span class="o">;</span>
  <span class="n">Page</span><span class="o">(</span><span class="n">URI</span> <span class="n">addr</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">uri</span> <span class="o">=</span> <span class="n">addr</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">load</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">JdkRequest</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">uri</span><span class="o">)</span>
      <span class="o">.</span><span class="na">fetch</span><span class="o">().</span><span class="na">body</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">new</span> <span class="nf">JdkRequest</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">uri</span><span class="o">)</span>
      <span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="s">"PUT"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">body</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">content</span><span class="o">).</span><span class="na">back</span><span class="o">()</span>
      <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div><p>What is the "state" in this class? That's right, <code>this.uri</code> is the state. It uniquely identifies every object of this class, and it is not modifiable. Thus, the class makes only immutable objects. And each object represents a mutable entity of the real world, a web page with a URI.</p><p>There is no contradiction in this situation. The class is perfectly immutable, while the web page it represents is mutable.</p><p>Why do most programmers I have talked to believe that if an underlying entity is mutable, an object is mutable too? I think the answer is simple — they think that objects are data structures with methods. That's why, from this point of view, an immutable object is a data structure that never changes.</p><p>This is where the fallacy is coming from — an object is <strong>not a data structure</strong>. It is a living organism representing a real-world entity inside the object's living environment (a computer program). It does encapsulate some data, which helps to locate the entity in the real world. The encapsulated data is the <strong>coordinates</strong> of the entity being represented. In the case of <code>String</code> or <code>URL</code>, the coordinates are the same as the entity itself, but this is just an isolated incident, not a generic rule.</p><p>An immutable object is not a data structure that doesn't change, even though <code>String</code>, <code>BigInteger</code>, and <code>URL</code> look like one. An object is immutable if and only if it doesn't change the coordinates of the real-world entity it represents. In the <code>Page</code> class above, this means that an object of the class, once instantiated, will never change <code>this.uri</code>. It will always point to the same web page, no matter what.</p><p>And the object doesn't guarantee anything about the behavior of that web page. The page is a dynamic creature of a real world, living its own life. Our object can't promise anything about the page. The only thing it promises is that it will always stay loyal to that page — it will never forget or change its coordinates.</p><p>Conceptually speaking, immutability means loyalty, that's all.</p></article> </main><div class="unprintable"><h2>Related Posts</h2><p>You may also find these posts interesting:</p><ul><li><a href="/2015/09/01/redundant-variables-are-evil.html">Redundant Variables Are Pure Evil</a></li><li><a href="/2015/08/25/fail-fast.html">Need Robust Software? Make It Fragile</a></li><li><a href="/2015/08/18/multiple-return-statements-in-oop.html">Why Many Return Statements Are a Bad Idea in OOP</a></li><li><a href="/2015/07/28/checked-vs-unchecked-exceptions.html">Checked vs. Unchecked Exceptions: The Debate Is Not Over</a></li><li><a href="/2015/07/09/catch-if-cant-otherwise.html">Catch Me If You ... Can't Do Otherwise</a></li></ul></div></div><div class="disqus" role="complementary"><div id="disqus_thread"></div> <a href="http://disqus.com" class="dsq-brlink"> comments powered by <span class="logo-disqus">Disqus</span> </a></div><div class="wrapper"> <footer class="footer"><p> © <span itemprop="author">Yegor Bugayenko</span>, 2014-2015</p> </footer></div></section><script src="http://code.jquery.com/jquery-2.1.0.min.js"></script><script src="/js/ext/search.min.js?12e178f"></script><script src="/js/global.js?12e178f" async defer></script><script src="/js/post.js?12e178f" async defer></script></body></html>