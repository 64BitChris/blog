<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"
  itemscope="" itemtype="http://schema.org/WebPage">
  <head>
    <base href="http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"/>
    <meta charset="utf-8"/>
    <meta itemprop="name" content="Deployment Script vs. Rultor" />
    <meta itemprop="author" content="Yegor Bugayenko" />
    <meta itemprop="breadcrumb" content="http://www.yegor256.com" />
    <meta itemprop="keywords" content="automate deployment, deployment script, fully automated deployment, how to automate deployment process, release script" />
    <meta itemprop="description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them?" />
    <meta name="description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them?" />
    <meta name="keywords" content="automate deployment, deployment script, fully automated deployment, how to automate deployment process, release script" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/>
    <meta name="twitter:creator" content="@yegor256"/>
    <meta property="twitter:account_id" content="4503599630178231" />
    <meta property="og:url" content="http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"/>
    
    <meta property="og:site_name" content="yegor256"/>
    <meta property="og:title" content="Deployment Script vs. Rultor"/>
    <meta property="og:description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them?"/>
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="fb:admins" content="10203747823006002"/>
    <meta name="twitter:site" content="@yegor256"/>
    <meta name="twitter:creator" content="@yegor256"/>
    <meta name="twitter:url" content="http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"/>
    <meta property="article:author" content="https://www.facebook.com/yegor256"/>
    <meta name="p:domain_verify" content="61f09f0ef5db665328827225a3fc11bd"/>
    <link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="yegor256" />
    <link rel="shortcut icon" href="/favicon.ico?4cd1de3"/>
    <link rel="apple-touch-icon" href="/favicon.ico?4cd1de3"/>
    <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/>
    <link rel="author" href="http://plus.google.com/u/0/114792568016408327418?rel=author" />
    <link rel="publisher" href="http://plus.google.com/u/0/114792568016408327418" />
    <link rel="stylesheet" href="/css/layout.css?4cd1de3"/>
    <link rel="stylesheet" href="/css/icons.css?4cd1de3"/>
    <link rel="canonical" href="http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html" />
    <title>Deployment Script vs. Rultor - Yegor Bugayenko
      </title>
    <script src="//code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="/js/global.js?4cd1de3"></script>
  </head>
  <body>
    <div class="wrapper">
      <aside class="header-toggle unprintable" id="header-toggle" title="show head menu"
        onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside>
      <header class="header" id="header">
        <div class="face">
          <a href="/about-me.html" class="sub"><span>subscribe</span></a>
          <a href="/about-me.html">
            <img src="/images/yegor-bugayenko-192x192.png" class="photo"
              alt="photo of Yegor Bugayenko"/>
          </a>
          <a href="/about-me.html" class="hire"><span>hire me</span></a>
        </div>
        <nav>
          <ul class="menu social notranslate">
            <li><a href="http://www.twitter.com/yegor256" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li>
            <li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li>
            <li><a href="https://github.com/yegor256" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li>
            <li><a href="http://stackoverflow.com/users/187141/yegor256" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li>
            <li><a href="https://www.facebook.com/yegor256" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li>
            <li><a href="https://plus.google.com/+YegorBugayenko/posts" title="follow me in Google+"><i class="icon icon-googleplus notranslate" aria-hidden="true"></i></a></li>
            <li><a href="https://www.linkedin.com/in/yegor256" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li>
            <li><a href="https://www.youtube.com/channel/UCr9qCdqXLm2SU0BIs6d_68Q" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li>
            <li><a href="https://www.pinterest.com/yegor256/" title="my Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li>
            <li><a href="mailto:yegor@teamed.io" title="yegor@teamed.io"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li>
          </ul>
          <ul class="menu">
            <li><a href="/" title="home page">home</a></li>
            <li><a href="/best.html" title="best articles to read">12&#160;best</a></li>
            <li><a href="/contents.html" title="blog contents">all&#160;174</a></li>
            <li><a href="/webinars.html" title="webinars">webinars</a></li>
            <li><a href="/talks.html" title="talks">talks</a></li>
            <li><a href="/books.html" title="books">books</a></li>
            <li><a href="/award.html" title="software quality award">award</a></li>
          </ul>
        </nav>
        <div id="search">
          <form method="get" action="https://www.google.com/search" style="position:relative">
            <input name="sitesearch" value="yegor256.com" type="hidden"/>
            <input id="search-query" class="field field-text"
              onfocus="$('#google').css('display', 'inline-block');"
              name="q" placeholder="Search" autocomplete="off"/>
            <span class="desktop-only">
              <input type="image" src="/images/google-search-icon.png" id="google" title="search via Google"
                style="width:3em;height:3em;display:none;position:absolute;margin-left:1em;" alt="search via Google"/>
            </span>
          </form>
          <div id="search-results" style="display: none;">
            <div class="entries"></div>
          </div>
        </div>
        <div class="hot">
          <ul>
            <li>
              <a href="https://plus.google.com/events/cn2nne1qnm8t475bt461igccrg4">Webinar #13</a>
              will be about the role of a Software Architect;
              join us on Apr 6, at 11am PST.
            </li>
            <li>
              Meet me at
              <a href="http://outsource-people.com/en">Outsource People</a> (Minsk/Apr-8),
              <a href="http://kiev2016.agileee.org/">AgileEE</a> (Kiev/Apr-9),
              <a href="http://nextbuild.nl/speakers/yegor-bugayenko/">NextBuild</a> (Eindhoven/Apr-16),
              <a href="http://javapoint.ru/en/">JPoint</a> (Moscow/Apr-22),
              <a href="http://jetconf.by/#/yegor_bugayenko">JETConf</a> (Minsk/Apr-25),
              <a href="http://2016.geecon.org/">GeeCON</a> (Krakow/May-11),
              <a href="http://devitconf.org/">DEVit</a> (Thessaloniki/May-20),
              <a href="http://jeeconf.com/speaker/yegor-bugayenko/">JEEConf</a> (Kiev/May-21),
              and later
              <a href="/talks.html">somewhere else</a>.
            </li>
          </ul>
        </div>
      </header>
    </div>
    <section itemscope="" itemtype="http://schema.org/BlogPosting">

  <div class="wrapper">
    <header>
      <p class="printable">
        <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html&amp;format=svg"
          style="width:125px;height:125px;" alt="QR code"/>
      </p>
      <p class="printable">
        <code>http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html</code>
      </p>
      <h1 itemprop="name">Deployment Script vs. Rultor</h1>
      
      <ul class="subline">
        <li>
          <time itemprop="datePublished" datetime="2014-09-11T00:00:00+00:00">
            11 September 2014
          </time>
        </li>
        
        <li class='unprintable desktop-only'><a href='https://github.com/yegor256/blog/commits/master/_posts/2014/sep/2014-09-11-deployment-script-vs-rultor.md'>modified</a>          on <time itemprop='dateModified' datetime='2016-02-05T03:25:13+0000'>5 February 2016</time></li>
        <li class="printable">Yegor Bugayenko</li>
        <li class="unprintable">
          <i class="icon icon-comments"></i>
          <a href="http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html#disqus_thread">comments</a>
        </li>
      </ul>
      <p class="unprintable"><a href='/tag/rultor.html' class='tag notranslate'>rultor</a> <a href='/tag/devops.html' class='tag notranslate'>devops</a></p>
      <div class="buttons notranslate desktop-only">
        <nav class="share" role="navigation">
          <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"
            title="Share on Facebook" class="button">
            <span class="count count-facebook">0</span>
            <i class="icon icon-facebook notranslate" aria-hidden="true"></i>
          </a>
          <a href="https://twitter.com/share?url=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html&amp;text=Deployment+Script+vs.+Rultor"
            title="Share on Twitter" class="button">
            <span class="count count-twitter">0</span>
            <i class="icon icon-twitter notranslate" aria-hidden="true"></i>
          </a>
          <a href="https://plus.google.com/share?url=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"
            title="Share on Google+" class="button">
            <span class="count count-googleplus">0</span>
            <i class="icon icon-googleplus notranslate" aria-hidden="true"></i>
          </a>
          <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"
            title="Share on LinkedIn" class="button">
            <span class="count count-linkedin">0</span>
            <i class="icon icon-linkedin notranslate" aria-hidden="true"></i>
          </a>
          <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html&amp;title=Deployment+Script+vs.+Rultor"
            title="Share on StumbleUpon" class="button">
            <span class="count count-stumbleupon">0</span>
            <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i>
          </a>
          <a href="http://reddit.com/submit?url=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html%3F2014-36&amp;title=Deployment+Script+vs.+Rultor"
            title="Share on Reddit" class="button">
            <span class="count count-reddit">0</span>
            <i class="icon icon-reddit notranslate" aria-hidden="true"></i>
          </a>
          <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html%3F2014-36&amp;t=Deployment+Script+vs.+Rultor"
            title="Share on Hacker News" class="button">
            <i class="icon icon-hackernews notranslate" aria-hidden="true"></i>
          </a>
        </nav>
      </div>
    </header>
    <main>
      <article class="main" itemprop="articleBody">
        <figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure>

<p>When I explain how <a href="http://www.rultor.com">Rultor</a> automates deployment/release processes,
very often I hear something like:</p>

<blockquote>
<p>But I already have a script that deploys everything automatically.</p>
</blockquote>

<p>This response is very common, so I decided to summarize my three main arguments for
automated Rultor deployment/release processes in one article: 1) isolated docker containers,
2) visibility of logs and 3) security of credentials.</p>

<p>Read about them and see what Rultor gives you on top of <strong>your existing</strong>
deployment script(s).</p>

<!--more-->

<figure><img src='http://cf.jare.io/?u=http%3A%2F%2Fwww.yegor256.com%2Fimages%2F2014%2F09%2Fcharlie-and-chocolate-factory-father.png' style='width:600px;max-width:100%;' alt='Charlie and the Chocolate Factory (2005) by Tim Burton'/><figcaption>Charlie and the Chocolate Factory (2005) by Tim Burton</figcaption></figure>

<p>Before we start with the arguments, let me emphasize that Rultor
is a useful interface to your custom scripts. When you decide
to automate deployment with Rultor, you don&#39;t throw away any of your
existing scripts. You just teach Rultor how to call them.</p>

<h2 id="isolated-docker-containers">Isolated Docker Containers</h2>

<p>The first advantage you get once you start calling your deployment
scripts from Rultor is the <a href="/2014/07/29/docker-in-rultor.html">usage of Docker</a>.
I&#39;m sure you know what <a href="http://www.docker.io">Docker</a> is, but for those who don&#39;t &mdash; it is a
manager of virtual Linux &quot;machines&quot;. It&#39;s a command line script
that you call when you need to run some script in a new virtual machine (aka &quot;container&quot;).
Docker starts the container almost immediately and runs your script. The beauty
of Docker is that every container is a perfectly isolated Linux environment, with its
own file system, memory, processes, etc.</p>

<p>When you tell Rultor to run your deployment script, it starts a new Docker
container and runs your script there. But what benefit does this give me, you ask?</p>

<p>The main benefit is that the container gets destroyed right after your script
is done. This means that you can do all pre-configuration inside the
container without any fear of conflict with your main working
platform. Let me give an example.</p>

<p>I&#39;m developing on MacBook, where I install and remove packages which I need for development.
At the same time, I have a project that, in order to be deployed, requires PHP 5.3, MySQL 5.6, Phing,
PHPUnit, PHPCS and xdebug. Every MacOS version needs to be configured specifically
to get these applications up and running, and it&#39;s a time-consuming job.</p>

<p>I can change laptops, and I can change MacOS versions, but the project stays the same. It
still requires the same set of packages in order to run its deployment script
successfully. And the project is not in active development any more. I simply
don&#39;t need these packages for my day-to-day work, since I&#39;m working with Java more now.
But, when I need to make a minor fix to that PHP project and deploy it,
I have to install all the required PHP packages and configure them.
Only after that can I deploy that minor fix.</p>

<p>It is annoying, to say the least.</p>

<p>Docker gives me the ability to automate all of this together. My <strong>existing</strong> deployment
script will get a preamble, which will install and configure all necessary
PHP-related packages in a clean Ubuntu container. This preamble will be executed
on every run of my deployment script, <strong>inside</strong> a Docker container. For example,
it may look like this:</p>

<p>My deployment script looked like this before I started to use Rultor:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
phing <span class="nb">test</span>
git ftp push --user <span class="s2">&quot;..&quot;</span> --passwd <span class="s2">&quot;..&quot;</span> --syncroot php/src ftp://ftp.example.com/</code></pre></figure>

<p>Just two lines. The first one is a full run of unit tests. The second one
is an FTP deployment to the production server. Very simple. But this script
will only work if PHP 5.3, MySQL, Phing, xdebug, PHPCS and PHPUnit are installed.
Again, it&#39;s a lot of work to install and configure them every time I upgrade
my MacOS or change a laptop.</p>

<p>Needless to say, that if/when someone joins the project and
tries to run my scripts, he/she will have to do this pre-installation
work again.</p>

<p>So, here is a new script, which I&#39;m using now.
It is being executed inside a new Docker container, every time:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
<span class="c"># First, we install all prerequisites</span>
sudo apt-get install -y php5 php5-mysql mysql
sudo apt-get install php-pear
sudo pear channel-discover pear.phpunit.de
sudo pear install phpunit/PHPUnit
sudo pear install PHP_CodeSniffer
sudo pecl install xdebug
sudo pear channel-discover pear.phing.info
sudo pear install phing/phing
<span class="c"># And now the same script I had before</span>
phing <span class="nb">test</span>
git ftp push --user <span class="s2">&quot;..&quot;</span> --passwd <span class="s2">&quot;..&quot;</span> --syncroot php/src ftp://ftp.example.com/</code></pre></figure>

<p>Obviously, running this script on my MacBook (without virtualization) would
cause a lot of trouble. Well, I don&#39;t even have <code>apt-get</code> here :)</p>

<p>Thus, the first benefit that Rultor gives you is an isolation
of your deployment script in its own virtual environment. We have this
mostly thanks to Docker.</p>

<h2 id="visibility-of-logs">Visibility of Logs</h2>

<p>Traditionally, we keep deployment scripts in some <code>~/deploy</code> directory
and run them with a magic set of parameters. In a small project, you
do this yourself and this directory is on your own laptop. In a bigger
project, there is a &quot;deployment&quot; server, that has that magic directory
with a set of scripts that can be executed only by a few trusted
senior developers. I&#39;ve seen this setup many times.</p>

<p>The biggest issue here is traceability. It&#39;s almost impossible to find
out who deployed what and why some particular deployment failed. The senior
deployment gurus simply SSH to the server and run those magic scripts
with magic parameters. Logs are usually lost and problem tracking
is very difficult or impossible.</p>

<p>Rultor offers something different. With Rultor, there is no SSH access
to deployment scripts any more. All scripts stay in the <code>.rultor.yml</code> configuration
file, and you start them by posting messages in your issue tracking system
(for example GitHub, JIRA or Trac). Rultor runs the script and publishes
its full log right to your ticket. The log stays with your project forever.
You can always get back to the ticket you were working with and check
why deployment failed and what instructions were actually executed.</p>

<p>For example, check out this GitHub issue, where I was deploying a new
version of Rultor itself, and failed a few times:
<a href="https://github.com/yegor256/rultor/issues/563">yegor256/rultor#563</a>. All
my failed attempts are protocolled. I can always get back to them and
investigate. For a big project this information is vital.</p>

<p>Thus, the second benefit of Rultor versus a standalone deployment
script is visibility of every single operation.</p>

<h2 id="security-of-credentials">Security of Credentials</h2>

<p>When you have a custom script sitting in your laptop or in that
secret team deployment server, your production credentials stay
close to it. There is just no other way. If your software works with
a database, it has to know login credentials (user name, password, DB name,
port number, etc.). Well, in the worst case, some people just hard
code that information right into the source code.
We aren&#39;t even going to discuss this case, that&#39;s how bad it is.</p>

<p>But let&#39;s say you separate your DB credentials from the source code. You will
have something like a <code>db.properties</code> or <code>db.ini</code> file, which will be attached
to the application right before deployment. You can also keep that file
directly in the production server, which is even better, but not always
possible, especially with PaaS deployments, for example.</p>

<p>A similar problem exists with deployments of artifacts to repositories. Say,
you&#39;re regularly deploying to RubyGems.org. Your <code>~/.gem/credentials</code> will
contain your secret API key.</p>

<p>So, very often, your deployment scripts are accompanied by some files
with sensitive and secure information. And these files have this information
in a plain, open format. No encryption, no protection. Just user names, passwords,
codes and tokens in plain text.</p>

<p>Why is this bad? Well, for a single developer with a single laptop this doesn&#39;t
sound like a problem. Although, I don&#39;t like the idea of losing a laptop somewhere
in an airport with all credentials open and ready to be used. You may
argue that there are disc protection tools, like FileVault for MacOS or
BestCrypt for Windows. Yes, maybe.</p>

<p>But let&#39;s see what happens when we have a team of developers, working together
and sharing those deployment scripts <strong>and</strong> files with credentials. Once you
give access to your deployment scripts to a new member of the team, you have
to share all that sensitive data. There is just no way around it. In order
to use the scripts he/she has to be able to open files with credentials.</p>

<p>This is a problem, if you care about the security of your data.</p>

<p>Rultor solves this problem by offering an on-the-fly GPG decryption of your
sensitive data, right before they are used by your deployment scripts. In
the <code>.rultor.yml</code> configuration file you just say:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">decrypt</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">db.ini</span><span class="p-Indicator">:</span> <span class="s">&quot;repo/db.ini.asc&quot;</span>
<span class="l-Scalar-Plain">deploy</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">ftp put db.ini production</span></code></pre></figure>

<p>Then, you encrypt your <code>db.ini</code> using a Rultor GPG key, and fearlessly
commit <code>db.ini.asc</code> to the repository. Nobody will be able to open and read
that file, except the Rultor server itself, right before running the
deployment script.</p>

<p>Thus, the third benefit of Rultor versus a standalone deployment script
is proper security of sensitive data.</p>

      </article>
    </main>
    
  <div class="unprintable">
    <h2>Related Posts</h2>
    <p>You may also find these posts interesting:</p>
    <ul>
      
        <li>
          <a href="/2015/09/07/maven-repository-amazon-s3.html" data-score="2.0846315677088523">How to Set Up a Private Maven Repository in Amazon S3</a>
        </li>
      
        <li>
          <a href="/2015/04/16/award.html" data-score="1.688368244314427">Software Quality Award, 2015</a>
        </li>
      
        <li>
          <a href="/2016/02/03/design-patterns-and-anti-patterns.html" data-score="1.5425962726169213">Design Patterns and Anti-Patterns, Love and Hate</a>
        </li>
      
        <li>
          <a href="/2016/03/30/jare-instant-free-cdn.html" data-score="1.1729812212992337">Jare.io, an Instant and Free CDN</a>
        </li>
      
        <li>
          <a href="/2015/06/08/deadly-sins-software-project.html" data-score="1.147229527198686">Seven Deadly Sins of a Software Project</a>
        </li>
      
    </ul>
  </div>


    <div class="teamed-banner">
      <a href="http://www.teamed.io">
        <img src="/images/teamed-banner.jpg" alt="teamed banner"/>
      </a>
    </div>
  </div>

  <div class="disqus" role="complementary">
    <div id="disqus_thread" class="disqus-thread"></div>
    <a href="http://disqus.com" class="dsq-brlink">
      comments powered by
      <span class="logo-disqus">Disqus</span>
    </a>
  </div>

  <div class="wrapper">
    <footer class="footer">
      <p>
        &copy;
        <span itemprop="author">Yegor Bugayenko</span>,
        2014-2016
      </p>
    </footer>
  </div>

</section>

<script src="/js/post.js?4cd1de3"></script>
<script src="//a.disquscdn.com/embed.js?4cd1de3"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-1963507-32', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
