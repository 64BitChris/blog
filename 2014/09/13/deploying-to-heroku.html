<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta charset="utf-8"/><meta name="description" content="This tutorial explains how a Java project can be deployed to Heroku in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant"/><meta name="keywords" content="deploy java app to heroku, fast release to heroku, heroku java release, how to deploy to heroku, how to release to heroku, release to heroku"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="twitter:account_id" content="4503599630178231"/><link rel="icon" type="image/png" href="http://img.yegor256.com/icon-128x128.png"><link rel="shortcut icon" href="//img.yegor256.com/icon-128x128.png"/><link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.yegor256.com/rss.xml"/><link rel="author" href="//plus.google.com/u/0/114792568016408327418?rel=author"/><link rel="stylesheet" href="/css/layout.css?d00a953"/><link rel="canonical" href="http://www.yegor256.com/2014/09/13/deploying-to-heroku.html"/> <script src="/js/search.min.js?d00a953"></script><script src="/js/all.js?d00a953"></script><title>Deploying to Heroku, in One Click</title></head><body><div class="wrapper"> <header class="header"><div> <a href="/about-me.html"> <img src="//img.yegor256.com/yegor-bugayenko.jpg" class="photo" alt="photo"/> </a></div> <nav role="navigation"><ul class="menu"><li><a href="/" title="home page"><i class="ico ico-home"></i></a></li><li><a href="http://www.twitter.com/yegor256" title="follow me in Twitter"><i class="ico ico-tweet"></i></a></li><li><a href="/rss" title="RSS feed"><i class="ico ico-rss"></i></a></li><li><a href="https://github.com/yegor256" title="my Github profile"><i class="ico ico-x-github"></i></a></li><li><a href="http://stackoverflow.com/users/187141/yegor256" title="my StackOverflow profile"><i class="ico ico-x-stackoverflow"></i></a></li><li><a href="https://www.facebook.com/yegor.bugayenko" title="follow me in Facebook"><i class="ico ico-x-facebook"></i></a></li><li><a href="https://plus.google.com/+YegorBugayenko/posts" title="follow me in Google+"><i class="ico ico-x-google"></i></a></li><li><a href="https://www.linkedin.com/in/yegor256" title="my LinkedIn profile"><i class="ico ico-x-linkedin"></i></a></li><li><a href="mailto:yegor@teamed.io" title="yegor@teamed.io"><i class="ico ico-email"></i></a></li></ul><ul class="menu"><li> <a href="/best.html" title="best articles to read">12 best articles</a> (out of <a href="/contents.html" title="blog contents">59</a>)</li></ul> </nav><div id="search"> <input id="search-query" class="field field-text" name="q" placeholder="Search" autocomplete="off"/><div id="search-results" style="display:none"><div class="entries"></div></div></div> <script id="search-results-template" type="text/mustache">
          {{#entries}}
            <div>
              <a href="{{url}}">{{title}}</a>
            </div>
          {{/entries}}
        </script></header></div> <section itemscope itemtype="http://schema.org/BlogPosting"><div class="wrapper"><p> <time itemprop="datePublished" datetime="2014-09-13T00:00:00+00:00"> 13 September 2014 </time></p> <header><h1 itemprop="name">Deploying to Heroku, in One Click</h1> </header><p><a href="/tag/rultor.html" class='tag'>rultor</a> <a href="/tag/devops.html" class='tag'>devops</a> <a href="/tag/heroku.html" class='tag'>heroku</a> <a href="/tag/java.html" class='tag'>java</a></p><div class="buttons"> <nav class="share" role="navigation"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2014/09/13/deploying-to-heroku.html" title="Share on Facebook" class="button"> <i class="ico ico-facebook"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2014/09/13/deploying-to-heroku.html&amp;text=Deploying+to+Heroku%2C+in+One+Click" title="Share on Twitter" class="button"> <i class="ico ico-twitter"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2014/09/13/deploying-to-heroku.html" title="Share on Google+" class="button"> <i class="ico ico-google"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2014/09/13/deploying-to-heroku.html" title="Share on LinkedIn" class="button"> <i class="ico ico-linkedin"></i> </a> </nav></div> <main role="main"> <article role="article" itemprop="articleBody"><p>There were a few articles already about our usage of Rultor for automating continuous delivery cycles of Java and Ruby projects, including <a href="http://www.yegor256.com/2014/08/26/publish-to-rubygems.html">Rubygems</a>, <a href="http://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html">CloudBees</a> and <a href="http://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html">MavenCentral</a>.</p><p>This one describes how Heroku deployment can be automated. When I need to deploy a new version of an Aintshy web application, all I do is create one message in a Github ticket. I just say <code>@rultor release 0.1.4</code> and version 0.1.4 gets deployed to Heroku. See Github ticket <a href="https://github.com/aintshy/hub/issues/5">#5</a>.</p><p>You can do the same, with the help of <a href="http://www.rultor.com">Rultor.com</a>, a free hosted DevOps assistant.</p><h2 id="create-heroku-project">Create Heroku Project</h2><p>Create a new project at <a href="http://www.heroku.com">Heroku.com</a>.</p><p>Then install their <a href="https://toolbelt.heroku.com/">command line toolbelt</a>.</p><h2 id="authenticate-at-heroku">Authenticate at Heroku</h2><p>You should authenticate your public SSH key at Heroku, using their command line toolbelt. The process is explained <a href="https://devcenter.heroku.com/articles/authentication">here</a>, but it is not much of a process. You just run <code>heroku login</code> and enter your login credentials. As a result, you will get your existing key (located at <code>~/.ssh/id_rsa.pub</code>) authenticated by Heroku.</p><p>If you didn't have the key before, it will be created automatically.</p><h2 id="encrypt-ssh-key">Encrypt SSH Key</h2><p>Now, encrypt <code>id_rsa</code> and <code>id_rsa.pub</code> (they are in the <code>~/.ssh</code> directory) with a Rultor public key, <code>9AF0FA4C</code>:</p><div class="highlight"><pre><code class="language-xml" data-lang="xml">gpg --keyserver hkp://pool.sks-keyservers.net --recv-keys 9AF0FA4C
gpg --trust-model always -a -e -r 9AF0FA4C id_rsa
gpg --trust-model always -a -e -r 9AF0FA4C id_rsa.pub</code></pre></div><p>You will get two new files <code>id_rsa.asc</code> and <code>id_rsa.pub.asc</code>. Add them to the root directory of your project, commit and push. These files contain your secret information, but only the Rultor server can decrypt them.</p><h2 id="create-rultor-config">Create Rultor Config</h2><p>Create a <code>.rultor.yml</code> file in the root directory of your project (<a href="http://doc.rultor.com/reference.html">reference page</a> explains this format in detail):</p><div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">decrypt</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">id_rsa</span><span class="p-Indicator">:</span> <span class="s">"repo/id_rsa.asc"</span>
  <span class="l-Scalar-Plain">id_rsa.pub</span><span class="p-Indicator">:</span> <span class="s">"repo/id_rsa.pub.asc"</span>
<span class="l-Scalar-Plain">release</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
    <span class="no">mvn versions:set "-DnewVersion=${tag}"</span>
    <span class="no">git commit -am "${tag}"</span>
    <span class="no">mvn clean install -Pqulice --errors</span>
    <span class="no">git remote add heroku git@heroku.com:aintshy.git</span>
    <span class="no">mkdir ~/.ssh</span>
    <span class="no">mv ../id_rsa ../id_rsa.pub ~/.ssh</span>
    <span class="no">chmod -R 600 ~/.ssh/*</span>
    <span class="no">echo -e "Host *\n  StrictHostKeyChecking no\n  UserKnownHostsFile=/dev/null" &gt; ~/.ssh/config</span>
    <span class="no">git push -f heroku $(git symbolic-ref --short HEAD):master</span></code></pre></div><p>You can compare your file with live Rultor <a href="https://github.com/aintshy/hub/blob/master/.rultor.yml">configuration of aintshy/hub</a>.</p><h2 id="run-it!">Run It!</h2><figure class='badge'><a href='http://www.rultor.com'><img src='http://img.rultor.com/logo.svg' style='width:100px' alt='badge'/></a></figure><p>Now it's time to see how it all works. Create a new ticket in the Github issue tracker, and post something like this into it (read more about <a href="http://doc.rultor.com/basics.html">Rultor commands</a>):</p><div class="highlight"><pre><code class="language-text" data-lang="text">@rultor release, tag is `0.1`</code></pre></div><p>You will get a response in a few seconds. The rest will be done by Rultor.</p><p>Enjoy :)</p><p>BTW, if something doesn't work as I've explained, don't hesitate to submit a ticket to the <a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>. I will try to help you.</p></article> </main><h2>Related Posts</h2><p>You may also find these posts interesting:</p><ul><li><a href="/2014/08/25/deploy-to-cloudbees.html">How to Deploy to CloudBees, in One Click</a></li><li><a href="/2014/08/19/how-to-release-to-maven-central.html">How to Release to Maven Central, in One Click</a></li><li><a href="/2014/09/11/deployment-script-vs-rultor.html">Deployment Script vs. Rultor</a></li><li><a href="/2014/08/26/publish-to-rubygems.html">How to Publish to Rubygems, in One Click</a></li><li><a href="/2014/07/31/travis-and-rultor.html">Rultor + Travis</a></li></ul></div><div class="disqus" role="complementary"><div id="disqus_thread"></div> <noscript> Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> <a href="http://disqus.com" class="dsq-brlink"> comments powered by <span class="logo-disqus">Disqus</span> </a></div><div class="wrapper"> <footer class="footer"><p> © <span itemprop="author">Yegor Bugayenko</span>, 2014</p> </footer></div></section></body></html>