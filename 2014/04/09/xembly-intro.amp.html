<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>Xembly, an Assembly for XML</title>
    <link rel="canonical" href="http://www.yegor256.com/2014/04/09/xembly-intro.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "http://www.yegor256.com/2014/04/09/xembly-intro.html"
        },
        "headline": "Xembly, an Assembly for XML",
        "image": {
          "@type": "ImageObject",
          "url": "http://img.teamed.io/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2014-04-09",
        "dateModified": "2014-04-09",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "http://img.teamed.io/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "Xembly is an imperative language for XML data and schema manipulations
that makes XML building much easier and convenient
",
        "keywords": ["xml", "xsl", "xembly", "assembly for xml", "xml modification", "xml manipulation", "xpath"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom="amp-custom">
      body { padding: 2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      .intro { color: red; font-size: .75em; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is an AMP version of the article,
        its original content can be found
        <a href="http://www.yegor256.com/2014/04/09/xembly-intro.html">here</a>.
      </p>
      <h1>Xembly, an Assembly for XML</h1>
      

<p>I use XML in almost every one of my projects. And, despite all the fuss about
JSON/YAML, I honestly
<a href="/2015/11/16/json-vs-xml.html">believe</a>
that XML is one of the greatest languages ever
invented. Also, I believe that the beauty of XML reveals itself when used in
combination with related technologies.</p>

<p>For example, you can expose your data in XML and render it for the end-user
using <a href="http://www.w3.org/Style/XSL/">XSL stylesheet</a>.</p>



<p>Another example would be when you validate the same data, before rendering, to
ensure that the structure is correct. You can do this with the
<a href="http://www.w3.org/TR/xmlschema11-1/">XSD</a> schema. Alternatively, you can pick
specific data elements from the entire document by using
<a href="http://www.w3.org/TR/xpath/">XPath</a> queries.</p>

<p>Essentially, these three technologies, XSL, XSD schema and XPath, are what makes
XML so powerful.</p>

<p>However, there can be times when XML falls short. For instance, imagine you have
an existing document that needs to be modified just slightly. For example, let's
use the following:</p>



<p>The above code represents a list of accounts. Each account has its own <code>id</code> and several
child elements. In our example, we need to find the account belonging to <code>Jeffrey</code>
and increase its balance by <code>500</code>. How would we do this?</p>

<p>Well, there are a few possible solutions:</p>

<ul>
<li>SAX-parse the document, change the balance and save the stream;</li>
<li>DOM-parse it, find the element with XPath, change the value and then print it;</li>
<li>apply a parametrized XSL stylesheet;</li>
<li>apply XQuery small script to make changes</li>
</ul>

<p>All of these methods have their own drawbacks. However, all of them have one particular problem in common — they are very verbose. With each of the above methods, you need at least a page of code to perform this rather simple operation. Furthermore,  if the logic of the operation becomes more complex, the amount of needed code grows much faster than you may expect.</p>

<p>Simply put, XML lacks a tool for primitive data manipulations within
a document. Perhaps, it is this shortcoming that makes XML unpopular with some.</p>

<p>Anyway, here is a tool I created a few month ago: <a href="http://www.xembly.org">Xembly</a>.
It is an imperative language with a few simple directives and resembles <a href="http://en.wikipedia.org/wiki/Assembly_language">Assembly</a>
in style. Thus, the name - Xembly. With Xembly, there are no loops, conditions or variables - just a sequence of directives with arguments.</p>

<p>Let's create a simple example. Say, for instance, we want to add a new account number <code>36</code>
to our list document. The code would look like:</p>



<p>The above should be intuitively clear, but I'll explain just in case. First, the <code>XPATH</code> directive points us
to the element found by the "/accounts" XPath query. This will be our root element. We assume here that
it exists in the document. Therefore, if it is absent, our Xembly script will
fail with a runtime exception.</p>

<p>Next, the <code>ADD</code> directive on line 2 creates a new XML element without any children
or attributes. Then, the <code>ATTR</code> directive sets an attribute for this element. The code then adds
the new child element <code>name</code> and sets its text value to <code>"Donny"</code> using the <code>SET</code> directive. Finally, we move our pointer back to <code>account</code> element using <code>UP</code>, add the <code>balance</code> child element and set its value to <code>"3400"</code>.</p>

<p>Our balance changing task can be expressed in Xembly with the following code:</p>



<p>The <code>XSET</code> directive sets the element text value, similar to <code>SET</code>, but
calculates it beforehand using the provided XPath expression <code>. + 500</code>.</p>

<p>Xembly performs all manipulations through DOM. Consequently, Xembly can be
implemented inside any language that has a built-in DOM implementation.</p>

<p>In the meantime, there is only one implementation of Xembly language
— in Java. Here is how
<a href="/2015/03/26/jaxb-vs-xembly.html">it works</a>:</p>



<p>In this snippet, I'm using a supplementary script builder, <code>Directives</code>, which
enables generation of directives in a fluent way. Then, I use <code>Xembler</code> class,
which is similar to "assembler", to apply all specified directives
to the <code>document</code> object of class <code>org.w3c.dom.Document</code>.</p>

<p>Additionally, Xembly can be used to build XML documents from scratch and as a replacement for traditional DOM building. A quick example:</p>



<p>The above snippet produces the following output:</p>



<p>For me, this appears to be more simple and compact.</p>

<p>As usual, your bug reports and suggestions are always welcomed. Please send to
<a href="https://github.com/yegor256/xembly/issues">GitHub issues</a> :)</p>

    </article>
  </body>
</html>
