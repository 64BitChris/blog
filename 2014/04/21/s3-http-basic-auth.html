<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebPage"> <head> <meta charset="utf-8"/> <meta itemprop="name" content="Basic HTTP Auth for S3 Buckets" /> <meta itemprop="author" content="Yegor Bugayenko" /> <meta itemprop="breadcrumb" content="http://www.yegor256.com" /> <meta itemprop="keywords" content="amazon s3 basic auth, amazon s3 bucket authentication, aws s3 basic auth, basic auth s3, http basic auth" /> <meta itemprop="description" content="Since Amazon S3 doesn&apos;t allow you to secure access to buckets with HTTP Basic Authentication, I&apos;ve created a free cloud service for this purpose " /> <meta name="description" content="Since Amazon S3 doesn&apos;t allow you to secure access to buckets with HTTP Basic Authentication, I&apos;ve created a free cloud service for this purpose " /> <meta name="keywords" content="amazon s3 basic auth, amazon s3 bucket authentication, aws s3 basic auth, basic auth s3, http basic auth" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta property="twitter:account_id" content="4503599630178231" /> <meta property="og:url" content="http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html"/> <meta property="og:site_name" content="yegor256"/> <meta property="og:title" content="Basic HTTP Auth for S3 Buckets"/> <meta property="og:description" content="Since Amazon S3 doesn&apos;t allow you to secure access to buckets with HTTP Basic Authentication, I&apos;ve created a free cloud service for this purpose "/> <meta property="og:type" content="article" /> <meta property="og:locale" content="en_US" /> <meta property="fb:admins" content="10203747823006002"/> <meta name="twitter:site" content="www.yegor256.com"/> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:url" content="http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html"/> <meta property="article:author" content="https://www.facebook.com/yegor256"/> <meta name="p:domain_verify" content="61f09f0ef5db665328827225a3fc11bd"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?4281c78"/> <link rel="apple-touch-icon" href="/favicon.ico?4281c78"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?4281c78"/> <link rel="stylesheet" href="/css/icons.css?4281c78"/> <link rel="canonical" href="http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html" /> <link rel="amphtml" href="http://www.yegor256.com/2014/04/21/s3-http-basic-auth.amp.html" /> <title>Basic HTTP Auth for S3 Buckets - Yegor Bugayenko </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="show head menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub"><span>subscribe</span></a> <a href="/about-me.html"> <img src="//cf.jare.io/?u=http://www.yegor256.com/images/yegor-bugayenko-192x192.png" class="photo" alt="photo of Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a href="https://github.com/yegor256" rel="nofollow" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.facebook.com/yegor256" rel="nofollow" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a href="https://instagram.com/yegor256" rel="nofollow" title="follow me in Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.youtube.com/c/yegor256" rel="nofollow" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.pinterest.com/yegor256/" rel="nofollow" title="my Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a href="https://angel.co/yegor256" rel="nofollow" title="my AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://gitter.im/yegor256/elegantobjects" rel="nofollow" title="Gitter chat"><i class="icon icon-gitter notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="Podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="Podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="blog@yegor256.com"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="home page">home</a></li> <li><a href="/best.html" title="best articles to read">12&#160;best</a></li> <li><a href="/contents.html" title="blog contents">all&#160;210</a></li> <li><a href="/webinars.html" title="webinars">webinars</a></li> <li><a href="/talks.html" title="talks">talks</a></li> <li><a href="/books.html" title="books">books</a></li> <li><a href="/papers.html" title="papers">papers</a></li> <li><a href="/pets.html" title="pets">pets</a></li> <li><a href="/award.html" title="software quality award">award</a></li> <li><a href="/testimonials.html" title="what people say about me">testimonials</a></li> <li><a href="http://ru.yegor256.com/" title="о политике" class="politics">о политике</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search"> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input type="text" id="search-query" class="field field-text" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search" autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="search via Google" alt="search via Google"/> </form></div><div class="hot"><ul> <li> I need help. I want to find sponsors for my <a href="/award.html">Software Quality Award</a>, but don't have time and connections to do that. Would you be interested to <strong>volunteer</strong> and help me? We need more money for the award, to better motivate programmers. Please, <a href="mailto:volunteer@yegor256.com">email</a>. </li> <li> At <a href="/webinars.html">Webinar #20</a> we'll discuss what immutability really is in OOP, by examples in Java and EO, join us on <b>January 4</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div><div itemscope="" itemprop="publisher" itemtype="http://schema.org/Organization"> <meta itemprop="name" content="yegor256.com"/><div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div></div><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html</code></p><h1 itemprop="name headline mainEntityOfPage">Basic HTTP Auth for S3 Buckets</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-04-21T00:00:00+00:00"> 21 April 2014 </time> </li> <li class='unprintable desktop-only'><a href='https://github.com/yegor256/blog/commits/master/_posts/2014/apr/2014-04-21-s3-http-basic-auth.md'>modified</a> on <time itemprop='dateModified' datetime='2016-09-26T19:22:41-0700'>26 September 2016</time></li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><a href='/tag/aws.html' class='tag notranslate'>aws</a> <a href='/tag/s3auth.html' class='tag notranslate'>s3auth</a></p><div class="buttons notranslate desktop-only"> <nav class="share"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html&amp;text=Basic+HTTP+Auth+for+S3+Buckets" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html&amp;title=Basic+HTTP+Auth+for+S3+Buckets" title="Share on StumbleUpon" class="button" rel="nofollow"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html%3F2014-16&amp;title=Basic+HTTP+Auth+for+S3+Buckets" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2014/04/21/s3-http-basic-auth.html%3F2014-16&amp;t=Basic+HTTP+Auth+for+S3+Buckets" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div></header> <main> <article class="main" itemprop="articleBody"> <figure class='badge'><a href='http://www.s3auth.com'><img src='http://img.s3auth.com/logo.png' style='width:200px;max-width:100%;' alt='badge'/></a></figure><p><a href="http://aws.amazon.com/s3/">Amazon S3</a> is a simple and very useful storage of binary objects (aka &quot;files&quot;). To use it, you create a &quot;bucket&quot; there with a unique name and upload your objects.</p><p>Afterwards, AWS guarantees your object will be available for download through their <a href="http://docs.aws.amazon.com/AmazonS3/latest/API/APIRest.html">RESTful API</a>.</p><p>A few years ago, AWS introduced a S3 feature called <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html">static website hosting</a>.</p><p>With static website hosting, you simply turn on the feature and all objects in your bucket become available through public HTTP. This is an awesome feature for hosting static content, such as images, JavaScript files, video and audio content.</p><p>When using the hosting, you need to change the CNAME record in your DNS so that it points to <code>www.example.com.aws.amazon.com</code>. After changing the DNS entry, your static website is available at <code>www.example.com</code> just as it would be normally.</p><p>When using Amazon S3, though, it is not possible to protect your website because the content is purely static. This means you can&#39;t have a login page on the front end. With the service, you can either make your objects either absolutely public&mdash;so that anyone can see them online&mdash;or assign access rights to them&mdash;but only for users connected through RESTful API.</p><p>My use case with the service was a bit more complex, though. I wanted to host my static content as S3 objects. However, I wanted to do this while ensuring only a few people had access to the content using their Web browsers.</p><h2 id="http-basic-authentication">HTTP Basic Authentication</h2><p>The HTTP protocol offers a nice <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">&quot;basic access authentication&quot;</a> feature that doesn&#39;t require any extra site pages.</p><p>When an HTTP request arrives at the server, it doesn&#39;t deliver the content but replies with a 401 status response. This response means literally &quot;I don&#39;t know who you are, please authenticate yourself.&quot;</p><p>The browser shows its native login screen and prompts for a user name and password. After entering the login credentials, they are concatenated, <a href="http://en.wikipedia.org/wiki/Base64">Base64</a> encoded, and added to the next request in <code>Authorization</code> HTTP header.</p><figure class='unprintable'><img src='http://cf.jare.io/?u=http%3A%2F%2Fwww.yegor256.com%2Fimages%2F2014%2F04%2Fs3auth-authentication-dialog.png' itemprop='image' style='width:600px;max-width:100%;' alt='figure'/></figure><p>Now, the browser tries to make another attempt to fetch the same webpage. But, this time, the HTTP request contains a header:</p><figure class="highlight"><pre><code class="language-text" data-lang="text">Authorization: Basic am9lOnNlY3JldA==</code></pre></figure><p>The above is just an example. In the example, the Base64 encoded part means <code>joe:secret</code>, where <code>joe</code> is the user name and <code>secret</code> the password entered by the user.</p><p>This time the server has authentication information and can make a decision whether this user is authenticated (his password matches the server&#39;s records) and authorized (he has permission to access the request webpage).</p><h2 id="s3auth-com"><code>s3auth.com</code></h2><p>Since Amazon doesn&#39;t provide this feature, I decided to create a simple web service, <a href="http://www.s3auth.com">s3auth.com</a>, which stays in front of my Amazon S3 buckets and implements the HTTP-native authentication and authorization mechanism.</p><p>Instead of making my objects public, though, I make them private and point my CNAME record to <code>relay.s3auth.com</code>. HTTP requests from Web browsers then arrive at my server, connect to Amazon S3, retrieve my objects and deliver them back in HTTP responses.</p><p>The server implements authentication and authorization using a special file <code>.htpasswd</code> in the root of my bucket. The format of the <code>.htpasswd</code> file is identical to the one used by <a href="http://httpd.apache.org/docs/2.2/programs/htpasswd.html">Apache HTTP Server</a>&mdash;one user per line. Every line has the name of a user and a hash version of his password.</p><h2 id="implementation">Implementation</h2><p>I made this software open source mostly to guarantee to my users that the server doesn&#39;t store their private data anywhere, but rather acts only as a pass-through service. As a result, the software is on <a href="https://github.com/yegor256/s3auth">GitHub</a>.</p><p>For the sake of privacy and convenience, I use only OAuth2 for user accounts. This means that I don&#39;t know who my users are. I don&#39;t possess their names or emails, but only their account numbers in Facebook, Google Plus or GitHub. Of course, I can find their names using these numbers, but this information is public anyway.</p><p>The server is implemented in Java6. For its hosting, I&#39;m using a single Amazon EC2 <a href="http://aws.amazon.com/ec2/instance-types/">m1.small</a> Ubuntu server. These days, the server seems to work properly and is stable.</p><h2 id="extra-features">Extra Features</h2><p>Besides authentication and authorization, the <a href="http://www.s3auth.com">s3auth.com</a> server can render lists of pages&mdash;just like Apache HTTP Server. If you have a collection of objects in your bucket&mdash;but the <code>index.html</code> file is missing&mdash;Amazon S3 delivers a &quot;page not found&quot; result. Conversely, my server displays a list of objects in the bucket, when no <code>index.html</code> is present, and makes it possible to navigate up or down one folder.</p><p>When your bucket has the versioning feature turned on, you are able to list all versions of any object in the browser. To do this, just add <code>?all-versions</code> to the end of the URL to display the list. Next, click a version to have <a href="http://www.s3auth.com">s3auth.com</a> retrieve and render it.</p><h2 id="traction">Traction</h2><p>I created this service mostly for myself, but apparently I&#39;m not the only with the problems described above. At the moment, <a href="http://www.s3auth.com">s3auth.com</a> hosts over 300 domains and sends through more than 10Mb of data each hour.</p><p>PS. This post explains how <a href="http://www.s3auth.com">s3auth.com</a> can be used as a front-end to your Maven repository: <a href="/2015/09/07/maven-repository-amazon-s3.html">How to Set Up a Private Maven Repository in Amazon S3</a>.</p></article> </main></div><div class="wrapper"> 
  <div class="unprintable">
    <hr/>
    <p>
      You may also find these <strong>related</strong> posts interesting:
      
        <a href="/2016/03/30/jare-instant-free-cdn.html" data-score="2.0395076870313313">Jare.io, an Instant and Free CDN</a>;
      
        <a href="/2015/04/16/award.html" data-score="1.578357798108811">Software Quality Award, 2015</a>;
      
        <a href="/2015/10/17/award-2016.html" data-score="1.4587064285280382">Software Quality Award, 2016</a>;
      
        <a href="/2016/02/03/design-patterns-and-anti-patterns.html" data-score="1.411334733186555">Design Patterns and Anti-Patterns, Love and Hate</a>;
      
        <a href="/2016/08/15/what-is-wrong-object-oriented-programming.html" data-score="1.1111455300047794">What's Wrong With Object-Oriented Programming?</a>;
      
    </p>
  </div>

</div><div class="disqus" role="complementary"><div id="disqus_thread" class="disqus-thread"></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span>, 2014-<span itemprop="copyrightYear">2016</span></p></footer></div></section> <script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?4281c78"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script language="javascript" type="text/javascript"> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script language="javascript1.1" type="text/javascript"> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script language="javascript1.2" type="text/javascript"> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script language="javascript" type="text/javascript"> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> </body> </html>
