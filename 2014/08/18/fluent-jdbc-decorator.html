<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebPage"><head><base href="http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html"/><meta charset="utf-8"/><meta itemprop="name" content="Fluent JDBC Decorator"/><meta itemprop="author" content="Yegor Bugayenko"/><meta itemprop="breadcrumb" content="http://www.yegor256.com"/><meta itemprop="keywords" content="jdbc fluent wrapper, jdbc wrapper, jdbc wrapper library, jdbc wrapper tool, lightweight jdbc wrapper"/><meta itemprop="description" content="jcabi-jdbc is a fluent wrapper of JDBC, making interaction with relational databases easier and much less verbose"/><meta name="description" content="jcabi-jdbc is a fluent wrapper of JDBC, making interaction with relational databases easier and much less verbose"/><meta name="keywords" content="jdbc fluent wrapper, jdbc wrapper, jdbc wrapper library, jdbc wrapper tool, lightweight jdbc wrapper"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="twitter:creator" content="@yegor256"/><meta property="twitter:account_id" content="4503599630178231"/><meta property="og:url" content="http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html"/><meta property="og:site_name" content="yegor256"/><meta property="og:title" content="Fluent JDBC Decorator"/><meta property="og:description" content="jcabi-jdbc is a fluent wrapper of JDBC, making interaction with relational databases easier and much less verbose"/><meta property="og:type" content="article"/><meta property="og:locale" content="en_US"/><meta property="fb:admins" content="10203747823006002"/><meta name="twitter:site" content="@yegor256"/><meta name="twitter:creator" content="@yegor256"/><meta name="twitter:url" content="http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html"/><meta property="article:author" content="https://www.facebook.com/yegor.bugayenko"/><meta name="p:domain_verify" content="61f09f0ef5db665328827225a3fc11bd"/><link rel="search" type="application/opensearchdescription+xml" href="opensearch.xml" title="yegor256"/><link rel="shortcut icon" href="/favicon.ico?d4742be"/><link rel="apple-touch-icon" href="/favicon.ico?d4742be"/><link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/><link rel="author" href="http://plus.google.com/u/0/114792568016408327418?rel=author"/><link rel="publisher" href="http://plus.google.com/u/0/114792568016408327418"/><link rel="stylesheet" href="/css/layout.css?d4742be"/><link rel="canonical" href="http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html"/><title>Fluent JDBC Decorator - Yegor Bugayenko</title></head><body><div class="wrapper"> <aside class="header-toggle" id="header-toggle" title="show head menu" onclick="$('#header').show(),$('#header-toggle').hide()">☰</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html" class="sub"><span>subscribe</span></a> <a href="/about-me.html"> <img src="/images/yegor-bugayenko-192x192.png" class="photo" alt="photo of Yegor Bugayenko"/> </a> <a href="/about-me.html" class="hire"><span>hire me</span></a></div> <nav><ul class="menu social notranslate"><li><a href="http://www.twitter.com/yegor256" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li><li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li><li><a href="https://github.com/yegor256" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li><li><a href="http://stackoverflow.com/users/187141/yegor256" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li><li><a href="https://www.facebook.com/yegor.bugayenko" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li><li><a href="https://plus.google.com/+YegorBugayenko/posts" title="follow me in Google+"><i class="icon icon-googleplus notranslate" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/in/yegor256" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li><li><a href="http://www.youtube.com/user/technoparkcorp" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li><li><a href="https://www.pinterest.com/yegor256/" title="my Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li><li><a href="mailto:yegor@teamed.io" title="yegor@teamed.io"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"><li><a href="/" title="home page">home</a></li><li><a href="/best.html" title="best articles to read">12 best</a></li><li><a href="/contents.html" title="blog contents">all 165</a></li><li><a href="/webinars.html" title="webinars">webinars</a></li><li><a href="/talks.html" title="talks">talks</a></li><li><a href="/books.html" title="books">books</a></li><li><a href="/award.html" title="software quality award">award</a></li></ul> </nav><div id="search"><form action="https://www.google.com/search" style="position:relative"> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input id="search-query" class="field field-text" onfocus="$('#google').css('display','inline-block')" name="q" placeholder="Search" autocomplete="off"/> <span class="desktop-only"> <input type="image" src="/images/google-search-icon.png" id="google" title="search via Google" style="width:3em;height:3em;display:none;position:absolute;margin-left:1em" alt="search via Google"/> </span></form><div id="search-results" style="display:none"><div class="entries"></div></div></div> <script id="search-results-template" type="text/mustache">
          {{#entries}}
            <div>
              <a href="{{url}}">{{title}}</a>
            </div>
          {{/entries}}
        </script><div class="hot"><ul><li> I'll be talking about <a href="http://www.xdsd.org">XDSD</a> at the <a href="https://www.eventbrite.com/e/xdsd-meetings-free-software-development-methodology-tickets-21016102729">The Entrepreneurs' Club</a> in Palo Alto, on Feb 11.</li><li> Meet me in Atlanta on Feb 16, at <a href="https://www.devnexus.com/s/speakers#Yegor_Bugayenko">DevNexus</a>, I'll be talking about chat bots and <a href="http://www.rultor.com">Rultor</a></li><li> <a href="https://plus.google.com/events/ch54gu0ddhb5sj2v9v1hhrfc71s">Webinar #12</a> will be a very practical, with a lot of Java coding, using <strong>Takes Framework</strong>; join us on Mar 2, at 11am PST</li></ul></div> </header></div> <section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html&amp;format=svg" style="width:125px;height:125px" alt="QR code"/></p><p class="printable"> <code>http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html</code></p><h1 itemprop="name">Fluent JDBC Decorator</h1><ul class="subline"><li> <time itemprop="datePublished" datetime="2014-08-18T00:00:00+00:00"> 18 August 2014 </time></li><li class='unprintable desktop-only'><a href='https://github.com/yegor256/blog/commits/master/_posts/2014/aug/2014-08-18-fluent-jdbc-decorator.md'>modified</a> on <time itemprop='dateModified' datetime='2016-02-03T23:34:19+0000'>3 February 2016</time></li><li class="printable">Yegor Bugayenko</li><li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html#disqus_thread">comments</a></li></ul><p class="unprintable"><a href='/tag/jcabi.html' class='tag notranslate'>jcabi</a> <a href='/tag/java.html' class='tag notranslate'>java</a> <a href='/tag/jdbc.html' class='tag notranslate'>jdbc</a></p><div class="buttons notranslate desktop-only"> <nav class="share" role="navigation"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html" title="Share on Facebook" class="button"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html&amp;text=Fluent+JDBC+Decorator" title="Share on Twitter" class="button"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html" title="Share on Google+" class="button"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html" title="Share on LinkedIn" class="button"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html&amp;title=Fluent+JDBC+Decorator" title="Share on StumbleUpon" class="button"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html%3F2014-33&amp;title=Fluent+JDBC+Decorator" title="Share on Reddit" class="button"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2014/08/18/fluent-jdbc-decorator.html%3F2014-33&amp;t=Fluent+JDBC+Decorator" title="Share on Hacker News" class="button"> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div> </header> <main> <article class="main" itemprop="articleBody"> <figure class='badge'><a href='http://aspects.jcabi.com'><img src='http://img.jcabi.com/logo-square.svg' style='width:64px' alt='badge'/></a></figure><p>This is how you fetch text from a SQL table with <a href="http://jdbc.jcabi.com">jcabi-jdbc</a>:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">JdbcSession</span><span class="o">(</span><span class="n">source</span><span class="o">)</span>
  <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">"SELECT name FROM employee WHERE id = ?"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="mi">1234</span><span class="o">)</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="n">SingleOutcome</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">));</span></code></pre></div><p>Simple and straight forward, isn't it? The library simplifies interaction with relational databases via JDBC, avoiding the need to use <a href="/2014/12/01/orm-offensive-anti-pattern.html">ORM</a>.</p><p><a href="http://jdbc.jcabi.com">jcabi-jdbc</a> is a lightweight wrapper of <a href="http://www.oracle.com/technetwork/java/javase/jdbc/index.html">JDBC</a>. It is very convenient to use when you don't need a full-scale <a href="/2014/12/01/orm-offensive-anti-pattern.html">ORM</a> (like Hibernate), but want just to select, insert, or update a few rows in a relational database.</p><p>Every instance of <code>JdbcSession</code> is a "transaction" in a database. You start it by instantiating the class with a single parameter — data source.</p><p>You can obtain the data source from your connection pool. There are many implementations of connection pools. I would recommend that you use <a href="http://jolbox.com/">BoneCP</a>. Below is an example of how you would connect to PostgreSQL:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Cacheable</span><span class="o">(</span><span class="n">forever</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">DataSource</span> <span class="nf">source</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">BoneCPDataSource</span> <span class="n">src</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">BoneCPDataSource</span><span class="o">();</span>
  <span class="n">src</span><span class="o">.</span><span class="na">setDriverClass</span><span class="o">(</span><span class="s">"org.postgresql.Driver"</span><span class="o">);</span>
  <span class="n">src</span><span class="o">.</span><span class="na">setJdbcUrl</span><span class="o">(</span><span class="s">"jdbc:postgresql://localhost/db_name"</span><span class="o">);</span>
  <span class="n">src</span><span class="o">.</span><span class="na">setUser</span><span class="o">(</span><span class="s">"jeff"</span><span class="o">);</span>
  <span class="n">src</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">"secret"</span><span class="o">);</span>
  <span class="k">return</span> <span class="n">src</span><span class="o">;</span>
<span class="o">}</span></code></pre></div><p>Be sure to pay attention to the <code>@Cacheable</code> annotation. <a href="/2014/08/03/cacheable-java-annotation.html">This post</a> explains how it can help you to cache Java method results for some time. Setting the <code>forever</code> attribute to <code>true</code> means that we don't want this method to be called more than once. Instead, we want the connection pool to be created just once, and every second call should return its existing instance (kind of like a <a href="/2016/02/03/design-patterns-and-anti-patterns.html">Singleton pattern</a>).</p><p><a href="http://jdbc.jcabi.com">jcabi-jdbc</a> website explains how you can <a href="http://jdbc.jcabi.com/example-insert.html">insert</a>, <a href="http://jdbc.jcabi.com/example-update.html">update</a>, or delete a row. You can also <a href="http://jdbc.jcabi.com/example-execute.html">execute any SQL statement</a>.</p><p>By default, <code>JdbcSession</code> closes the JDBC connection right after the first select/update/insert operation. Simply put, it is designed to be used mainly for single atomic transactions. However, it is possible to leave the connection open and continue, for example:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">new</span> <span class="nf">JdbcSession</span><span class="o">(</span><span class="n">source</span><span class="o">)</span>
  <span class="o">.</span><span class="na">autocommit</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
  <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">"START TRANSACTION"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">update</span><span class="o">()</span>
  <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">"DELETE FROM employee WHERE name = ?"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"Jeff Lebowski"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">update</span><span class="o">()</span>
  <span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">"INSERT INTO employee VALUES (?)"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"Walter Sobchak"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">Outcome</span><span class="o">.</span><span class="na">VOID</span><span class="o">)</span>
  <span class="o">.</span><span class="na">commit</span><span class="o">();</span></code></pre></div><p>In this example we're executing three SQL statements one by one, leaving connection (and transaction) open until <code>commit()</code> is called.</p></article> </main><div class="unprintable"><h2>Related Posts</h2><p>You may also find these posts interesting:</p><ul><li><a href="/2015/02/05/jcabi-parent-maven-pom.html">Don't Repeat Yourself in Maven POMs; Use Jcabi-Parent</a></li><li><a href="/2015/02/02/xsl-transformations-in-java.html">XSL Transformation in Java: An Easy Way</a></li><li><a href="/2014/11/07/how-immutability-helps.html">How Immutability Helps</a></li><li><a href="/2014/09/02/java-ssh-client.html">Simple Java SSH Client</a></li><li><a href="/2014/08/15/retry-java-method-on-exception.html">How to Retry Java Method Call on Exception</a></li></ul></div><div class="teamed-banner"> <a href="http://www.teamed.io"><img src="/images/teamed-banner.jpg" alt="teamed banner"/></a></div></div><div class="disqus" role="complementary"><div id="disqus_thread" class="disqus-thread"></div> <a href="http://disqus.com" class="dsq-brlink"> comments powered by <span class="logo-disqus">Disqus</span> </a></div><div class="wrapper"> <footer class="footer"><p> © <span itemprop="author">Yegor Bugayenko</span>, 2014-2015</p> </footer></div></section><script src="http://code.jquery.com/jquery-2.1.0.min.js"></script><script src="/js/global.js?d4742be"></script><script src="/js/post.js?d4742be"></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-1963507-32","auto"),ga("send","pageview")</script></body></html>