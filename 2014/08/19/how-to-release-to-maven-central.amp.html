<!DOCTYPE html>
<html âš¡ lang="en">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="canonical" href="http://www.yegor256.com" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <h1></h1>
    <p>When I release a new version of <a href="http://aspects.jcabi.com">jcabi-aspects</a>,
a Java open source library, to Maven Central, it takes 30 seconds of my time.
Maybe even less. Recently, I released version 0.17.2. You can see
how it all happened, in <a href="https://github.com/jcabi/jcabi-aspects/issues/80">GitHub issue #80</a>:</p>



<p>As you see, I gave a command to <a href="http://www.rultor.com">Rultor</a>,
and it released a new version to Maven central. I didn&#39;t do anything else.</p>

<p>Now let&#39;s see how you can do the same. How you can configure your project
so that the release of its new version to Maven Central
takes just a few seconds of your time.</p>

<!--more-->

<p>By the way, I assume that you&#39;re hosting your project in GitHub. If not,
this entire tutorial won&#39;t work. If you are still not in GitHub, I would
strongly recommend moving there.</p>

<h2 id="prepare-your-pom">Prepare Your POM</h2>

<p>Make sure your <code>pom.xml</code> contains all elements required by Sonatype,
explained in <a href="http://central.sonatype.org/pages/requirements.html">Central Sync Requirements</a>.
We will deploy to Sonatype, and they will synchronize all JAR (and not only)
artifacts to Maven Central.</p>

<h2 id="register-a-project-with-sonatype">Register a Project With Sonatype</h2>

<p>Create an account in <a href="https://issues.sonatype.org/">Sonatype JIRA</a>
and raise a ticket, asking to approve your <code>groupId</code>. This
<a href="http://central.sonatype.org/pages/ossrh-guide.html">OSSRH Guide</a>
explains this step in more detail.</p>

<h2 id="create-and-distribute-a-gpg-key">Create and Distribute a GPG Key</h2>

<p>Create a GPG key and distribute it, as explained in this
<a href="http://central.sonatype.org/pages/working-with-pgp-signatures.html">Working with PGP Signatures</a>
article.</p>

<p>When this step is done, you should have two files:
<code>pubring.gpg</code> and <code>secring.gpg</code>.</p>

<h2 id="create-settings-xml">Create settings.xml</h2>

<p>Create <code>settings.xml</code>, next to the two <code>.gpg</code> files created in the previous step:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;settings&gt;</span>
  <span class="nt">&lt;profiles&gt;</span>
    <span class="nt">&lt;profile&gt;</span>
      <span class="nt">&lt;id&gt;</span>foo<span class="nt">&lt;/id&gt;</span> <span class="c">&lt;!-- give it the name of your project --&gt;</span>
      <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;gpg.homedir&gt;</span>/home/r<span class="nt">&lt;/gpg.homedir&gt;</span>
        <span class="nt">&lt;gpg.keyname&gt;</span>9A105525<span class="nt">&lt;/gpg.keyname&gt;</span>
        <span class="nt">&lt;gpg.passphrase&gt;</span>my-secret<span class="nt">&lt;/gpg.passphrase&gt;</span>
      <span class="nt">&lt;/properties&gt;</span>
    <span class="nt">&lt;/profile&gt;</span>
  <span class="nt">&lt;/profiles&gt;</span>
  <span class="nt">&lt;servers&gt;</span>
    <span class="nt">&lt;server&gt;</span>
      <span class="nt">&lt;id&gt;</span>oss.sonatype.org<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;username&gt;</span><span class="c">&lt;!-- Sonatype JIRA user name --&gt;</span><span class="nt">&lt;/username&gt;</span>
      <span class="nt">&lt;password&gt;</span><span class="c">&lt;!-- Sonatype JIRA pwd --&gt;</span><span class="nt">&lt;/password&gt;</span>
    <span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;/servers&gt;</span>
<span class="nt">&lt;/settings&gt;</span></code></pre></figure>

<p>In this example, <code>9A105525</code> is the ID of your public key, and <code>my-secret</code>
is the pass phrase you have used while generating the keys.</p>

<h2 id="encrypt-security-assets">Encrypt Security Assets</h2>

<p>Now, encrypt these three files with a <a href="https://github.com/yegor256/rultor-remote">rultor remote</a>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml">$ gem install rultor
$ rultor encrypt -p me/test pubring.gpg
$ rultor encrypt -p me/test secring.gpg
$ rultor encrypt -p me/test settings.xml</code></pre></figure>

<p>Instead of <code>me/test</code> you should use the name of your GitHub project.</p>

<p>You will get three new files: <code>pubring.gpg.asc</code>, <code>secring.gpg.asc</code>
and <code>settings.xml.asc</code>. Add them to the root directory of your project,
commit and push. The files contain your secret information,
but only the Rultor server can decrypt them.</p>

<h2 id="add-sonatype-repositories">Add Sonatype Repositories</h2>

<p>I would recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">jcabi-parent</a>, as
a parent pom for your project. This will make many further steps
unnecessary. If you&#39;re using jcabi-parent, skip this step.</p>

<p>However, if you don&#39;t use jcabi-parent, you should add these two repositories
to your <code>pom.xml</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;project&gt;</span>
  [...]
  <span class="nt">&lt;distributionManagement&gt;</span>
    <span class="nt">&lt;repository&gt;</span>
      <span class="nt">&lt;id&gt;</span>oss.sonatype.org<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;url&gt;</span>https://oss.sonatype.org/service/local/staging/deploy/maven2/<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/repository&gt;</span>
    <span class="nt">&lt;snapshotRepository&gt;</span>
      <span class="nt">&lt;id&gt;</span>oss.sonatype.org<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;url&gt;</span>https://oss.sonatype.org/content/repositories/snapshots<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/snapshotRepository&gt;</span>
  <span class="nt">&lt;/distributionManagement&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure>

<h2 id="configure-gpg-plugin">Configure GPG Plugin</h2>

<p>Again, I&#39;d recommend using <a href="http://parent.jcabi.com">jcabi-parent</a>,
which configures this plugin automatically. If you&#39;re using it, skip this step.</p>

<p>Otherwise, add this plugin to your <code>pom.xml</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-gpg-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.5<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>sign-artifacts<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>verify<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>sign<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure>

<h2 id="configure-versions-plugin">Configure Versions Plugin</h2>

<p>Once again, I recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">http://parent.jcabi.com</a>. It
configures all required plugins out-of-the-box. If you&#39;re using it, skip this step.</p>

<p>Otherwise, add this plugin to your <code>pom.xml</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>versions-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;generateBackupPoms&gt;</span>false<span class="nt">&lt;/generateBackupPoms&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure>

<h2 id="configure-sonatype-plugin">Configure Sonatype Plugin</h2>

<p>Yes, you&#39;re right, <a href="/2015/02/05/jcabi-parent-maven-pom.html">http://parent.jcabi.com</a> will help
you here as well. If you&#39;re using it, skip this step too.</p>

<p>Otherwise, add these four plugins to your <code>pom.xml</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-deploy-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;skip&gt;</span>true<span class="nt">&lt;/skip&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-source-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>package-sources<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>jar<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-javadoc-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>package-javadoc<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>jar<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.sonatype.plugins<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>nexus-staging-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.6<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;extensions&gt;</span>true<span class="nt">&lt;/extensions&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;serverId&gt;</span>oss.sonatype.org<span class="nt">&lt;/serverId&gt;</span>
          <span class="nt">&lt;nexusUrl&gt;</span>https://oss.sonatype.org/<span class="nt">&lt;/nexusUrl&gt;</span>
          <span class="nt">&lt;description&gt;</span>${project.version}<span class="nt">&lt;/description&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>deploy-to-sonatype<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>deploy<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>deploy<span class="nt">&lt;/goal&gt;</span>
              <span class="nt">&lt;goal&gt;</span>release<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure>

<h2 id="create-rultor-configuration">Create Rultor Configuration</h2>

<p>Create a <code>.rultor.yml</code> file in the root directory of your project
(<a href="http://doc.rultor.com/reference.html">reference page</a>
explains this format in details):</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">decrypt</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">settings.xml</span><span class="p-Indicator">:</span> <span class="s">&quot;repo/settings.xml.asc&quot;</span>
  <span class="l-Scalar-Plain">pubring.gpg</span><span class="p-Indicator">:</span> <span class="s">&quot;repo/pubring.gpg.asc&quot;</span>
  <span class="l-Scalar-Plain">secring.gpg</span><span class="p-Indicator">:</span> <span class="s">&quot;repo/secring.gpg.asc&quot;</span>
<span class="l-Scalar-Plain">release</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span> <span class="p-Indicator">|</span>
    <span class="no">mvn versions:set &quot;-DnewVersion=${tag}&quot;</span>
    <span class="no">git commit -am &quot;${tag}&quot;</span>
    <span class="no">mvn clean deploy -Pjcabi --settings /home/r/settings.xml</span></code></pre></figure>

<p>You can compare your file with live Rultor
<a href="https://github.com/jcabi/jcabi-aspects/blob/master/.rultor.yml">configuration of jcabi-aspects</a>.</p>

<h2 id="run-it">Run It!</h2>



<p>Now it&#39;s time to see how it all works. Create a new ticket in the
GitHub issue tracker, and post something like that into it
(read more about <a href="http://doc.rultor.com/basics.html">Rultor commands</a>):</p>



<p>You will get a response in a few seconds. The rest will be done by Rultor.</p>

<p>Enjoy :)</p>

<p>BTW, if something doesn&#39;t work as I&#39;ve explained, don&#39;t hesitate to
submit a ticket to
<a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>.
I will try to help you.</p>

<p>Yeah, forgot to mention, Rultor is also doing two important things. First,
it creates a GitHub release with a proper description. Second, it
posts a tweet about the release, which you can retweet, to make
an announcement to your followers. Both features are very convenient
for me. For example:</p>

<blockquote class="twitter-tweet" lang="en"><p>DynamoDB Local Maven Plugin, 0.7.1 released <a href="https://t.co/C3KULouuKS">https://t.co/C3KULouuKS</a></p>&mdash; rultor.com (@rultors) <a href="https://twitter.com/rultors/statuses/501617747269517312">August 19, 2014</a></blockquote>

<script async='' src="http://platform.twitter.com/widgets.js" charset="utf-8"></script>

  </body>
</html>
