<!DOCTYPE html>
<html ⚡ lang="en">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="canonical" href="http://www.yegor256.com" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type='application/ld+json'>
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": ""
        },
        "headline": "",
        "image": {
          "@type": "ImageObject",
          "url": "http://img.teamed.io/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "",
        "dateModified": "",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "description": "",
        "keywords": [""]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <h1></h1>
    <p>This is &quot;string concatenation&quot;, and it is a bad practice:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// bad practice, don&#39;t reuse!</span>
<span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Hello, &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;!&quot;</span><span class="o">;</span></code></pre></figure>

<p>Why? Some may say that it is slow, mostly because parts of
the resulting string are copied multiple times. Indeed, on every <code>+</code> operator,
<code>String</code> class allocates a new block in memory and copies everything
it has into it; plus a suffix being concatenated. This is true,
but this is not the point here.</p>

<!--more-->

<p>Actually, I don&#39;t think performance in this case is a big issue.
Moreover, there were <a href="http://stackoverflow.com/questions/925423">multiple experiments</a>
showing that concatenation is not that slow when compared to other
string building methods and sometimes is even faster.</p>

<p>Some say that concatenated strings are not localizable because in
different languages text blocks in a phrase may be positioned
in a different order. The example above can&#39;t be translated to,
say, Russian, where we would want to put a name in front of
&quot;привет&quot;. We will need to localize the entire block of code,
instead of just translating a phrase.</p>

<p>However, my point here is different. I strongly recommend
avoiding string concatenation because it is <strong>less readable</strong>
than other methods of joining texts together.</p>

<p>Let&#39;s see these alternative methods. I&#39;d recommend three of them (in order of preference):
<code>String.format()</code>,
Apache <code>StringUtils</code> and
Guava <code>Joiner</code>.</p>

<p>There is also a <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html"><code>StringBuilder</code></a>,
but I don&#39;t find it as attractive as <code>StringUtils</code>. It is a useful
builder of strings, but not a proper replacer or string
concatenation tool when readability is important.</p>

<h2 id="string-format">String.format()</h2>

<p><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29"><code>String.format()</code></a>
is my favorite option. It makes text phrases easy to understand
and modify. It is a static utility method that mirrors
<a href="http://www.cplusplus.com/reference/cstdio/sprintf/"><code>sprintf()</code></a> from C.
It allows you to build a string using a pattern and substitutors:</p>



<p>When the text is longer, the advantages of the formatter become
much more obvious. Look at this ugly code:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Dear &quot;</span> <span class="o">+</span> <span class="n">customer</span><span class="o">.</span><span class="na">name</span><span class="o">()</span>
  <span class="o">+</span> <span class="s">&quot;, your order #&quot;</span> <span class="o">+</span> <span class="n">order</span><span class="o">.</span><span class="na">number</span><span class="o">()</span>
  <span class="o">+</span> <span class="s">&quot; has been shipped at &quot;</span> <span class="o">+</span> <span class="n">shipment</span><span class="o">.</span><span class="na">date</span><span class="o">()</span>
  <span class="o">+</span> <span class="s">&quot;!&quot;</span><span class="o">;</span></code></pre></figure>

<p>This one looks much more beautiful doesn&#39;t it:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span>
  <span class="s">&quot;Dear %1$s, your order #%2$d has been shipped at %3$tR!&quot;</span><span class="o">,</span>
  <span class="n">customer</span><span class="o">.</span><span class="na">name</span><span class="o">(),</span> <span class="n">order</span><span class="o">.</span><span class="na">number</span><span class="o">(),</span> <span class="n">shipment</span><span class="o">.</span><span class="na">date</span><span class="o">()</span>
<span class="o">);</span></code></pre></figure>

<p>Please note that I&#39;m using argument indexes in order to make
the pattern even more localizable. Let&#39;s say, I want
to translate it to Greek. This is how will it look:</p>



<p>I&#39;m changing the order of substitutions in the pattern,
but not in the actual list of methods arguments.</p>

<h2 id="apache-stringutils-join">Apache <code>StringUtils.join()</code></h2>

<p>When the text is rather long (longer than your screen width),
I would recommend that you use the utility class
<a href="http://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html"><code>StringUtils</code></a>
from Apache <a href="http://commons.apache.org/proper/commons-lang/">commons-lang3</a>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.apache.commons.lang3.StringUtils</span><span class="o">;</span>
<span class="n">String</span> <span class="n">xml</span> <span class="o">=</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">join</span><span class="o">(</span>
  <span class="s">&quot;&lt;?xml version=&#39;1.0&#39;?&gt;&quot;</span><span class="o">,</span>
  <span class="s">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="o">,</span>
  <span class="s">&quot;&lt;p&gt;This is a test XHTML document,&quot;</span><span class="o">,</span>
  <span class="s">&quot; which would look ugly,&quot;</span><span class="o">,</span>
  <span class="s">&quot; if we would use a single line,&quot;</span>
  <span class="s">&quot; or string concatenation or String format().&lt;/p&gt;&quot;</span>
  <span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>
<span class="o">);</span></code></pre></figure>

<p>The need to include an additional JAR dependency
to your classpath may be considered a downside with this method
(get its latest versions in <a href="http://search.maven.org/">Maven Central</a>):</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.commons<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>commons-lang3<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<h2 id="guava-joiner">Guava Joiner</h2>

<p>Similar functionality is provided by
<a href="http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Joiner.html"><code>Joiner</code></a>
from Google <a href="https://code.google.com/p/guava-libraries/">Guava</a>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">com.google.common.base.Joiner</span><span class="o">;</span>
<span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">Joiner</span><span class="o">.</span><span class="na">on</span><span class="o">(</span><span class="err">&#39;&#39;</span><span class="o">).</span><span class="na">join</span><span class="o">(</span>
  <span class="s">&quot;WE HAVE BUNNY.\n&quot;</span><span class="o">,</span>
  <span class="s">&quot;GATHER ONE MILLION DOLLARS IN UNMARKED &quot;</span><span class="o">,</span>
  <span class="s">&quot;NON-CONSECUTIVE TWENTIES.\n&quot;</span><span class="o">,</span>
  <span class="s">&quot;AWAIT INSTRUCTIONS.\n&quot;</span><span class="o">,</span>
  <span class="s">&quot;NO FUNNY STUFF&quot;</span>
<span class="o">);</span></code></pre></figure>

<p>It is a bit less convenient than <code>StringUtils</code> since you always
have to provide a joiner (character or a string placed between text blocks).</p>

<p>Again, a dependency is required in this case:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.google.guava<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>guava<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure>

<p>Yes, in most cases, all of these methods work slower than
a plain simple concatenation. However, I strongly believe
that <strong>computers are cheaper than people</strong>. What I mean is that
the time spent by programmers understanding and modifying ugly
code is much more expensive than a cost of an additional server
that will make beautifully written code work faster.</p>

<p>If you know any other methods of avoiding string concatenation,
please comment below.</p>

  </body>
</html>
