<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>Try. Finally. If. Not. Null.</title>
    <link rel="canonical" href="http://www.yegor256.com/2016/03/22/try-finally-if-not-null.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "http://www.yegor256.com/2016/03/22/try-finally-if-not-null.html"
        },
        "headline": "Try. Finally. If. Not. Null.",
        "image": {
          "@type": "ImageObject",
          "url": "http://img.teamed.io/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2016-03-22",
        "dateModified": "2016-03-22",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "http://img.teamed.io/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "Opening a resource inside a try/catch block and then
finally checking for null is such a typical and
annoying mistake.
",
        "keywords": ["close stream java", "java try catch", "java finally", "java close stream in finally", "java close stream try catch"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom="amp-custom">
      body { padding: .5em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      .intro { color: red; font-size: .75em; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version of the article,
        its original content can be found
        <a href="http://www.yegor256.com/2016/03/22/try-finally-if-not-null.html">here</a>.
      </p>
      <h1>Try. Finally. If. Not. Null.</h1>
      <p>There is a very typical mistake in pre-Java7 "try/finally" scenario,
which I keep seeing in so many code reviews. I just have to write about it.
Java7 introduced a solution, but it doesn't cover all situations.
Sometimes we need to deal with non-<code>AutoCloseable</code> resources. Let's
open and close them correctly, please.</p>





<p>This is how it looks (assuming we are in Java 6):</p>



<p>I already wrote about <a href="/2014/05/13/why-null-is-bad.html"><code>null</code></a>
and its evil nature. Here it comes again. If you just follow the rule
of "not using NULL anywhere ever," this code would need an immediate
refactoring. Its correct version will look like this:</p>



<p>There is no <code>null</code> anymore and it's very clean. Isn't it?</p>

<p>There are situations when opening the resource itself throws <code>IOException</code>
and we can't put it outside of <code>try/catch</code>. In that case, we have to have
<strong>two</strong> <code>try/catch</code> blocks:</p>



<p>But there should be no <code>null</code>, never!</p>

<p>The presence of <code>null</code> in Java code is a clear indicator of code smell. Something
is not right if you have to use <code>null</code>. The only place where the presence of <code>null</code>
is justified is where we're using third-party APIs or JDK. They may return
<code>null</code> sometimes because... well, their design is bad. We have
no other option but to do <code>if(x==null)</code>. But that's it. No other places
are good for <code>null</code>.</p>

    </article>
  </body>
</html>
