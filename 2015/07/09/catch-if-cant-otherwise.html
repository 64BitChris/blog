<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" itemprop="description" content="Catching an exception must be your last resort; a properly designed application would catch exceptions in one place only. " /> <meta name="keywords" itemprop="keywords" content="catch exception, catch exception java, exception catching, exceptions java, when to catch exceptions" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="og:site_name" itemprop="author" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:card" content="summary_large_image" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Catch Me If You ... Can't Do Otherwise"/> <meta name="twitter:description" property="og:description" content="Catching an exception must be your last resort; a properly designed application would catch exceptions in one place only. "/> <meta name="twitter:url" property="og:url" content="http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c4f32ca"/> <link rel="apple-touch-icon" href="/favicon.ico?c4f32ca"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c4f32ca"/> <link rel="stylesheet" href="/css/icons.css?c4f32ca"/> <link rel="canonical" href="http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html" itemprop="url" /> <link rel="amphtml" href="http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.amp.html" /> <title itemprop='name'>Catch Me If You ... Can't Do Otherwise </title> <meta name='og:image' content='https://cf.jare.io/?u=http://www.yegor256.com/images/2015/07/catch-me-if-you-can.jpg'/><meta name='twitter:image' content='https://cf.jare.io/?u=http://www.yegor256.com/images/2015/07/catch-me-if-you-can.jpg'/><meta name='og:image:width' content='1200'/> <meta name='twitter:image:width' content='1200'/><meta name='og:image:height' content='716'/> <meta name='twitter:image:height' content='716'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="show head menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub"><span>subscribe</span></a> <a href="/about-me.html"> <img src="//cf.jare.io/?u=http://www.yegor256.com/images/yegor-bugayenko-192x192.png" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="follow me in Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="my Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="my AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://gitter.im/yegor256/elegantobjects" rel="nofollow" title="Gitter chat"><i class="icon icon-gitter notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="Podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="Podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="blog@yegor256.com"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="home page">home</a></li> <li><a href="/best.html" title="best articles to read">12&#160;best</a></li> <li><a href="/contents.html" title="blog contents">all&#160;219</a></li> <li><a href="/webinars.html" title="webinars">webinars</a></li> <li><a href="/talks.html" title="talks">talks</a></li> <li><a href="/books.html" title="books">books</a></li> <li><a href="/papers.html" title="papers">papers</a></li> <li><a href="/pets.html" title="pets">pets</a></li> <li><a href="/award.html" title="software quality award">award</a></li> <li><a href="/testimonials.html" title="what people say about me">testimonials</a></li> <li><a href="http://ru.yegor256.com/" title="о политике" class="politics">о политике</a></li> <li><a href="/video-qa.html" title="video Q&amp;A">video Q&amp;A</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search" autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="search via Google" alt="search via Google"/> </form></div><div class="hot"><ul> <li> At <a href="/webinars.html">Webinar #22</a> we'll discuss the problem of "naked" data in OOP and possible options to neutralize their negative effect, join us on <b>March 1</b>, at 11am PST. </li> <li> Meet me at <a href="https://events.epam.com/events/kyiv-jug-feb28">JUG.ua</a> (Kiev/Feb-28), <a href="http://kh.pmday.org/yehor-buhayenko2017s/">PMDay</a> (Kharkiv/Mar-4), <a href="http://agiledays.ru/">AgileDays</a> (Moscow/Mar-23), <a href="http://www.devonsummit.com/speakers/">DevOn Summit</a> (Delft/Mar-30), <a href="https://2017.jbreak.ru/speakers/yegor-bugayenko/">JBreak</a> (Novosibirsk/Apr-4), <a href="https://jpoint.ru/en/talks/java-annotations-are-a-big-mistake/">JPoint</a> (Moscow/Apr-7), <a href="http://rigadevdays.lv/speakers/46/">RigaDevDays</a> (Riga/May-15), and later <a href="/talks.html">somewhere else</a>. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div itemprop="review" itemscope="" itemtype="http://schema.org/Review"> <meta itemprop="author" content="Yegor Bugayenko"> <meta itemprop="itemReviewed" content="http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html"><div itemprop="reviewRating" itemscope="" itemtype="http://schema.org/Rating"> <meta itemprop="ratingValue" content="9"/> <meta itemprop="bestRating" content="10"/></div></div><div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div><div itemscope="" itemprop="publisher" itemtype="http://schema.org/Organization"> <meta itemprop="name" content="yegor256.com"/><div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div></div><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html</code></p><h1 itemprop="name headline mainEntityOfPage">Catch Me If You ... Can't Do Otherwise</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2015-07-09T00:00:00+00:00"> 9 July 2015 </time> </li> <li class="desktop-only" itemprop="locationCreated">Dallas, TX</li> <li class='unprintable desktop-only'><a href='https://github.com/yegor256/blog/commits/master/_posts/2015/jul/2015-07-09-catch-if-cant-otherwise.md'>Modified</a> on <time itemprop='dateModified' datetime='2017-02-17T22:23:59+0200'>17 February 2017</time></li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><a href='/tag/oop.html' class='tag notranslate'><img src='/images/books/elegant-objects/cactus.svg' alt='OOP'/>oop</a></p><div class="buttons notranslate desktop-only"> <nav class="share"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html&amp;text=Catch+Me+If+You+...+Can%27t+Do+Otherwise" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html&amp;title=Catch+Me+If+You+...+Can%27t+Do+Otherwise" title="Share on StumbleUpon" class="button" rel="nofollow"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html%3F2015-27&amp;title=Catch+Me+If+You+...+Can%27t+Do+Otherwise" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2015/07/09/catch-if-cant-otherwise.html%3F2015-27&amp;t=Catch+Me+If+You+...+Can%27t+Do+Otherwise" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div></header> <main> <article class="main" itemprop="articleBody"><div ><p>I don&#39;t know whether it&#39;s an anti-pattern or just a common and very popular mistake, but I see it everywhere and simply must write about it. I&#39;m talking about <strong>exception catching without <a href="/2015/12/01/rethrow-exceptions.html">re-throwing</a></strong>. I&#39;m talking about something like this Java code:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">try</span> <span class="o">{</span>
  <span class="n">stream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure> <figure class='jb_picture'><img itemprop='image' alt='front image' src='https://cf.jare.io/?u=http://www.yegor256.com/images/2015/07/catch-me-if-you-can.jpg' longdesc='#1bda0b7e'/><figcaption id='1bda0b7e'>Catch Me If You Can (2002) by Steven Spielberg</figcaption></figure><p>Pay attention: I don&#39;t have anything against this code:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">try</span> <span class="o">{</span>
  <span class="n">stream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="sc">&#39;X&#39;</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="n">ex</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>This is called <a href="https://en.wikipedia.org/wiki/Exception_chaining"><em>exception chaining</em></a> and is a perfectly valid construct.</p><p>So what is wrong with catching an exception and logging it? Let&#39;s try to look at the bigger picture first. We&#39;re talking about object-oriented programming&mdash;this means we&#39;re dealing with objects. Here is how an object (its class, to be exact) would look:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="kd">class</span> <span class="nc">Wire</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">OutputStream</span> <span class="n">stream</span><span class="o">;</span>
  <span class="n">Wire</span><span class="o">(</span><span class="kd">final</span> <span class="n">OutputStream</span> <span class="n">stm</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stream</span> <span class="o">=</span> <span class="n">stm</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">(</span><span class="kd">final</span> <span class="kt">int</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">stream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Here is how I&#39;m using this class:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">new</span> <span class="nf">Wire</span><span class="o">(</span><span class="n">stream</span><span class="o">).</span><span class="na">send</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span></code></pre></figure><p>Looks nice, right? I don&#39;t need to worry about that <code>IOException</code> when I&#39;m calling <code>send(1)</code>. It will be handled internally, and if it occurs, the stacktrace will be logged. But this is a totally wrong way of thinking, and it&#39;s inherited from languages without exceptions, like C.</p><aside class='quote'>An exception collects as much information as possible about the error and floats it up</aside><p>Exceptions were invented to simplify our design by moving the entire error handling code away from the main logic. Moreover, we&#39;re not just moving it away but also concentrating it in one place&mdash;in the <code>main()</code> method, the entry point of the entire app.</p><p>The primary purpose of an exception is to collect as much information as possible about the error and float it up to the highest level, where the user is capable of doing something about it. Exception chaining helps even further by allowing us to extend that information on its way up. We are basically putting our bubble (the exception) into a bigger bubble every time we catch it and <a href="/2015/12/01/rethrow-exceptions.html">re-throw</a>. When it hits the surface, there are many bubbles, each remaining inside another like a Russian doll. The original exception is the smallest bubble.</p><p>When you catch an exception without re-throwing it, you basically pop the bubble. Everything inside it, including the original exception and all other bubbles with the information inside them, are in your hands. You don&#39;t let me see them. You use them somehow, but I don&#39;t know how. You&#39;re doing something behind the scenes, hiding potentially important information.</p><p>If you&#39;re hiding that from me, I can&#39;t promise my user that I will be honest with him and openly report a problem when it occurs. I simply can&#39;t trust your <code>send()</code> method anymore, and my user will not trust me.</p><p>By catching exceptions without re-throwing them, you&#39;re basically breaking the chain of trust between objects.</p><p>My suggestion is to catch exceptions as seldom as possible, and every time you catch them, <a href="/2015/12/01/rethrow-exceptions.html">re-throw</a>.</p><p>Unfortunately, the design of Java goes against this principle in many places. For example, Java has checked and un-checked exceptions, while there should only be checked ones in my opinion (the ones you must catch or declare as throwable). Also, Java allows multiple exception types to be declared as throwable in a single method&mdash;yet another mistake; stick to declaring just one type. Also, there is a generic <code>Exception</code> class at the top of the hierarchy, which is also wrong in my opinion. Besides that, some built-in classes don&#39;t allow any checked exceptions to be thrown, like <code>Runnable.run()</code>. There are many other problems with exceptions in Java.</p><p>But try to keep this principle in mind and your code will be cleaner: <code>catch</code> only if you have no other choice.</p><p>P.S. Here is how the class should look:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="kd">class</span> <span class="nc">Wire</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">OutputStream</span> <span class="n">stream</span><span class="o">;</span>
  <span class="n">Wire</span><span class="o">(</span><span class="kd">final</span> <span class="n">OutputStream</span> <span class="n">stm</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stream</span> <span class="o">=</span> <span class="n">stm</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">send</span><span class="o">(</span><span class="kd">final</span> <span class="kt">int</span> <span class="n">data</span><span class="o">)</span>
    <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure></div></article> </main></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><div id="disqus_thread" class="disqus-thread"></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2017</span></p></footer></div></section> <script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c4f32ca"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script language="javascript" type="text/javascript"> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script language="javascript1.1" type="text/javascript"> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script language="javascript1.2" type="text/javascript"> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script language="javascript" type="text/javascript"> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> </body> </html>
