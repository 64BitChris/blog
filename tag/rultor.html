<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="rultor: more about rultor in this collection of recently published articles... the list is updated every few weeks." /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="rultor"/> <meta name="twitter:description" property="og:description" content="rultor: more about rultor in this collection of recently published articles... the list is updated every few weeks."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/tag/rultor"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/tag/rultor" /> <link rel="amphtml" href="https://www.yegor256.com/tag/rultor" /> <title>rultor </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header itemprop="name"><h1>11 posts about rultor</h1></header> <article itemprop="articleBody"> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="AppVeyor is a continuous integration platform for Windows projects; Rultor is a Docker based DevOps assistant for merge, release and deploy operations; they can work together. " /> <meta name="keywords" content="appveyor, appveyor and rultor, appveyor devops, appveyor merge pull request, windows builds with docker" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2015-03-29 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="How AppVeyor Helps Me to Validate Pull Requests Before Rultor Merges Them"/> <meta name="twitter:description" property="og:description" content="AppVeyor is a continuous integration platform for Windows projects; Rultor is a Docker based DevOps assistant for merge, release and deploy operations; they can work together. "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html" /> <link rel="amphtml" href="https://www.yegor256.com/2015/03/29/rultor-with-appveyor.amp.html" /> <title>How AppVeyor Helps Me to Validate Pull Requests Before Rultor Merges Them </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html</code></p><h1 itemprop="name headline mainEntityOfPage">How AppVeyor Helps Me to Validate Pull Requests Before Rultor Merges Them</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2015-03-29T00:00:00+00:00"> 29 March 2015 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2015/03/29/rultor-with-appveyor.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html&amp;text=How+AppVeyor+Helps+Me+to+Validate+Pull+Requests+Before+Rultor+Merges+Them" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html%3F2015-13&amp;title=How+AppVeyor+Helps+Me+to+Validate+Pull+Requests+Before+Rultor+Merges+Them" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2015/03/29/rultor-with-appveyor.html%3F2015-13&amp;t=How+AppVeyor+Helps+Me+to+Validate+Pull+Requests+Before+Rultor+Merges+Them" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class='badge'><a href='http://www.appveyor.com'><img src='https://www.yegor256.com/images/2014/10/appveyor.png' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p><a href="http://www.appveyor.com">AppVeyor</a> is a great cloud <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a> service that builds Windows projects. <a href="http://www.rultor.com">Rultor</a> is a DevOps assistant, which automates release, merge and deploy operations, using Docker containers. These posts explain how Rultor works and what it&#39;s for: <a href="/2014/07/24/rultor-automated-merging.html">Rultor.com, a Merging Bot</a> and <a href="/2014/07/21/read-only-master-branch.html">Master Branch Must Be Read-Only</a>.</p><figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>The problem is that Rultor is running all scripts inside Docker containers and Docker can&#39;t build Windows projects. The only and the best logical solution is to trigger AppVeyor before running all other scripts in Docker. If AppVeyor gives a green light, we continue with our usual in-Docker script. Otherwise, we fail the entire build. Below I explain how this automation was configured in <a href="http://www.takes.org">Takes framework</a>.</p><p>First, I got a token from my AppVeyor account (at the time of writing it was <a href="https://ci.appveyor.com/api-token">here</a>). I created a text file <code>curl-appveyor.cfg</code> with this content (it&#39;s not my real token inside, just an example):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>--silent
--header &quot;Authorization: Bearer 1hdmsfbs7xccb9x6g1y4&quot;
--header &quot;Content-Type: application/json&quot;
--header &quot;Accept: application/json&quot;</code></pre></figure><p>Then, I encrypted this file, using <a href="https://github.com/yegor256/rultor-remote"><code>rultor</code></a> command line tool:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ rultor encrypt -p yegor256/takes curl-appveyor.cfg</code></pre></figure><p>The file I created was called <a href="https://github.com/yegor256/takes/blob/master/curl-appveyor.cfg.asc"><code>curl-appveyor.cfg.asc</code></a>. I committed and pushed into <a href="https://github.com/yegor256/takes">yegor256/takes</a> GitHub repository.</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ git add curl-appveyor.cfg.asc
$ git commit -am <span class="s1">&#39;CURL config for Appveyor&#39;</span>
$ git push origin master</code></pre></figure><p>Then, I configured AppVeyor &quot;pinging&quot; from Docker script. This is what I did in <a href="https://github.com/yegor256/takes/blob/master/.rultor.yml"><code>.rultor.yml</code></a>:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>decrypt:
  curl-appveyor.cfg: &quot;repo/curl-appveyor.cfg.asc&quot;
merge:
  script: |-
    ver=$(curl -K ../curl-appveyor.cfg \
      --data &quot;{accountName: &#39;yegor256&#39;,
        projectSlug: &#39;takes&#39;,
        pullRequestId: &#39;${pull_id}&#39;}&quot; \
      https://ci.appveyor.com/api/builds | jq -r &#39;.version&#39;)
    while true; do
      status=$(curl -K ../curl-appveyor.cfg \
        https://ci.appveyor.com/api/projects/yegor256/takes/build/${ver} \
        | jq -r &#39;.build.status&#39;)
      if [ &quot;${status}&quot; == &quot;success&quot; ]; then break; fi
      if [ &quot;${status}&quot; == &quot;failed&quot; ]; then
        echo &quot;see https://ci.appveyor.com/project/yegor256/takes/build/${ver}&quot;
        exit 1
      fi
      echo &quot;waiting for AppVeyor build ${ver}: ${status}&quot;
      sleep 5s
    done
    mvn clean install</code></pre></figure><p>There is no magic here, it&#39;s very simple. First, I start a new build using <code>/api/builds</code> end-point of <a href="http://www.appveyor.com/docs/api/projects-builds#start-build-of-pull-request-github-only">AppVeyor REST API</a>. <code>${pull_id}</code> is an environment variable that is coming from Rultor, it contains an integer number of current pull request.</p><p>I&#39;m using <a href="http://stedolan.github.io/jq/">jq</a> in order to parse AppVeyor JSON output.</p><p>Once the build is started, I&#39;m getting its unique <code>version</code> and start looping to check its status. I&#39;m waiting for <code>success</code> or <code>failed</code>. Anything else will mean that the build is still in progress and I should keep looping.</p><p>You can see how it works in this pull request, for example: <a href="https://github.com/yegor256/takes/pull/93">yegor256/takes#93</a>.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="This tutorial explains how a Java project can be deployed to Heroku in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant " /> <meta name="keywords" content="deploy java app to heroku, fast release to heroku, heroku java release, how to deploy to heroku, how to release to heroku, release to heroku" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-09-13 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Deploying to Heroku, in One Click"/> <meta name="twitter:description" property="og:description" content="This tutorial explains how a Java project can be deployed to Heroku in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/09/13/deploying-to-heroku.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/09/13/deploying-to-heroku.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/09/13/deploying-to-heroku.amp.html" /> <title>Deploying to Heroku, in One Click </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/09/13/deploying-to-heroku.html</code></p><h1 itemprop="name headline mainEntityOfPage">Deploying to Heroku, in One Click</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-09-13T00:00:00+00:00"> 13 September 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/09/13/deploying-to-heroku.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html&amp;text=Deploying+to+Heroku%2C+in+One+Click" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html%3F2014-36&amp;title=Deploying+to+Heroku%2C+in+One+Click" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/09/13/deploying-to-heroku.html%3F2014-36&amp;t=Deploying+to+Heroku%2C+in+One+Click" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>There were a few articles already about our usage of Rultor for automating continuous delivery cycles of Java and Ruby projects, including <a href="http://www.yegor256.com/2014/08/26/publish-to-rubygems.html">RubyGems</a>, <a href="http://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html">CloudBees</a> and <a href="http://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html">Maven Central</a>.</p><p>This one describes how Heroku deployment can be automated. When I need to deploy a new version of an Aintshy web application, all I do is create one message in a GitHub ticket. I just say <code>@rultor release 0.1.4</code> and version 0.1.4 gets deployed to Heroku. See GitHub ticket <a href="https://github.com/aintshy/hub/issues/5">#5</a>.</p><p>You can do the same, with the help of <a href="http://www.rultor.com">Rultor.com</a>, a free hosted DevOps assistant.</p><h2 id="create-heroku-project">Create Heroku Project</h2><p>Create a new project at <a href="http://www.heroku.com">Heroku.com</a>.</p><p>Then install their <a href="https://toolbelt.heroku.com/">command line tool-belt</a>.</p><h2 id="authenticate-at-heroku">Authenticate at Heroku</h2><p>You should authenticate your public SSH key at Heroku, using their command line tool-belt. The process is explained <a href="https://devcenter.heroku.com/articles/authentication">here</a>, but it is not much of a process. You just run <code>heroku login</code> and enter your login credentials. As a result, you will get your existing key (located at <code>~/.ssh/id_rsa.pub</code>) authenticated by Heroku.</p><p>If you didn&#39;t have the key before, it will be created automatically.</p><h2 id="encrypt-ssh-key">Encrypt SSH Key</h2><p>Now, encrypt <code>id_rsa</code> and <code>id_rsa.pub</code> (they are in the <code>~/.ssh</code> directory) with a <a href="https://github.com/yegor256/rultor-remote">rultor remote</a>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>$ gem install rultor
$ rultor encrypt -p me/test id_rsa
$ rultor encrypt -p me/test id_rsa.pub</code></pre></figure><p>Instead of <code>me/test</code> use the name of your GitHub project.</p><p>You will get two new files <code>id_rsa.asc</code> and <code>id_rsa.pub.asc</code>. Add them to the root directory of your project, commit and push. These files contain your secret information, but only the Rultor server can decrypt them.</p><h2 id="create-rultor-configuration">Create Rultor Configuration</h2><p>Create a <code>.rultor.yml</code> file in the root directory of your project (<a href="http://doc.rultor.com/reference.html">reference page</a> explains this format in detail):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>decrypt:
  id_rsa: &quot;repo/id_rsa.asc&quot;
  id_rsa.pub: &quot;repo/id_rsa.pub.asc&quot;
release:
  script: |
    mvn versions:set &quot;-DnewVersion=${tag}&quot;
    git commit -am &quot;${tag}&quot;
    mvn clean install -Pqulice --errors
    git remote add heroku git@heroku.com:aintshy.git
    mkdir ~/.ssh
    mv ../id_rsa ../id_rsa.pub ~/.ssh
    chmod -R 600 ~/.ssh/*
    echo -e \
      &quot;Host *\n  StrictHostKeyChecking no\n  UserKnownHostsFile=/dev/null&quot; \
      &gt; ~/.ssh/config
    git push -f heroku $(git symbolic-ref --short HEAD):master</code></pre></figure><p>You can compare your file with live Rultor <a href="https://github.com/aintshy/hub/blob/master/.rultor.yml">configuration of aintshy/hub</a>.</p><h2 id="run-it">Run It!</h2><figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>Now it&#39;s time to see how it all works. Create a new ticket in the GitHub issue tracker, and post something like this into it (read more about <a href="http://doc.rultor.com/basics.html">Rultor commands</a>):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>@rultor release, tag is `0.1`</code></pre></figure><p>You will get a response in a few seconds. The rest will be done by Rultor.</p><p>Enjoy :)</p><p>BTW, if something doesn&#39;t work as I&#39;ve explained, don&#39;t hesitate to submit a ticket to the <a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>. I will try to help you.</p><p>PS. I would also recommend to versionalize artifacts through <code>MANIFEST.MF</code> and use <a href="/2014/07/03/how-to-read-manifest-mf.html">jcabi-manifests</a> to read them later.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them? " /> <meta name="keywords" content="automate deployment, deployment script, fully automated deployment, how to automate deployment process, release script" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-09-11 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Deployment Script vs. Rultor"/> <meta name="twitter:description" property="og:description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them? "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.amp.html" /> <title>Deployment Script vs. Rultor </title> <meta name='og:image' content='https://www.yegor256.com/images/2014/09/charlie-and-chocolate-factory-father.png'/><meta name='twitter:image' content='https://www.yegor256.com/images/2014/09/charlie-and-chocolate-factory-father.png'/><meta name='og:image:width' content='850'/> <meta name='twitter:image:width' content='850'/><meta name='og:image:height' content='474'/> <meta name='twitter:image:height' content='474'/><meta name='twitter:card' content='summary'/><meta name='twitter:image:alt' content='Charlie and the Chocolate Factory (2005) by Tim Burton'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html</code></p><h1 itemprop="name headline mainEntityOfPage">Deployment Script vs. Rultor</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-09-11T00:00:00+00:00"> 11 September 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html&amp;text=Deployment+Script+vs.+Rultor" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html%3F2014-36&amp;title=Deployment+Script+vs.+Rultor" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html%3F2014-36&amp;t=Deployment+Script+vs.+Rultor" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>When I explain how <a href="http://www.rultor.com">Rultor</a> automates deployment/release processes, very often I hear something like:</p><blockquote><p>But I already have a script that deploys everything automatically.</p></blockquote><p>This response is very common, so I decided to summarize my three main arguments for automated Rultor deployment/release processes in one article: 1) isolated docker containers, 2) visibility of logs and 3) security of credentials.</p><p>Read about them and see what Rultor gives you on top of <strong>your existing</strong> deployment script(s).</p><figure class='jb_picture'><img itemprop='image' alt='Charlie and the Chocolate Factory (2005) by Tim Burton' src='/images/2014/09/charlie-and-chocolate-factory-father.png' longdesc='#2ee88f79'/><figcaption id='2ee88f79'>Charlie and the Chocolate Factory (2005) by Tim Burton</figcaption></figure><p>Before we start with the arguments, let me emphasize that Rultor is a useful interface to your custom scripts. When you decide to automate deployment with Rultor, you don&#39;t throw away any of your existing scripts. You just teach Rultor how to call them.</p><h2 id="isolated-docker-containers">Isolated Docker Containers</h2><aside class='youtube'> <a href='https://www.youtube.com/watch?v=NflR7DKwxDY'><div class='box'> <img src='https://i.ytimg.com/vi/NflR7DKwxDY/mqdefault.jpg' alt='YouTube video #NflR7DKwxDY'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Deployment Scripts Are Dead. Meet Rultor.; 26 May 2016.</div></aside><p>The first advantage you get once you start calling your deployment scripts from Rultor is the <a href="/2014/07/29/docker-in-rultor.html">usage of Docker</a>. I&#39;m sure you know what <a href="http://www.docker.io">Docker</a> is, but for those who don&#39;t---it is a manager of virtual Linux &quot;machines.&quot; It&#39;s a command line script that you call when you need to run some script in a new virtual machine (aka &quot;container&quot;). Docker starts the container almost immediately and runs your script. The beauty of Docker is that every container is a perfectly isolated Linux environment, with its own file system, memory, processes, etc.</p><p>When you tell Rultor to run your deployment script, it starts a new Docker container and runs your script there. But what benefit does this give me, you ask?</p><p>The main benefit is that the container gets destroyed right after your script is done. This means that you can do all pre-configuration inside the container without any fear of conflict with your main working platform. Let me give an example.</p><p>I&#39;m developing on MacBook, where I install and remove packages which I need for development. At the same time, I have a project that, in order to be deployed, requires PHP 5.3, MySQL 5.6, Phing, PHPUnit, PHPCS and xdebug. Every MacOS version needs to be configured specifically to get these applications up and running, and it&#39;s a time-consuming job.</p><p>I can change laptops, and I can change MacOS versions, but the project stays the same. It still requires the same set of packages in order to run its deployment script successfully. And the project is not in active development any more. I simply don&#39;t need these packages for my day-to-day work, since I&#39;m working with Java more now. But, when I need to make a minor fix to that PHP project and deploy it, I have to install all the required PHP packages and configure them. Only after that can I deploy that minor fix.</p><p>It is annoying, to say the least.</p><p>Docker gives me the ability to automate all of this together. My <strong>existing</strong> deployment script will get a preamble, which will install and configure all necessary PHP-related packages in a clean Ubuntu container. This preamble will be executed on every run of my deployment script, <strong>inside</strong> a Docker container. For example, it may look like this:</p><p>My deployment script looked like this before I started to use Rultor:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="ch">#!/bin/bash</span>
phing <span class="nb">test</span>
git ftp push --user <span class="s2">&quot;..&quot;</span> <span class="se">\</span>
  --passwd <span class="s2">&quot;..&quot;</span> <span class="se">\</span>
  --syncroot php/src <span class="se">\</span>
  ftp://ftp.example.com/</code></pre></figure><p>Just two lines. The first one is a full run of unit tests. The second one is an FTP deployment to the production server. Very simple. But this script will only work if PHP 5.3, MySQL, Phing, xdebug, PHPCS and PHPUnit are installed. Again, it&#39;s a lot of work to install and configure them every time I upgrade my MacOS or change a laptop.</p><aside class='youtube'> <a href='https://www.youtube.com/watch?v=_61CuGhyv-o'><div class='box'> <img src='https://i.ytimg.com/vi/_61CuGhyv-o/mqdefault.jpg' alt='YouTube video #_61CuGhyv-o'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Practical Example of a One-Click Release; 15 November 2016.</div></aside><p>Needless to say, that if/when someone joins the project and tries to run my scripts, he/she will have to do this pre-installation work again.</p><p>So, here is a new script, which I&#39;m using now. It is being executed inside a new Docker container, every time:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># First, we install all prerequisites</span>
sudo apt-get install -y php5 php5-mysql mysql
sudo apt-get install php-pear
sudo pear channel-discover pear.phpunit.de
sudo pear install phpunit/PHPUnit
sudo pear install PHP_CodeSniffer
sudo pecl install xdebug
sudo pear channel-discover pear.phing.info
sudo pear install phing/phing
<span class="c1"># And now the same script I had before</span>
phing <span class="nb">test</span>
git ftp push --user <span class="s2">&quot;..&quot;</span> <span class="se">\</span>
  --passwd <span class="s2">&quot;..&quot;</span> <span class="se">\</span>
  --syncroot php/src <span class="se">\</span>
  ftp://ftp.example.com/</code></pre></figure><p>Obviously, running this script on my MacBook (without virtualization) would cause a lot of trouble. Well, I don&#39;t even have <code>apt-get</code> here :)</p><p>Thus, the first benefit that Rultor gives you is an isolation of your deployment script in its own virtual environment. We have this mostly thanks to Docker.</p><h2 id="visibility-of-logs">Visibility of Logs</h2><p>Traditionally, we keep deployment scripts in some <code>~/deploy</code> directory and run them with a magic set of parameters. In a small project, you do this yourself and this directory is on your own laptop. In a bigger project, there is a &quot;deployment&quot; server, that has that magic directory with a set of scripts that can be executed only by a few trusted senior developers. I&#39;ve seen this setup many times.</p><p>The biggest issue here is traceability. It&#39;s almost impossible to find out who deployed what and why some particular deployment failed. The senior deployment gurus simply SSH to the server and run those magic scripts with magic parameters. Logs are usually lost and problem tracking is very difficult or impossible.</p><p>Rultor offers something different. With Rultor, there is no SSH access to deployment scripts any more. All scripts stay in the <code>.rultor.yml</code> configuration file, and you start them by posting messages in your issue tracking system (for example GitHub, JIRA or Trac). Rultor runs the script and publishes its full log right to your ticket. The log stays with your project forever. You can always get back to the ticket you were working with and check why deployment failed and what instructions were actually executed.</p><p>For example, check out this GitHub issue, where I was deploying a new version of Rultor itself, and failed a few times: <a href="https://github.com/yegor256/rultor/issues/563">yegor256/rultor#563</a>. All my failed attempts are protocolled. I can always get back to them and investigate. For a big project this information is vital.</p><p>Thus, the second benefit of Rultor versus a standalone deployment script is visibility of every single operation.</p><h2 id="security-of-credentials">Security of Credentials</h2><p>When you have a custom script sitting in your laptop or in that secret team deployment server, your production credentials stay close to it. There is just no other way. If your software works with a database, it has to know login credentials (user name, password, DB name, port number, etc.). Well, in the worst case, some people just hard code that information right into the source code. We aren&#39;t even going to discuss this case, that&#39;s how bad it is.</p><p>But let&#39;s say you separate your DB credentials from the source code. You will have something like a <code>db.properties</code> or <code>db.ini</code> file, which will be attached to the application right before deployment. You can also keep that file directly in the production server, which is even better, but not always possible, especially with PaaS deployments, for example.</p><p>A similar problem exists with deployments of artifacts to repositories. Say, you&#39;re regularly deploying to RubyGems.org. Your <code>~/.gem/credentials</code> will contain your secret API key.</p><p>So, very often, your deployment scripts are accompanied by some files with sensitive and secure information. And these files have this information in a plain, open format. No encryption, no protection. Just user names, passwords, codes and tokens in plain text.</p><p>Why is this bad? Well, for a single developer with a single laptop this doesn&#39;t sound like a problem. Although, I don&#39;t like the idea of losing a laptop somewhere in an airport with all credentials open and ready to be used. You may argue that there are disc protection tools, like FileVault for MacOS or BestCrypt for Windows. Yes, maybe.</p><p>But let&#39;s see what happens when we have a team of developers, working together and sharing those deployment scripts <strong>and</strong> files with credentials. Once you give access to your deployment scripts to a new member of the team, you have to share all that sensitive data. There is just no way around it. In order to use the scripts he/she has to be able to open files with credentials.</p><p>This is a problem, if you care about the security of your data.</p><p>Rultor solves this problem by offering an on-the-fly GPG decryption of your sensitive data, right before they are used by your deployment scripts. In the <code>.rultor.yml</code> configuration file you just say:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>decrypt:
  db.ini: &quot;repo/db.ini.asc&quot;
deploy:
  script:
    ftp put db.ini production</code></pre></figure><p>Then, you encrypt your <code>db.ini</code> using a Rultor GPG key, and fearlessly commit <code>db.ini.asc</code> to the repository. Nobody will be able to open and read that file, except the Rultor server itself, right before running the deployment script.</p><p>Thus, the third benefit of Rultor versus a standalone deployment script is proper security of sensitive data.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="By default, docker container starts a process inside as a root user. In rultor.com we change it to a custom user, read how " /> <meta name="keywords" content="docker non-root, docker non-root user, docker without sudo, running app inside Docker as non-root user, running docker entirely as non-root" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-08-29 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="How We Run as a Non-Root Inside Docker Container"/> <meta name="twitter:description" property="og:description" content="By default, docker container starts a process inside as a root user. In rultor.com we change it to a custom user, read how "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/08/29/docker-non-root.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/08/29/docker-non-root.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/08/29/docker-non-root.amp.html" /> <title>How We Run as a Non-Root Inside Docker Container </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/08/29/docker-non-root.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/08/29/docker-non-root.html</code></p><h1 itemprop="name headline mainEntityOfPage">How We Run as a Non-Root Inside Docker Container</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-08-29T00:00:00+00:00"> 29 August 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/08/29/docker-non-root.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/08/29/docker-non-root.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/08/29/docker-non-root.html&amp;text=How+We+Run+as+a+Non-Root+Inside+Docker+Container" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/08/29/docker-non-root.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/08/29/docker-non-root.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/08/29/docker-non-root.html%3F2014-34&amp;title=How+We+Run+as+a+Non-Root+Inside+Docker+Container" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/08/29/docker-non-root.html%3F2014-34&amp;t=How+We+Run+as+a+Non-Root+Inside+Docker+Container" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>Docker starts a process inside its container as a &quot;root&quot; user. In some cases, this is not convenient though. For example, <code>initdb</code> from PostgreSQL doesn&#39;t like to be started as root and will fail. In <a href="http://www.rultor.com">rultor.com</a>, a DevOps team assistant, <a href="/2014/07/29/docker-in-rultor.html">we&#39;re using Docker</a> as a virtualization technology for every build we run.</p><p>Here is how we change the user inside a running container, right after it is started.</p><p>First, this is how we start a new Docker container:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ sudo docker run -i -t --rm -v <span class="s2">&quot;</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">:/main&quot;</span> <span class="se">\</span>
  yegor256/rultor /main/entry.sh</code></pre></figure><p>There are two files in the current directory: <code>entry.sh</code> and <code>script.sh</code>. <code>entry.sh</code> is the file being executed by Docker on start, and it contains the following:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="ch">#!/bin/bash</span>
adduser --disabled-password --gecos <span class="s1">&#39;&#39;</span> r
adduser r sudo
<span class="nb">echo</span> <span class="s1">&#39;%sudo ALL=(ALL) NOPASSWD:ALL&#39;</span> &gt;&gt; /etc/sudoers
su -m r -c /home/r/script.sh</code></pre></figure><p><code>script.sh</code> will be executed as a user <code>r</code> inside the container. And this <code>r</code> user will have <code>sudo</code> permissions. This is exactly what all projects, managing their DevOps procedures with <a href="http://www.rultor.com">rultor.com</a>, need.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="This tutorial explains how a Ruby gem can be released to RubyGems.org in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant " /> <meta name="keywords" content="how to deploy gem, how to publish gem, publish gem to rubygems, publishing gem, release to rubygems, rubygems deployment, upload to rubygems" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-08-26 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="How to Publish to RubyGems, in One Click"/> <meta name="twitter:description" property="og:description" content="This tutorial explains how a Ruby gem can be released to RubyGems.org in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/08/26/publish-to-rubygems.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/08/26/publish-to-rubygems.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/08/26/publish-to-rubygems.amp.html" /> <title>How to Publish to RubyGems, in One Click </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/08/26/publish-to-rubygems.html</code></p><h1 itemprop="name headline mainEntityOfPage">How to Publish to RubyGems, in One Click</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-08-26T00:00:00+00:00"> 26 August 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/08/26/publish-to-rubygems.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html&amp;text=How+to+Publish+to+RubyGems%2C+in+One+Click" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html%3F2014-34&amp;title=How+to+Publish+to+RubyGems%2C+in+One+Click" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/08/26/publish-to-rubygems.html%3F2014-34&amp;t=How+to+Publish+to+RubyGems%2C+in+One+Click" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>When I release a new version of <a href="https://github.com/yegor256/jekyll-github-deploy">jgd</a>, a Ruby gem, to RubyGems.org, it takes 30 seconds of my time. Here is how I released a bug fix for version 1.5.1, in <a href="https://github.com/yegor256/jekyll-github-deploy/issues/6">GitHub issue #6</a>:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/08/github-ticket-6.jpg' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>As you see, I gave a command to <a href="http://www.rultor.com">Rultor</a>, and it released a new version to RubyGems. I didn&#39;t do anything else.</p><p>Now let&#39;s see how you can do the same. How you can configure your project so that the release of its new version to RubyGems.org takes just a few seconds of your time.</p><p>By the way, I assume that you&#39;re hosting your project in GitHub. If not, this entire tutorial won&#39;t work. If you are still not in GitHub, I would strongly recommend moving there.</p><h2 id="create-rubygems-account">Create RubyGems Account</h2><p>Create an account in <a href="http://www.rubygems.org">RubyGems.org</a>.</p><h2 id="create-rubygems-yml">Create <code>rubygems.yml</code></h2><p>Create a <code>rubygems.yml</code> file (you may already have it as <code>~/.gem/credentials</code>):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>:rubygems_api_key: d355d8940bb031bfe9acf03ed3da4c0d</code></pre></figure><p>You should get this API key from RubyGems. To find your API key, click on your user name when logged in to RubyGems.org and then click on &quot;Edit Profile.&quot;</p><h2 id="encrypt-rubygems-yml">Encrypt <code>rubygems.yml</code></h2><p>Now, encrypt <code>rubygems.yml</code> with a <a href="https://github.com/yegor256/rultor-remote">rultor remote</a>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>$ gem install rultor
$ rultor encrypt -p me/test rubygems.yml</code></pre></figure><p>Instead of <code>me/test</code> use the name of your GitHub project.</p><p>You will get a new file <code>rubygems.yml.asc</code>. Add this file to the root directory of your project, commit and push. The file contains your secret information, but only the Rultor server can decrypt it.</p><h2 id="prepare-gemspec">Prepare Gemspec</h2><p>In your <code>gemspec</code> file, make sure you use <code>1.0.snapshot</code> as a version number:</p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="c1"># coding: utf-8</span>
<span class="no">Gem</span><span class="o">::</span><span class="no">Specification</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="c1"># ...</span>
  <span class="n">s</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;1.0.snapshot&#39;</span>
  <span class="c1"># ...</span>
<span class="k">end</span></code></pre></figure><p>This version name will be replaced by Rultor during deployment.</p><h2 id="configure-rultor">Configure Rultor</h2><p>Create a <code>.rultor.yml</code> file in the root directory of your project:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>decrypt:
  rubygems.yml: &quot;repo/rubygems.yml.asc&quot;
release:
  script: |
    rm -rf *.gem
    sed -i &quot;s/1.0.snapshot/${tag}/g&quot; foo.gemspec
    gem build foo.gemspec
    chmod 0600 /home/r/rubygems.yml
    gem push *.gem --config-file /home/r/rubygems.yml</code></pre></figure><p>In this example, replace <code>foo</code> with the name of your gem.</p><h2 id="run-it">Run It!</h2><figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>Now it&#39;s time to see how it all works. Create a new ticket in the GitHub issue tracker, and post something like that into it (read more about <a href="http://doc.rultor.com/basics.html">Rultor commands</a>):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>@rultor release, tag is `0.1`</code></pre></figure><p>You will get a response in a few seconds. The rest will be done by Rultor.</p><p>Enjoy :)</p><p>BTW, if something doesn&#39;t work as I&#39;ve explained, don&#39;t hesitate to submit a ticket to <a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>. I will try to help you.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="This tutorial explains how a Java web application can be deployed to CloudBees in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant " /> <meta name="keywords" content="continuous delivery cloudbees, deploy in cloudbees, deploy to cloudbees, deploying to cloudbees, how to deploy a java app to cloudbees, how to host java web app, publish java web app to cloudbees" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-08-25 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="How to Deploy to CloudBees, in One Click"/> <meta name="twitter:description" property="og:description" content="This tutorial explains how a Java web application can be deployed to CloudBees in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.amp.html" /> <title>How to Deploy to CloudBees, in One Click </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html</code></p><h1 itemprop="name headline mainEntityOfPage">How to Deploy to CloudBees, in One Click</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-08-25T00:00:00+00:00"> 25 August 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html&amp;text=How+to+Deploy+to+CloudBees%2C+in+One+Click" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html%3F2014-34&amp;title=How+to+Deploy+to+CloudBees%2C+in+One+Click" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/08/25/deploy-to-cloudbees.html%3F2014-34&amp;t=How+to+Deploy+to+CloudBees%2C+in+One+Click" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>When I deploy a new version of <a href="http://www.stateful.co">stateful.co</a>, a Java web application, to CloudBees, it takes 30 seconds of my time. Maybe even less. Recently, I deployed version 1.6.5. You can see how it all happened, in <a href="https://github.com/sttc/stateful/issues/6">GitHub issue #6</a>:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/08/github-sttc-issue-6.png' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>As you see, I gave a command to <a href="http://www.rultor.com">Rultor</a>, and it packaged, tested and deployed a new version to CloudBees. I didn&#39;t do anything else.</p><p>Now let&#39;s see how you can do the same. How you can configure your project so that the deployment of its new version to CloudBees takes just a few seconds of your time.</p><p style="border:1px solid red;padding:1em;color:red;"> Since CloudBees is <a href="http://www.cloudbees.com/press/cloudbees-becomes-enterprise-jenkins-company">shutting down its PaaS service</a> by the end of December, 2014, this article will have no sense after that.</p><h2 id="configure-the-cloudbees-maven-plugin">Configure the CloudBees Maven Plugin</h2><p>Add this profile to your <code>pom.xml</code>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;profiles&gt;</span>
    <span class="nt">&lt;profile&gt;</span>
      <span class="nt">&lt;id&gt;</span>cloudbees<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;activation&gt;</span>
        <span class="nt">&lt;property&gt;&lt;name&gt;</span>bees.appId<span class="nt">&lt;/name&gt;&lt;/property&gt;</span>
      <span class="nt">&lt;/activation&gt;</span>
      <span class="nt">&lt;pluginRepositories&gt;</span>
        <span class="nt">&lt;pluginRepository&gt;</span>
          <span class="nt">&lt;id&gt;</span>cloudbees-public-release<span class="nt">&lt;/id&gt;</span>
          <span class="nt">&lt;url&gt;</span>
            http://repository-cloudbees.forge.cloudbees.com/public-release
          <span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/pluginRepository&gt;</span>
      <span class="nt">&lt;/pluginRepositories&gt;</span>
      <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;pluginManagement&gt;</span>
          <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
              <span class="nt">&lt;artifactId&gt;</span>maven-deploy-plugin<span class="nt">&lt;/artifactId&gt;</span>
              <span class="nt">&lt;configuration&gt;</span>
                  <span class="nt">&lt;skip&gt;</span>true<span class="nt">&lt;/skip&gt;</span>
              <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
          <span class="nt">&lt;/plugins&gt;</span>
        <span class="nt">&lt;/pluginManagement&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
          <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.cloudbees<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>bees-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.3.2<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
              <span class="nt">&lt;appid&gt;</span>${bees.id}<span class="nt">&lt;/appid&gt;</span>
              <span class="nt">&lt;apikey&gt;</span>${bees.key}<span class="nt">&lt;/apikey&gt;</span>
              <span class="nt">&lt;secret&gt;</span>${bees.secret}<span class="nt">&lt;/secret&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;executions&gt;</span>
              <span class="nt">&lt;execution&gt;</span>
                <span class="nt">&lt;id&gt;</span>deploy-to-production<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;phase&gt;</span>deploy<span class="nt">&lt;/phase&gt;</span>
                <span class="nt">&lt;goals&gt;</span>
                  <span class="nt">&lt;goal&gt;</span>deploy<span class="nt">&lt;/goal&gt;</span>
                <span class="nt">&lt;/goals&gt;</span>
              <span class="nt">&lt;/execution&gt;</span>
            <span class="nt">&lt;/executions&gt;</span>
          <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
      <span class="nt">&lt;/build&gt;</span>
    <span class="nt">&lt;/profile&gt;</span>
  <span class="nt">&lt;/profiles&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure><p>This plugin is not in Maven Central (unfortunately). That&#39;s why we have to specify that <code>&lt;pluginRepository&gt;</code>.</p><p>Pay attention to the fact that we&#39;re also disabling <code>maven-deploy-plugin</code>, since it would try to deploy your WAR package to the repository from the <code>&lt;distributionManagement&gt;</code> section. We want to avoid this.</p><p>The profile gets activated only when the <code>bees.id</code> property is defined. This won&#39;t happen during your normal development and testing, but it will occur during the deployment cycle initiated by Rultor, because we will define this property in <code>settings.xml</code> (discussed below).</p><h2 id="secure-access-to-cloudbees">Secure Access to CloudBees</h2><p>Create an account in CloudBees and register your web application there. CloudBees is free, as long as you don&#39;t need too much computing power. I believe that web applications should be light-weight by definition, so CloudBees&#39; free layer is an ideal choice.</p><p>Create a <code>settings.xml</code> file (but don&#39;t commit it to your repo!):</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;settings&gt;</span>
  <span class="nt">&lt;profiles&gt;</span>
    <span class="nt">&lt;profile&gt;</span>
      <span class="nt">&lt;id&gt;</span>cloudbees<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;bees.id&gt;</span>stateful/web<span class="nt">&lt;/bees.id&gt;</span>
        <span class="nt">&lt;bees.key&gt;</span><span class="c">&lt;!-- your key --&gt;</span><span class="nt">&lt;/bees.key&gt;</span>
        <span class="nt">&lt;bees.secret&gt;</span><span class="c">&lt;!-- your secret --&gt;</span><span class="nt">&lt;/bees.secret&gt;</span>
      <span class="nt">&lt;/properties&gt;</span>
    <span class="nt">&lt;/profile&gt;</span>
  <span class="nt">&lt;/profiles&gt;</span>
<span class="nt">&lt;/settings&gt;</span></code></pre></figure><p>Encrypt this file using <a href="https://github.com/yegor256/rultor-remote">rultor remote</a>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>$ gem install rultor
$ rultor encrypt -p me/test settings.xml</code></pre></figure><p>Instead of <code>me/test</code> use the name of your GitHub project.</p><p>You should get a <code>settings.xml.asc</code> file; add it to the root directory of your project, commit and push. This file contains your CloudBees credentials, but in an encrypted format. Nobody can read it, except the Rultor server.</p><h2 id="configure-versions-plugin">Configure Versions Plugin</h2><p>I recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">jcabi-parent</a>. It configures the required plugin out-of-the-box. If you&#39;re using it, skip this step.</p><p>Otherwise, add this plugin to your <code>pom.xml</code>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>versions-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;generateBackupPoms&gt;</span>false<span class="nt">&lt;/generateBackupPoms&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure><h2 id="configure-rultor">Configure Rultor</h2><p>Create a <code>.rultor.yml</code> file in the root directory of your project (this <a href="http://doc.rultor.com/reference.html">reference page</a> explains this format in detail):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>decrypt:
  settings.xml: &quot;repo/settings.xml.asc&quot;
release:
  script: |
    mvn versions:set &quot;-DnewVersion=${tag}&quot;
    git commit -am &quot;${tag}&quot;
    mvn clean deploy --settings /home/r/settings.xml</code></pre></figure><p>You can compare your file with live Rultor <a href="https://github.com/sttc/stateful/blob/master/.rultor.yml">configuration of stateful.co</a>.</p><h2 id="run-it">Run It!</h2><figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>Now it&#39;s time to see how it all works. Create a new ticket in the GitHub issue tracker, and post something like that into it (read more about <a href="http://doc.rultor.com/basics.html">Rultor commands</a>):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>@rultor release, tag is `0.1`</code></pre></figure><p>You will get a response in a few seconds. The rest will be done by Rultor.</p><p>Enjoy :)</p><p>BTW, if something doesn&#39;t work as I&#39;ve explained, don&#39;t hesitate to submit a ticket to the <a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>. I will try to help you.</p><p>Also, a similar configuration can be performed for <a href="/2014/09/13/deploying-to-heroku.html">Heroku</a> (using <a href="http://heroku.jcabi.com">jcabi-heroku-maven-plugin</a>) and for AWS Elastic Beanstalk (using <a href="http://beanstalk.jcabi.com">jcabi-beanstalk-maven-plugin</a>). I&#39;ll probably dedicate individual posts to them, as well.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="This tutorial explains how a Java project can be released/deployed to Maven Central in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant " /> <meta name="keywords" content="deploy to maven central, fast release to maven central, how to deploy to maven central, how to release to maven central, maven central release, publish from github to maven central, release to maven central" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-08-19 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="How to Release to Maven Central, in One Click"/> <meta name="twitter:description" property="og:description" content="This tutorial explains how a Java project can be released/deployed to Maven Central in just one click and zero maintenance efforts, using Rultor.com, DevOps assistant "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.amp.html" /> <title>How to Release to Maven Central, in One Click </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html</code></p><h1 itemprop="name headline mainEntityOfPage">How to Release to Maven Central, in One Click</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-08-19T00:00:00+00:00"> 19 August 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html&amp;text=How+to+Release+to+Maven+Central%2C+in+One+Click" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html%3F2014-33&amp;title=How+to+Release+to+Maven+Central%2C+in+One+Click" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html%3F2014-33&amp;t=How+to+Release+to+Maven+Central%2C+in+One+Click" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>When I release a new version of <a href="http://aspects.jcabi.com">jcabi-aspects</a>, a Java open source library, to Maven Central, it takes 30 seconds of my time. Maybe even less. Recently, I released version 0.17.2. You can see how it all happened, in <a href="https://github.com/jcabi/jcabi-aspects/issues/80">GitHub issue #80</a>:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/08/github-ticket-80.jpg' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>As you see, I gave a command to <a href="http://www.rultor.com">Rultor</a>, and it released a new version to Maven central. I didn&#39;t do anything else.</p><p>Now let&#39;s see how you can do the same. How you can configure your project so that the release of its new version to Maven Central takes just a few seconds of your time.</p><p>By the way, I assume that you&#39;re hosting your project in GitHub. If not, this entire tutorial won&#39;t work. If you are still not in GitHub, I would strongly recommend moving there.</p><h2 id="prepare-your-pom">Prepare Your POM</h2><aside class='youtube'> <a href='https://www.youtube.com/watch?v=rEK3Rk2lX3M'><div class='box'> <img src='https://i.ytimg.com/vi/rEK3Rk2lX3M/mqdefault.jpg' alt='YouTube video #rEK3Rk2lX3M'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Cactoos 0.12 polishing and releasing (webinar #27); 2 August 2017.</div></aside><p>Make sure your <code>pom.xml</code> contains all elements required by Sonatype, explained in <a href="http://central.sonatype.org/pages/requirements.html">Central Sync Requirements</a>. We will deploy to Sonatype, and they will synchronize all JAR (and not only) artifacts to Maven Central.</p><h2 id="register-a-project-with-sonatype">Register a Project With Sonatype</h2><p>Create an account in <a href="https://issues.sonatype.org/">Sonatype JIRA</a> and raise a ticket, asking to approve your <code>groupId</code>. This <a href="http://central.sonatype.org/pages/ossrh-guide.html">OSSRH Guide</a> explains this step in more detail.</p><h2 id="create-and-distribute-a-gpg-key">Create and Distribute a GPG Key</h2><p>Create a GPG key and distribute it, as explained in this <a href="http://central.sonatype.org/pages/working-with-pgp-signatures.html">Working with PGP Signatures</a> article.</p><p>When this step is done, you should have two files: <code>pubring.gpg</code> and <code>secring.gpg</code>.</p><h2 id="create-settings-xml">Create settings.xml</h2><p>Create <code>settings.xml</code>, next to the two <code>.gpg</code> files created in the previous step:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;settings&gt;</span>
  <span class="nt">&lt;profiles&gt;</span>
    <span class="nt">&lt;profile&gt;</span>
      <span class="nt">&lt;id&gt;</span>foo<span class="nt">&lt;/id&gt;</span> <span class="c">&lt;!-- give it the name of your project --&gt;</span>
      <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;gpg.homedir&gt;</span>/home/r<span class="nt">&lt;/gpg.homedir&gt;</span>
        <span class="nt">&lt;gpg.keyname&gt;</span>9A105525<span class="nt">&lt;/gpg.keyname&gt;</span>
        <span class="nt">&lt;gpg.passphrase&gt;</span>my-secret<span class="nt">&lt;/gpg.passphrase&gt;</span>
      <span class="nt">&lt;/properties&gt;</span>
    <span class="nt">&lt;/profile&gt;</span>
  <span class="nt">&lt;/profiles&gt;</span>
  <span class="nt">&lt;servers&gt;</span>
    <span class="nt">&lt;server&gt;</span>
      <span class="nt">&lt;id&gt;</span>oss.sonatype.org<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;username&gt;</span><span class="c">&lt;!-- Sonatype JIRA user name --&gt;</span><span class="nt">&lt;/username&gt;</span>
      <span class="nt">&lt;password&gt;</span><span class="c">&lt;!-- Sonatype JIRA pwd --&gt;</span><span class="nt">&lt;/password&gt;</span>
    <span class="nt">&lt;/server&gt;</span>
  <span class="nt">&lt;/servers&gt;</span>
<span class="nt">&lt;/settings&gt;</span></code></pre></figure><p>In this example, <code>9A105525</code> is the ID of your public key, and <code>my-secret</code> is the pass phrase you have used while generating the keys.</p><h2 id="encrypt-security-assets">Encrypt Security Assets</h2><p>Now, encrypt these three files with a <a href="https://github.com/yegor256/rultor-remote">rultor remote</a>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span>$ gem install rultor
$ rultor encrypt -p me/test pubring.gpg
$ rultor encrypt -p me/test secring.gpg
$ rultor encrypt -p me/test settings.xml</code></pre></figure><p>Instead of <code>me/test</code> you should use the name of your GitHub project.</p><p>You will get three new files: <code>pubring.gpg.asc</code>, <code>secring.gpg.asc</code> and <code>settings.xml.asc</code>. Add them to the root directory of your project, commit and push. The files contain your secret information, but only the Rultor server can decrypt them.</p><h2 id="add-sonatype-repositories">Add Sonatype Repositories</h2><p>I would recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">jcabi-parent</a>, as a parent pom for your project. This will make many further steps unnecessary. If you&#39;re using jcabi-parent, skip this step.</p><p>However, if you don&#39;t use jcabi-parent, you should add these two repositories to your <code>pom.xml</code>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;project&gt;</span>
  [...]
  <span class="nt">&lt;distributionManagement&gt;</span>
    <span class="nt">&lt;repository&gt;</span>
      <span class="nt">&lt;id&gt;</span>oss.sonatype.org<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;url&gt;</span>https://oss.sonatype.org/service/local/staging/deploy/maven2/<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/repository&gt;</span>
    <span class="nt">&lt;snapshotRepository&gt;</span>
      <span class="nt">&lt;id&gt;</span>oss.sonatype.org<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;url&gt;</span>https://oss.sonatype.org/content/repositories/snapshots<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/snapshotRepository&gt;</span>
  <span class="nt">&lt;/distributionManagement&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure><h2 id="configure-gpg-plugin">Configure GPG Plugin</h2><p>Again, I&#39;d recommend using <a href="http://parent.jcabi.com">jcabi-parent</a>, which configures this plugin automatically. If you&#39;re using it, skip this step.</p><p>Otherwise, add this plugin to your <code>pom.xml</code>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-gpg-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.5<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>sign-artifacts<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>verify<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>sign<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure><h2 id="configure-versions-plugin">Configure Versions Plugin</h2><p>Once again, I recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">http://parent.jcabi.com</a>. It configures all required plugins out-of-the-box. If you&#39;re using it, skip this step.</p><p>Otherwise, add this plugin to your <code>pom.xml</code>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>versions-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;generateBackupPoms&gt;</span>false<span class="nt">&lt;/generateBackupPoms&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure><h2 id="configure-sonatype-plugin">Configure Sonatype Plugin</h2><p>Yes, you&#39;re right, <a href="/2015/02/05/jcabi-parent-maven-pom.html">http://parent.jcabi.com</a> will help you here as well. If you&#39;re using it, skip this step too.</p><p>Otherwise, add these four plugins to your <code>pom.xml</code>:</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;project&gt;</span>
  [..]
  <span class="nt">&lt;build&gt;</span>
    [..]
    <span class="nt">&lt;plugins&gt;</span>
      [..]
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-deploy-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;skip&gt;</span>true<span class="nt">&lt;/skip&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-source-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>package-sources<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>jar<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>maven-javadoc-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>package-javadoc<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>jar<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.sonatype.plugins<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>nexus-staging-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.6<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;extensions&gt;</span>true<span class="nt">&lt;/extensions&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;serverId&gt;</span>oss.sonatype.org<span class="nt">&lt;/serverId&gt;</span>
          <span class="nt">&lt;nexusUrl&gt;</span>https://oss.sonatype.org/<span class="nt">&lt;/nexusUrl&gt;</span>
          <span class="nt">&lt;description&gt;</span>${project.version}<span class="nt">&lt;/description&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>deploy-to-sonatype<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>deploy<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>deploy<span class="nt">&lt;/goal&gt;</span>
              <span class="nt">&lt;goal&gt;</span>release<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span></code></pre></figure><h2 id="create-rultor-configuration">Create Rultor Configuration</h2><p>Create a <code>.rultor.yml</code> file in the root directory of your project (<a href="http://doc.rultor.com/reference.html">reference page</a> explains this format in details):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>decrypt:
  settings.xml: &quot;repo/settings.xml.asc&quot;
  pubring.gpg: &quot;repo/pubring.gpg.asc&quot;
  secring.gpg: &quot;repo/secring.gpg.asc&quot;
release:
  script: |
    mvn versions:set &quot;-DnewVersion=${tag}&quot;
    git commit -am &quot;${tag}&quot;
    mvn clean deploy -Pjcabi --settings /home/r/settings.xml</code></pre></figure><p>You can compare your file with live Rultor <a href="https://github.com/jcabi/jcabi-aspects/blob/master/.rultor.yml">configuration of jcabi-aspects</a>.</p><h2 id="run-it">Run It!</h2><figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>Now it&#39;s time to see how it all works. Create a new ticket in the GitHub issue tracker, and post something like that into it (read more about <a href="http://doc.rultor.com/basics.html">Rultor commands</a>):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>@rultor release, tag is `0.1`</code></pre></figure><p>You will get a response in a few seconds. The rest will be done by Rultor.</p><p>Enjoy :)</p><p>BTW, if something doesn&#39;t work as I&#39;ve explained, don&#39;t hesitate to submit a ticket to <a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>. I will try to help you.</p><p>Yeah, forgot to mention, Rultor is also doing two important things. First, it creates a GitHub release with a proper description. Second, it posts a tweet about the release, which you can retweet, to make an announcement to your followers. Both features are very convenient for me. For example:</p><blockquote class="twitter-tweet" lang="en"><p>DynamoDB Local Maven Plugin, 0.7.1 released <a href="https://t.co/C3KULouuKS">https://t.co/C3KULouuKS</a></p>---rultor.com (@rultors) <a href="https://twitter.com/rultors/statuses/501617747269517312">August 19, 2014</a></blockquote> <script async='' src="http://platform.twitter.com/widgets.js" charset="utf-8"></script></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Rultor is a virtual team assistant that, in tandem with Travis, optimizes your routine merging, releasing and deploying operations " /> <meta name="keywords" content="continuous delivery, continuous integration, docker continuous delivery, docker continuous integration, hosted continuous integration, java continuous integration" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-07-31 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Rultor + Travis"/> <meta name="twitter:description" property="og:description" content="Rultor is a virtual team assistant that, in tandem with Travis, optimizes your routine merging, releasing and deploying operations "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/07/31/travis-and-rultor.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/07/31/travis-and-rultor.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/07/31/travis-and-rultor.amp.html" /> <title>Rultor + Travis </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/07/31/travis-and-rultor.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/07/31/travis-and-rultor.html</code></p><h1 itemprop="name headline mainEntityOfPage">Rultor + Travis</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-07-31T00:00:00+00:00"> 31 July 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/07/31/travis-and-rultor.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/07/31/travis-and-rultor.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/07/31/travis-and-rultor.html&amp;text=Rultor+%2B+Travis" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/07/31/travis-and-rultor.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/07/31/travis-and-rultor.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/07/31/travis-and-rultor.html%3F2014-30&amp;title=Rultor+%2B+Travis" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/07/31/travis-and-rultor.html%3F2014-30&amp;t=Rultor+%2B+Travis" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class='badge'><a href='http://www.travis-ci.org'><img src='https://www.yegor256.com/images/2014/07/travis-logo.png' style='width:100px;max-width:100%;' alt='badge'/></a></figure> <figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p><a href="http://www.rultor.com">Rultor</a> is a coding team assistant. <a href="http://travis-ci.org">Travis</a> is a hosted <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a> system. In this article I&#39;ll show how our open source projects are using them in tandem to achieve seamless continuous delivery.</p><p>I&#39;ll show a few practical scenarios.</p><h2 id="scenario-1-merge-pull-request">Scenario #1: Merge Pull Request</h2><p><a href="https://github.com/jcabi/jcabi-mysql-maven-plugin"><code>jcabi-mysql-maven-plugin</code></a> is a Maven plugin for <a href="/2014/05/21/mysql-maven-plugin.html">MySQL integration testing</a>. <a href="https://github.com/ChristianRedl"><code>@ChristianRedl</code></a> submitted pull request <a href="https://github.com/jcabi/jcabi-mysql-maven-plugin/pull/35">#35</a> with a new feature. I reviewed the request and asked Rultor to merge it into <code>master</code>:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/07/rultor-mysql-35.png' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>As you can see, an actual merge operation was made by Rultor. I gave him access to the project by adding his GitHub account to the list of project collaborators.</p><p>Before giving a &quot;go ahead&quot; to Rultor I checked the status of the pre-build reported by Travis:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/07/rultor-mysql-35-2.png' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>Travis found a new commit in the pull request and immediately (without any interaction from my side) triggered a build in that branch. The build didn&#39;t fail, that&#39;s why Travis gave me a green sign. I looked at that sign and at the code. Since all problems in the code were corrected by the pull request author and Travis didn&#39;t complain---I gave a &quot;go&quot; to Rultor.</p><h2 id="scenario-2-continuous-integration">Scenario #2: Continuous Integration</h2><p>Even though the previous step <a href="/2014/07/21/read-only-master-branch.html">guarantees</a> that <code>master</code> branch is always clean and stable, we&#39;re using Travis to continuously integrate it. Every commit made to <code>master</code> triggers a new build in Travis. The result of the build changes the status of the project in Travis: either &quot;failing&quot; or &quot;passing.&quot;</p><p><a href="http://aspects.jcabi.com"><code>jcabi-aspects</code></a> is a collection of <a href="/2014/06/01/aop-aspectj-java-method-logging.html">AOP AspectJ aspects</a>. We configured Travis to build it continuously. This is the badge it produces (the left one):</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/07/rultor-aspects.png' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>Again, let me stress that even through <a href="/2014/07/21/read-only-master-branch.html">read-only master</a> is a strong protection against broken builds, it doesn&#39;t guarantee that at any moment master is stable. For example, sometimes unit tests fail sporadically due to changes in calendar, in environment, in dependencies, in network connection qualities, etc.</p><p>Well, ideally, unit tests should either fail or pass because they are environment independent. However, in reality, unit tests are far from being ideal.</p><p>That&#39;s why a combination of <a href="/2014/07/21/read-only-master-branch.html">read-only master</a> with Rultor and <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a> with Travis gives us higher stability.</p><h2 id="scenario-3-release-to-rubygems">Scenario #3: Release to RubyGems</h2><p><a href="https://github.com/yegor256/jekyll-github-deploy"><code>jekyll-github-deploy</code></a> is a Ruby gem that <a href="/2014/06/24/jekyll-github-deploy.html">automates deployment of Jekyll sites to GitHub Pages</a>. <a href="https://github.com/leucos"><code>@leucos</code></a> submitted a pull request <a href="https://github.com/yegor256/jekyll-github-deploy/pull/4">#4</a> with a new feature. The request was merged successfully into <code>master</code> branch.</p><p>Then, Rultor was instructed by myself that <code>master</code> branch should be released to RubyGems and a new version to set is 1.5:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/07/rultor-jekyll-4.png' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>Rultor executed a simple script, <a href="http://doc.rultor.com/basics.html#release">pre-configured</a> in its <a href="https://github.com/yegor256/jekyll-github-deploy/blob/master/.rultor.yml"><code>.rultor.yml</code></a>:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>release:
  script: |
    ./test.sh
    rm -rf *.gem
    sed -i &quot;s/2.0-SNAPSHOT/${tag}/g&quot; jgd.gemspec
    gem build jgd.gemspec
    chmod 0600 ../rubygems.yml
    gem push *.gem --config-file ../rubygems.yml</code></pre></figure><p>The script is parameterized, as you see. There is one parameter that is passed by Rultor into the script: <code>${tag}</code>. This parameter was provided by myself in the GitHub issue, when I submitted a command to Rultor.</p><p>The script tests that the gem works (integration testing) and clean up afterwords:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ ./test.sh
$ rm -rf *.gem</code></pre></figure><p>Then, it changes the version of itself in <code>jgd.gemspec</code> to the one provided in the <code>${tag}</code> (it is an environment variable), and builds a new <code>.gem</code>:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ sed -i <span class="s2">&quot;s/2.0-SNAPSHOT/</span><span class="si">${</span><span class="nv">tag</span><span class="si">}</span><span class="s2">/g&quot;</span> jgd.gemspec
$ gem build jgd.gemspec</code></pre></figure><p>Finally, it pushes a newly built <code>.gem</code> to <a href="/2014/08/26/publish-to-rubygems.html">RubyGems</a>, using login credentials from <code>../rubygems.yml</code>. This file is created by Rultor right before starting the script (this mechanism is discussed below):</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ chmod <span class="m">0600</span> ../rubygems.yml
$ gem push *.gem --config-file ../rubygems.yml</code></pre></figure><p>If everything works fine and RubyGems confirms successful deployment, Rultor reports to GitHub. This is exactly what happened in <a href="https://github.com/yegor256/jekyll-github-deploy/pull/4">pull request #4</a>.</p><h2 id="scenario-4-deploy-to-cloudbees">Scenario #4: Deploy to CloudBees</h2><p><a href="http://www.s3auth.com">s3auth.com</a> is a <a href="/2014/04/21/s3-http-basic-auth.html">Basic HTTP authentication gateway for Amazon S3 Buckets</a>. It is a Java web app. In its pull request <a href="https://github.com/yegor256/s3auth/pull/195">#195</a>, a resource leakage problem was fixed by <a href="https://github.com/carlosmiranda"><code>@carlosmiranda</code></a> and the pull request was merged by Rultor.</p><p>Then, <a href="https://github.com/davvd"><code>@davvd</code></a> instructed Rultor to deploy <code>master</code> branch to production environment. Rultor created <a href="/2014/07/29/docker-in-rultor.html">a new Docker container</a> and ran <code>mvn clean deploy</code> in it.</p><p>Maven deployed the application to <a href="http://www.cloudbees.com">CloudBees</a>:</p><figure class='unprintable'><img src='https://www.yegor256.com/images/2014/07/rultor-s3auth-195.png' itemprop='image' style='width:600px;max-width:100%;' alt='The figure'/></figure><p>The overall procedure took 21 minutes, as you see the in the report generated by Rultor.</p><p>There is one important trick worth mentioning. Deployment to production always means using secure credentials, like login, password, SSH keys, etc.</p><p>In this particular example, <a href="https://wiki.cloudbees.com/bin/view/RUN/MavenGuide">Maven CloudBees Plugin</a> needed API key, secret and web application name. These three parameters are kept secure and can&#39;t be revealed in an &quot;<a href="/2015/12/22/why-dont-you-contribute-to-open-source.html">open source</a>&quot; way.</p><p>So, there is <a href="http://doc.rultor.com/reference.html#assets">a mechanism</a> that configures Rultor accordingly through its <a href="https://github.com/yegor256/s3auth/blob/master/.rultor.yml"><code>.rultor.yml</code></a> file (pay attention to the first few lines):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>assets:
  settings.xml: &quot;yegor256/home#assets/s3auth/settings.xml&quot;
  pubring.gpg: &quot;yegor256/home#assets/pubring.gpg&quot;
  secring.gpg: &quot;yegor256/home#assets/secring.gpg&quot;</code></pre></figure><p>These YAML entries inform Rultor that it has to get <code>assets/s3auth/settings.xml</code> file from <code>yegor256/home</code> private (!) GitHub repository and put it into the working directory of Docker container, right before starting the Maven build.</p><p>This <code>settings.xml</code> file contains that secret data CloudBees plugin needs in order to deploy the application.</p><p><a href="/2014/08/25/deploy-to-cloudbees.html">How to Deploy to CloudBees, in One Click</a> explains this process even better.</p><h2 id="you-can-do-the-same">You Can Do The Same</h2><p>Both Rultor and Travis are free hosted products, provided your projects are open source and hosted at GitHub.</p><p>Other good examples of Rultor+Travis usage can be seen in these GitHub issues: <a href="https://github.com/jcabi/jcabi-http/issues/47"><code>jcabi/jcabi-http#47</code></a>, <a href="https://github.com/jcabi/jcabi-http/pull/48"><code>jcabi/jcabi-http#48</code></a></p><p>PS. You can do something similar with AppVeyor, for Windows platform: <a href="/2015/03/29/rultor-with-appveyor.html">How AppVeyor Helps Me to Validate Pull Requests Before Rultor Merges Them</a></p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Rultor.com runs every build in its own Docker container, perfectly isolating configurations and making them cacheable and reproducible. " /> <meta name="keywords" content="continuous delivery, continuous integration, docker builds ci, docker continuous delivery, docker continuous integration, jenkins docker, unit tests in docker" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-07-29 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Every Build in Its Own Docker Container"/> <meta name="twitter:description" property="og:description" content="Rultor.com runs every build in its own Docker container, perfectly isolating configurations and making them cacheable and reproducible. "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/07/29/docker-in-rultor.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/07/29/docker-in-rultor.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/07/29/docker-in-rultor.amp.html" /> <title>Every Build in Its Own Docker Container </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/07/29/docker-in-rultor.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/07/29/docker-in-rultor.html</code></p><h1 itemprop="name headline mainEntityOfPage">Every Build in Its Own Docker Container</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-07-29T00:00:00+00:00"> 29 July 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/07/29/docker-in-rultor.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/07/29/docker-in-rultor.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/07/29/docker-in-rultor.html&amp;text=Every+Build+in+Its+Own+Docker+Container" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/07/29/docker-in-rultor.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/07/29/docker-in-rultor.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/07/29/docker-in-rultor.html%3F2014-30&amp;title=Every+Build+in+Its+Own+Docker+Container" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/07/29/docker-in-rultor.html%3F2014-30&amp;t=Every+Build+in+Its+Own+Docker+Container" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class='badge'><a href='http://www.docker.io'><img src='http://doc.rultor.com/images/docker-logo.png' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p><a href="http://www.docker.io">Docker</a> is a command line tool that can run a shell command in a virtual Linux, inside an isolated file system. Every time we build our projects, we want them to run in their own Docker containers. Take this Maven project for example:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ sudo docker run -i -t ubuntu mvn clean <span class="nb">test</span></code></pre></figure> <figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>This command will start a new Ubuntu system and execute <code>mvn clean test</code> inside it. <a href="http://www.rultor.com">Rultor.com</a>, our virtual assistant, does exactly that with our builds, when we deploy, package, test and merge them.</p><h2 id="why-docker">Why Docker?</h2><p>What benefits does it give us? And why <a href="/2014/08/29/docker-non-root.html">Docker</a>, when there are many <a href="https://en.wikipedia.org/wiki/Operating_system-level_virtualization">other virtualization technologies</a>, like LXC, for example?</p><p>Well, there are a few very important benefits:</p><ul> <li><p>Image repository (hub.docker.com)</p></li> <li><p>Versioning</p></li> <li><p>Application-centric</p></li></ul><p>Let&#39;s discuss them in details.</p><h2 id="image-repository">Image Repository</h2><p>Docker enables image sharing through its public repository at <a href="http://hub.docker.com">hub.docker.com</a>. This means that after I prepare a working environment for my application, I make an image out of it and push it to the hub.</p><p>Let&#39;s say, I want my Maven build to be executed in a container with a pre-installed <code>graphviz</code> package (in order to enable <code>dot</code> command line tool). First, I would start a plain vanilla Ubuntu container, and install <code>graphviz</code> inside it:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ sudo docker run -i -t ubuntu /bin/bash
root@215d2696e8ad:/# sudo apt-get install -y graphviz
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
...
root@215d2696e8ad:/# exit
$ sudo docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS                     PORTS               NAMES
215d2696e8ad        ubuntu:14.04        /bin/bash           About a minute ago   Exited (0) 3 seconds ago                       high_mccarthy</code></pre></figure><p>I have a container that stopped a few seconds ago. Container&#39;s ID is <code>215d2696e8ad</code>. Now, I want to make it reusable for all further tests in Rultor.com. I have to create an image from it:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ sudo docker commit 215d2696e8ad yegor256/beta
c5ad7718fc0e20fe4bf2c8a9bfade4db8617a25366ca5b64be2e1e8aa0de6e52</code></pre></figure><p>I just made my new commit to a new image <code>yegor256/beta</code>. This image can be reused right now. I can create a new container from this image and it will have <code>graphviz</code> installed inside!</p><p>Now it&#39;s time to share my image at Docker hub, in order to make it available for Rultor:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ sudo docker push yegor256/beta
The push refers to a repository [yegor256/beta] (len: 1)
Sending image list
Pushing repository yegor256/beta (1 tags)
511136ea3c5a: Image already pushed, skipping
d7ac5e4f1812: Image already pushed, skipping
2f4b4d6a4a06: Image already pushed, skipping
83ff768040a0: Image already pushed, skipping
6c37f792ddac: Image already pushed, skipping
e54ca5efa2e9: Image already pushed, skipping
c5ad7718fc0e: Image successfully pushed
Pushing tag for rev [c5ad7718fc0e] on {https://registry-1.docker.io/v1/repositories/yegor256/beta/tags/latest}</code></pre></figure><p>The last step is to configure Rultor to use this image in all builds. To do this, I will edit <a href="http://doc.rultor.com/reference.html"><code>.rultor.yml</code></a> in the root directory of my GitHub repository:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>docker:
  image: yegor256/beta</code></pre></figure><p>That&#39;s it. From now on, Rultor will use my custom Docker image with pre-installed <code>graphviz</code>, in every build (merge, release, deploy, etc.)</p><p>Moreover, if and when I want to add something else to the image, it&#39;s easy to do. Say, I want to install Ruby into my build image. I start a container from the image and install it (pay attention, I&#39;m starting a container not from <code>ubuntu</code> image, as I did before, but from <code>yegor256/beta</code>):</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>$ sudo docker run -i -t yegor256/beta /bin/bash
root@7e0fbd9806c9:/# sudo apt-get install -y ruby
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
...
root@7e0fbd9806c9:/# exit
$ sudo docker ps -a
CONTAINER ID        IMAGE                  COMMAND             CREATED             STATUS                     PORTS               NAMES
7e0fbd9806c9        yegor256/beta:latest   /bin/bash           28 seconds ago      Exited (0) 2 seconds ago                       pensive_pare
215d2696e8ad        ubuntu:14.04           /bin/bash           10 minutes ago      Exited (0) 8 minutes ago                       high_mccarthy</code></pre></figure><p>You can now see that I have two containers. The first one is the one I am using right now; it contains Ruby. The second one is the one I was using before and it contains <code>graphviz</code>.</p><p>Now I have to commit again and push:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ sudo docker commit 7e0fbd9806c9 yegor256/beta
6cbfb7a6b18a2182f42171f6bb5aef67c4819b5c2795edffa6a63ba78aaada2d
$ sudo docker push yegor256/beta
...</code></pre></figure><p>Thus, this Docker hub is a very convenient feature for Rultor and similar systems.</p><h2 id="versioning">Versioning</h2><p>As you saw in the example above, every change to a Docker image has its own version (hash) and it&#39;s possible to track changes. It is also possible to roll back to any particular change.</p><p>Rultor is not using this functionality itself, but Rultor users are able to control their build configurations with much better precision.</p><h2 id="application-centric">Application-Centric</h2><p>Docker, unlike LXC or Vagrant, for example, is application-centric. This means that when we start a container---we start an application. With other virtualization technologies, when you get a virtual machine---you get a fully functional Unix environment, where you can login through SSH and do whatever you want.</p><p>Docker makes things simpler. It doesn&#39;t give you SSH access to container, but runs an application inside and shows you its output. This is exactly what we need in Rultor. We need to run an automated build (for example Maven or Bundler), see its output and get its exit code. If the code is not zero, we fail the build and report to the user.</p><p>This is how we run Maven build:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ sudo docker run --rm -i -t yegor256/rultor mvn clean <span class="nb">test</span>
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span> Building jcabi-github <span class="m">0</span>.13
<span class="o">[</span>INFO<span class="o">]</span> ------------------------------------------------------------------------
<span class="o">[</span>INFO<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> --- maven-clean-plugin:2.5:clean <span class="o">(</span>default-clean<span class="o">)</span> @ jcabi-github ---
<span class="o">[</span>INFO<span class="o">]</span>
...</code></pre></figure><p>As you can see, Maven starts immediately. We don&#39;t worry about the internals of the container. We just start an application inside it.</p><p>Furthermore, thanks to the <code>--rm</code> option, the container gets destroyed immediately after Maven execution is finished.</p><p>This is what application-centric is about.</p><p>Our overall impression of Docker is highly positive.</p><p>ps. A compact version of this article was published at <a href="http://devops.com/blogs/build-docker-containers/">devops.com</a></p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Rultor.com is a bot that talks to you via GitHub issue tracking and helps you merge pull requests by passing them through a full testing cycle " /> <meta name="keywords" content="continuous delivery pre-flight builds, continuous integration pre-flight builds, continuous integration preflight builds, docker continuous integration, pre-flight builds, pre-flight builds docker, preflight builds, preflight builds docker" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-07-24 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Rultor.com, a Merging Bot"/> <meta name="twitter:description" property="og:description" content="Rultor.com is a bot that talks to you via GitHub issue tracking and helps you merge pull requests by passing them through a full testing cycle "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/07/24/rultor-automated-merging.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/07/24/rultor-automated-merging.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/07/24/rultor-automated-merging.amp.html" /> <title>Rultor.com, a Merging Bot </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/07/24/rultor-automated-merging.html</code></p><h1 itemprop="name headline mainEntityOfPage">Rultor.com, a Merging Bot</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-07-24T00:00:00+00:00"> 24 July 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/07/24/rultor-automated-merging.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html&amp;text=Rultor.com%2C+a+Merging+Bot" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html%3F2014-29&amp;title=Rultor.com%2C+a+Merging+Bot" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/07/24/rultor-automated-merging.html%3F2014-29&amp;t=Rultor.com%2C+a+Merging+Bot" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>You get a GitHub pull request. You review it. It looks correct---it&#39;s time to merge it into <code>master</code>. You post a comment in it, asking <a href="https://github.com/rultor">@rultor</a> to test and merge. Rultor starts a new <a href="http://www.docker.io">Docker</a> container, merges the pull request into <code>master</code>, runs all tests and, if everything looks clean---merges, pushes, and closes the request.</p><p>Then, you ask <a href="https://github.com/rultor">@rultor</a> to deploy the current version to production environment. It checks out your repository, starts a new Docker container, executes your deployment scripts and reports to you right there in the GitHub issue.</p><h2 id="why-not-jenkins-or-travis">Why not Jenkins or Travis?</h2><p>There are many tools on the market, which automate <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a> and continuous delivery (let&#39;s call them DevOps). For example, downloadable open source <a href="http://jenkins-ci.org/">Jenkins</a> and hosted <a href="/2014/07/31/travis-and-rultor.html">Travis</a> both perform these tasks. So, why do we need one more?</p><aside class='youtube'> <a href='https://www.youtube.com/watch?v=NflR7DKwxDY'><div class='box'> <img src='https://i.ytimg.com/vi/NflR7DKwxDY/mqdefault.jpg' alt='YouTube video #NflR7DKwxDY'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Deployment Scripts Are Dead. Meet Rultor.; 26 May 2016.</div></aside><p>Well, there are three very important features that we need for our projects, but we can&#39;t find all of them in any of the DevOps tools currently available on the market:</p><ul> <li><p><strong>Merging</strong>. We make master branch read-only in our projects, as <a href="/2014/07/21/read-only-master-branch.html">this article</a> recommends. All changes into master we pass through a script that validates them and merges.</p></li> <li><p><strong>Docker</strong>. Every build should work in its own Docker container, in order to simplify configuration, isolate resources and make errors easily reproducible.</p></li> <li><p><strong>Tell vs. Trigger</strong>. We need to communicate with DevOps tool through commands, right from our issue tracking system (GitHub issues, in most projects). All existing DevOps systems trigger builds on certain conditions. We need our developers to be able to talk to the tool, through human-like commands in the tickets they are working with.</p></li></ul><p>A combination of these three features is what differs <a href="http://www.rultor.com">Rultor</a> from all other existing systems.</p><h2 id="how-rultor-merges">How Rultor Merges</h2><p>Once Rultor finds a <a href="http://doc.rultor.com/basics.html">merge command</a> in one of your GitHub pull requests, it does exactly this:</p><ol> <li><p>Reads the <a href="http://doc.rultor.com/reference.html"><code>.rultor.yml</code></a> YAML configuration file from the root directory of your repository.</p></li> <li><p>Gets automated build execution command from it, for example <code>bundle test</code>.</p></li> <li><p>Checks out your repository into a temporary directory on one of its servers.</p></li> <li><p>Merges pull request into <code>master</code> branch.</p></li> <li><p>Starts a new Docker container and runs <code>bundle test</code> in it.</p></li> <li><p>If everything is fine, pushes modified <code>master</code> branch to GitHub.</p></li> <li><p>Reports back to you, in the GitHub pull request.</p></li> </ol><p>You can see it in action, for example, in this pull request: <a href="https://github.com/jcabi/jcabi-github/pull/878">jcabi/jcabi-github#878</a>.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Continuous integration doesn&apos;t work while programmers are able to commit into the master branch. This article explains why and proposes a solution. " /> <meta name="keywords" content="broken builds, commits to master branch, continous delivery, continous deployment, continuous delivery preflight builds, continuous integration, continuous integration doesn't work" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-07-21 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Master Branch Must Be Read-Only"/> <meta name="twitter:description" property="og:description" content="Continuous integration doesn&apos;t work while programmers are able to commit into the master branch. This article explains why and proposes a solution. "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/07/21/read-only-master-branch.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?bd1446bb584"/> <link rel="apple-touch-icon" href="/favicon.ico?bd1446bb584"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?bd1446bb584"/> <link rel="stylesheet" href="/css/icons.css?bd1446bb584"/> <link rel="canonical" href="https://www.yegor256.com/2014/07/21/read-only-master-branch.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/07/21/read-only-master-branch.amp.html" /> <title>Master Branch Must Be Read-Only </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;289</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> <a href="/code-ahead.html">Code Ahead</a> was published on Amazon just a few days ago! It is my new book, a novel about programmers. It explains in details the majority of ideas that stand behind <a href="https://www.zerocracy.com">Zerocracy</a> and <a href="https://www.xdsd.org">XDSD</a>. </li> <li> At <a href="/webinars.html">Webinar #37</a> we will discuss naming problem in OOP, for objects, methods and attributes; join us on <b>September 12</b>, at 11am PST. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/07/21/read-only-master-branch.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/07/21/read-only-master-branch.html</code></p><h1 itemprop="name headline mainEntityOfPage">Master Branch Must Be Read-Only</h1><aside class='book'><a href='https://amzn.to/2u9BbqF'><img src='/images/books/code-ahead/cover.png' class='book-cover' alt='book cover'/></a>Read more about this subject in <a href='https://amzn.to/2u9BbqF'>Section&nbsp;3</a><br/> of my book<a href='https://amzn.to/2u9BbqF'><img src='/images/books/amazon-buy-button.png' class='amazon-button' alt='Click to buy'/></a></aside><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-07-21T00:00:00+00:00"> 21 July 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2014/07/21/read-only-master-branch.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/07/21/read-only-master-branch.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html&amp;text=Master+Branch+Must+Be+Read-Only" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html%3F2014-29&amp;title=Master+Branch+Must+Be+Read-Only" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/07/21/read-only-master-branch.html%3F2014-29&amp;t=Master+Branch+Must+Be+Read-Only" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>Continuous integration is easy. Download Jenkins, install, create a job, click the button, and get a nice email saying that your build is broken (I assume your build is automated). Then, fix broken tests (I assume you have tests), and get a much better looking email saying that your build is clean.</p><p>Then, tweet about it, claiming that your team is using <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a>.</p><p>Then, in a few weeks, start filtering out Jenkins alerts, into their own folder, so that they don&#39;t bother you anymore. Anyway, your team doesn&#39;t have the time or desire to fix all unit tests every time someone breaks them.</p><p>After all, we all know that unit testing is not for a team working with deadlines, right?</p><p>Wrong. Continuous integration can and must work.</p><h2 id="what-is-continuous-integration">What is Continuous Integration?</h2><p>Nowadays, software development is done in teams. We develop in feature branches and isolate changes while they are in development. Then, we merge branches into <code>master</code>. After every merge, we test the entire product, executing all available unit and integration tests. This is called <a href="https://en.wikipedia.org/wiki/Continuous_integration">continuous integration</a> (aka &quot;CI&quot;).</p><aside class='youtube'> <a href='https://www.youtube.com/watch?v=2a2nWELIk-Y'><div class='box'> <img src='https://i.ytimg.com/vi/2a2nWELIk-Y/mqdefault.jpg' alt='YouTube video #2a2nWELIk-Y'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Yegor Bugayenko | Kyiv DevOps, September, 2015; 6 October 2015.</div></aside><p>Sometimes, some tests fail. When this happens, we say that our &quot;build is broken.&quot; Such a failure is a positive side effect of quality control because it raises a red flag immediately after an error gets into <code>master</code>.</p><p>It is a well-known practice, when fixing that error becomes a top priority for its author and the entire team. The error should be fixed right after a red flag is raised by the <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a> server.</p><figure class='badge'><a href='http://amzn.to/2bQVmlb'><img src='https://www.yegor256.com/images/2014/07/continuous-delivery-book.png' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p><a href="http://amzn.to/2bQVmlb">Continuous Delivery by Jez Humble et. al.</a> explains this approach perfectly in Chapter 7, pages 169&ndash;186.</p><p>There are a few good tools on the market, which automate DevOps procedures. Some of them are open source, you can download and install them on your own servers. For example: <a href="http://jenkins-ci.org/">Jenkins</a>, <a href="http://www.thoughtworks.com/products/go-continuous-delivery">Go</a>, and <a href="http://cruisecontrol.sourceforge.net/">CruiseControl</a>. Some of them are available as a service in cloud, such as: <a href="http://www.travis-ci.org">Travis</a>, <a href="http://www.shippable.com">Shippable</a>, <a href="http://wercker.com/">Wercker</a>, and <a href="/2014/10/05/ten-hosted-continuous-integration-services.html">many others</a>.</p><h2 id="why-continuous-integration-doesnt-work">Why Continuous Integration Doesn&#39;t Work?</h2><p>CI is great, but the bigger the team (and the code base), the more often builds get broken. And, the longer it takes to fix them. I&#39;ve seen many examples where a hard working team starts to ignore red flags, raised by Jenkins, after a few weeks or trying to keep up.</p><aside class='quote'>Product owners do not understand the importance of a "clean build" and devs can't buy time for fixing unit tests</aside><p>The team simply becomes incapable of fixing all errors in time. Mostly because the business has other priorities. Product owners do not understand the importance of a &quot;clean build&quot; and technical leaders can&#39;t buy time for fixing unit tests. Moreover, the code that broke them was already in <code>master</code> and, in most cases, has been already deployed to production and delivered to end-users. What&#39;s the urgency of fixing some tests if business value was already delivered?</p><aside class='youtube'> <a href='https://www.youtube.com/watch?v=gL4XwP-EBOg'><div class='box'> <img src='https://i.ytimg.com/vi/gL4XwP-EBOg/mqdefault.jpg' alt='YouTube video #gL4XwP-EBOg'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Continuous Integration May Have Negative Effects; 20 April 2016.</div></aside><p>In the end, most development teams don&#39;t take continuous integration alerts seriously. Jenkins or Travis are just fancy tools for them that play no role in the entire development and delivery pipeline. No matter what continuous integration server says, we still deliver new features to our end-users. We&#39;ll fix our build later. And <a href="/2014/10/08/continuous-integration-is-dead.html">it&#39;s only logical</a>.</p><h2 id="what-is-a-solution">What Is a Solution?</h2><p><a href="/pdf/2014/guard-article.pdf" class="em2" title="Prevent Conflicts in Distributed Agile PHP Projects"><i class="icon icon-pdf"></i></a></p><p>Four years ago, in 2010, I published an article in <a href="http://www.phparch.com/magazine/2010-2/august/">php|Architect</a> called &quot;Prevent Conflicts in Distributed Agile PHP Projects.&quot; In the article, a solution was proposed (full article in <a href="/pdf/2014/guard-article.pdf">PDF</a>) for Subversion and PHP.</p><p>Since that time, I used experimentally that approach in multiple <a href="/2015/12/22/why-dont-you-contribute-to-open-source.html">open source</a> projects and a few commercial ones with PHP, Java, Ruby and JavaScript, Git and Subversion. In all cases, my experience was only positive, and that&#39;s why <a href="http://www.rultor.com">rultor.com</a> was born (later about that though).</p><p>So, the solution is simple---prohibit anyone from merging anything into <code>master</code> and create a script that anyone can call. The script will merge, test, and commit. The script will not make any exceptions. If any branch is breaking at even one unit test, the entire branch will be rejected.</p><p>In other words, we should raise that red flag <strong>before</strong> the code gets into <code>master</code>. We should put the blame for broken tests on the shoulders of its author.</p><p>Say, I&#39;m developing a feature in my own branch. I finished the development and broke a few tests, accidentally. It happens, we all make mistakes. I can&#39;t merge my changes into <code>master</code>. Git simply rejects my <code>push</code>, because I don&#39;t have the appropriate permissions. All I can do is call a magic script, asking it to merge my branch. The script will try to merge, but before pushing into <code>master</code>, it will run all tests. And if any of them break, my branch will be rejected. My changes won&#39;t be merged. Now it&#39;s my responsibility---to fix them and call the script again.</p><p>In the beginning, this approach slows down the development, because everybody has to start writing cleaner code. At the end, though, this method pays off big time.</p><h2 id="pre-flight-builds">Pre-flight Builds</h2><p>Some CI servers offer pre-flight builds feature, which means testing branches before they get merged into <code>master</code>. Travis, for example, has this feature and it is very helpful. When you make a new commit to a branch, Travis immediately tries to build it, and reports in GitHub pull request, if there are problems.</p><aside class='youtube'> <a href='https://www.youtube.com/watch?v=Ht0JI41kA4I'><div class='box'> <img src='https://i.ytimg.com/vi/Ht0JI41kA4I/mqdefault.jpg' alt='YouTube video #Ht0JI41kA4I'/><div class='play'><i class='icon icon-play'></i></div></div></a><div>Pre-flight Build Pitfalls; 10 May 2016.</div></aside><p>Pay attention, pre-flight builds don&#39;t merge. They just check whether your individual branch is clean. After merge, it can easily break <code>master</code>. And, of course, this mechanism doesn&#39;t guarantee that no collaborators can commit directly to <code>master</code>, breaking it accidentally. Pre-flight builds are a preventive measure, but do not solve the problem entirely.</p><h2 id="rultor-com">Rultor.com</h2><p>In order to start working as explained above, all you have to do is to revoke write permissions to <code>master</code> branch (or <code>/trunk</code>, in Subversion).</p><p>Unfortunately, this is <a href="http://stackoverflow.com/questions/10381672">not possible</a> in GitHub. The only solution is to work through forks and pull requests only. Simply remove everybody from the list of &quot;collaborators&quot; and they will have to submit changes through pull requests.</p><figure class='badge'><a href='http://www.rultor.com'><img src='http://doc.rultor.com/images/logo.svg' style='width:100px;max-width:100%;' alt='badge'/></a></figure><p>Then, start using <a href="http://www.rultor.com">Rultor.com</a>, which will help you to test, merge and push every pull request. Basically, Rultor is the script we were talking about above. It is available as a free cloud service.</p><p>ps. A short version of this article is also published at <a href="http://devops.com/blogs/continuous-integration-doesnt-work/">devops.com</a></p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> </article></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?bd1446bb584"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
