<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="{&quot;layout&quot;=&gt;&quot;tag-index&quot;, &quot;posts&quot;=&gt;[#&lt;Jekyll::Document _posts/2018/apr/2018-04-24-right-way-to-report-bugs.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2018/feb/2018-02-06-where-to-find-more-bugs.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/jun/2017-06-13-dynamodb-rack-maven.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/may/2017-05-23-unlimited-number-of-bugs.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/may/2017-05-17-single-statement-unit-tests.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/mar/2017-03-24-tdd-that-works.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2015/sep/2015-09-10-testing-exit-criteria.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2015/jun/2015-06-11-wikipedia-bug-definition.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/aug/2014-08-22-art-of-software-testing.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/jun/2014-06-21-casperjs-with-maven.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-28-xml-xpath-hamcrest-matchers.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-18-jcabi-http-server-mocking.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-13-bugs-are-welcome.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-06-phandom.md collection=posts&gt;], &quot;tag&quot;=&gt;&quot;testing&quot;, &quot;content&quot;=&gt;&quot;&quot;, &quot;dir&quot;=&gt;&quot;/tag/&quot;, &quot;name&quot;=&gt;&quot;testing.html&quot;, &quot;path&quot;=&gt;&quot;tag/testing.html&quot;, &quot;url&quot;=&gt;&quot;/tag/testing&quot;, &quot;title&quot;=&gt;&quot;testing&quot;, &quot;description&quot;=&gt;&quot;testing: more about testing in this collection of recently published articles... the list is updated every few weeks.&quot;}" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="testing"/> <meta name="twitter:description" property="og:description" content="{&quot;layout&quot;=&gt;&quot;tag-index&quot;, &quot;posts&quot;=&gt;[#&lt;Jekyll::Document _posts/2018/apr/2018-04-24-right-way-to-report-bugs.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2018/feb/2018-02-06-where-to-find-more-bugs.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/jun/2017-06-13-dynamodb-rack-maven.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/may/2017-05-23-unlimited-number-of-bugs.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/may/2017-05-17-single-statement-unit-tests.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2017/mar/2017-03-24-tdd-that-works.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2015/sep/2015-09-10-testing-exit-criteria.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2015/jun/2015-06-11-wikipedia-bug-definition.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/aug/2014-08-22-art-of-software-testing.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/jun/2014-06-21-casperjs-with-maven.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-28-xml-xpath-hamcrest-matchers.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-18-jcabi-http-server-mocking.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-13-bugs-are-welcome.md collection=posts&gt;, #&lt;Jekyll::Document _posts/2014/apr/2014-04-06-phandom.md collection=posts&gt;], &quot;tag&quot;=&gt;&quot;testing&quot;, &quot;content&quot;=&gt;&quot;&quot;, &quot;dir&quot;=&gt;&quot;/tag/&quot;, &quot;name&quot;=&gt;&quot;testing.html&quot;, &quot;path&quot;=&gt;&quot;tag/testing.html&quot;, &quot;url&quot;=&gt;&quot;/tag/testing&quot;, &quot;title&quot;=&gt;&quot;testing&quot;, &quot;description&quot;=&gt;&quot;testing: more about testing in this collection of recently published articles... the list is updated every few weeks.&quot;}"/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/tag/testing"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/tag/testing" /> <link rel="amphtml" href="https://www.yegor256.com/tag/testing" /> <title>testing </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /tag/testing><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /tag/testing><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /tag/testing><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /tag/testing><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /tag/testing><a href="/books.html" title="The books I wrote">Books</a></li> <li /tag/testing><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /tag/testing><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /tag/testing class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /tag/testing><a href="/award.html" title="Software quality award">Award</a></li> <li /tag/testing><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /tag/testing><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /tag/testing><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header itemprop="name"><h1>14 posts about testing</h1></header> <article itemprop="articleBody"> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, place, tags, description, keywords, image, jb_picture, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2018-04-24 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="The Right Way to Report a Bug"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;You know, at &lt;a href=&quot;https://www.zerocracy.com&quot;&gt;Zerocracy&lt;/a&gt;, either you are a programmer or a tester, and &lt;a href=&quot;/2014/04/13/bugs-are-welcome.html&quot;&gt;we pay&lt;/a&gt; for each bug you find and report. Well, not quite. We pay for each bug report a project architect considers good enough to pay for. The architect’s decision is totally subjective and non-disputable, according to &lt;a href=&quot;https://www.zerocracy.com/policy.html#29&quot;&gt;§29&lt;/a&gt; of the &lt;a href=&quot;https://www.zerocracy.com/policy.html&quot;&gt;Policy&lt;/a&gt;. Some of our developers find this unfair and ask me to explain how they can report bugs such that they are definitely paid. Here is a non-exhaustive list of my recommendations.&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;Burn After Reading (2008) by Coen Brothers&quot; src=&quot;/images/2018/04/burn-after-reading.jpg&quot; longdesc=&quot;#d3a4c799&quot; /&gt;&lt;figcaption id=&quot;d3a4c799&quot;&gt;Burn After Reading (2008) by Coen Brothers&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;To be honest, there are &lt;a href=&quot;https://www.google.com/search?q=how+to+write+good+bug+reports&quot;&gt;many articles&lt;/a&gt; written before on this very subject. I will try not to repeat them. They mostly say reasonable things, like “be specific,” “choose a strong title,” “avoid duplicates,” and many others. My recommendations here are more of a psychological nature.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Stay cool&lt;/strong&gt;. Don’t expect all of your bugs to be accepted and paid for. Some of them won’t be. This must not stop you from reporting them.&lt;/p&gt; &lt;aside class=&quot;quote&quot;&gt;Present it as if the entire world will collapse tomorrow if they don't fix it.&lt;/aside&gt; &lt;p&gt;&lt;strong&gt;Exaggerate&lt;/strong&gt;. No matter how minor the bug is, present it as if the entire world will collapse tomorrow if they don’t fix it. Of course, they will make their own decision about the priority and severity of the bug, but don’t help them to make it against you.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Victimize yourself&lt;/strong&gt;. Don’t just say “the class is broken”—there is no victim in this statement. So, no need to save anyone’s life. The bug is minor—no need to pay. Instead, say “I can’t use the class.” Present yourself as a victim. Or even better, represent a group of victims: “Nobody can really use this class.”&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Push them&lt;/strong&gt;. If a bug report is not paid for, don’t hesitate to ask why. Insist that it was a very important problem and you deserve to be paid. If they still don’t pay, forget it and move on. You must not look like it offends you somehow.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Show efforts&lt;/strong&gt;. The bug description must look “rich,” clearly demonstrating that you invested a lot of effort in its creation. If there is just a single line, it’s easier for them to not pay you—they won’t feel any guilt. However, if it’s long, detailed, properly formatted, and contains multiple supporting links, they will feel bad if they don’t pay.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Look engaged&lt;/strong&gt;. Say something like “I’m ready to investigate more and provide additional details, if you need me too.” Of course you won’t do that (in most cases), but you have to say it. This will look like you care and this bug comes right from your heart. How can they not pay for it?&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Look altruistic&lt;/strong&gt;. Don’t show them that you are reporting these bugs just to get money. They know that anyway, but still. Look like you care about the project and honestly want to help. Say that you worry about the users, about the market, about the mission, about the bigger scope, etc.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Aggregate&lt;/strong&gt;. This may sound against the &lt;a href=&quot;/2014/11/24/principles-of-bug-tracking.html&quot;&gt;principles&lt;/a&gt; of bug tracking I suggested earlier, but when your bugs are small and cosmetic—aggregate them. In such a case you have a chance to win. They will reject three minor bugs, but they won’t reject a bigger one with three minor parts.&lt;/p&gt; &lt;p&gt;I believe that if you follow these simple recommendations, you will be a more successful bug reporter. At least at &lt;a href=&quot;https://www.zerocracy.com&quot;&gt;Zerocracy&lt;/a&gt;.&lt;/p&gt; &lt;blockquote class=&quot;twitter-tweet&quot; data-lang=&quot;en&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;What do you feel when you report a bug? &lt;a href=&quot;https://twitter.com/hashtag/codeahead?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#codeahead&lt;/a&gt; &lt;a href=&quot;https://twitter.com/hashtag/bugs?src=hash&amp;amp;ref_src=twsrc%5Etfw&quot;&gt;#bugs&lt;/a&gt;&lt;/p&gt;--- Yegor Bugayenko (@yegor256) &lt;a href=&quot;https://twitter.com/yegor256/status/1023455022997233664?ref_src=twsrc%5Etfw&quot;&gt;July 29, 2018&lt;/a&gt;&lt;/blockquote&gt; &lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html" /> <link rel="amphtml" href="https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.amp.html" /> <title>The Right Way to Report a Bug </title> <meta name='og:image' content='https://www.yegor256.com/images/2018/04/burn-after-reading.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2018/04/burn-after-reading.jpg'/><meta name='og:image:width' content='1280'/> <meta name='twitter:image:width' content='1280'/><meta name='og:image:height' content='694'/> <meta name='twitter:image:height' content='694'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='Burn After Reading (2008) by Coen Brothers'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2018/04/24/right-way-to-report-bugs.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2018/04/24/right-way-to-report-bugs.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html</code></p><h1 itemprop="name headline mainEntityOfPage">The Right Way to Report a Bug</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2018-04-24T00:00:00+00:00"> 24 April 2018 </time> </li> <li class="desktop-only" itemprop="locationCreated">Moscow, Russia</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>You know, at <a href="https://www.zerocracy.com">Zerocracy</a>, either you are a programmer or a tester, and <a href="/2014/04/13/bugs-are-welcome.html">we pay</a> for each bug you find and report. Well, not quite. We pay for each bug report a project architect considers good enough to pay for. The architect’s decision is totally subjective and non-disputable, according to <a href="https://www.zerocracy.com/policy.html#29">§29</a> of the <a href="https://www.zerocracy.com/policy.html">Policy</a>. Some of our developers find this unfair and ask me to explain how they can report bugs such that they are definitely paid. Here is a non-exhaustive list of my recommendations.</p><figure class="jb_picture"><img itemprop="image" alt="Burn After Reading (2008) by Coen Brothers" src="/images/2018/04/burn-after-reading.jpg" longdesc="#d3a4c799" /><figcaption id="d3a4c799">Burn After Reading (2008) by Coen Brothers</figcaption></figure><p>To be honest, there are <a href="https://www.google.com/search?q=how+to+write+good+bug+reports">many articles</a> written before on this very subject. I will try not to repeat them. They mostly say reasonable things, like “be specific,” “choose a strong title,” “avoid duplicates,” and many others. My recommendations here are more of a psychological nature.</p><p><strong>Stay cool</strong>. Don’t expect all of your bugs to be accepted and paid for. Some of them won’t be. This must not stop you from reporting them.</p><aside class="quote">Present it as if the entire world will collapse tomorrow if they don't fix it.</aside><p><strong>Exaggerate</strong>. No matter how minor the bug is, present it as if the entire world will collapse tomorrow if they don’t fix it. Of course, they will make their own decision about the priority and severity of the bug, but don’t help them to make it against you.</p><p><strong>Victimize yourself</strong>. Don’t just say “the class is broken”—there is no victim in this statement. So, no need to save anyone’s life. The bug is minor—no need to pay. Instead, say “I can’t use the class.” Present yourself as a victim. Or even better, represent a group of victims: “Nobody can really use this class.”</p><p><strong>Push them</strong>. If a bug report is not paid for, don’t hesitate to ask why. Insist that it was a very important problem and you deserve to be paid. If they still don’t pay, forget it and move on. You must not look like it offends you somehow.</p><p><strong>Show efforts</strong>. The bug description must look “rich,” clearly demonstrating that you invested a lot of effort in its creation. If there is just a single line, it’s easier for them to not pay you—they won’t feel any guilt. However, if it’s long, detailed, properly formatted, and contains multiple supporting links, they will feel bad if they don’t pay.</p><p><strong>Look engaged</strong>. Say something like “I’m ready to investigate more and provide additional details, if you need me too.” Of course you won’t do that (in most cases), but you have to say it. This will look like you care and this bug comes right from your heart. How can they not pay for it?</p><p><strong>Look altruistic</strong>. Don’t show them that you are reporting these bugs just to get money. They know that anyway, but still. Look like you care about the project and honestly want to help. Say that you worry about the users, about the market, about the mission, about the bigger scope, etc.</p><p><strong>Aggregate</strong>. This may sound against the <a href="/2014/11/24/principles-of-bug-tracking.html">principles</a> of bug tracking I suggested earlier, but when your bugs are small and cosmetic—aggregate them. In such a case you have a chance to win. They will reject three minor bugs, but they won’t reject a bigger one with three minor parts.</p><p>I believe that if you follow these simple recommendations, you will be a more successful bug reporter. At least at <a href="https://www.zerocracy.com">Zerocracy</a>.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">What do you feel when you report a bug? <a href="https://twitter.com/hashtag/codeahead?src=hash&amp;ref_src=twsrc%5Etfw">#codeahead</a> <a href="https://twitter.com/hashtag/bugs?src=hash&amp;ref_src=twsrc%5Etfw">#bugs</a></p>--- Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1023455022997233664?ref_src=twsrc%5Etfw">July 29, 2018</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html&amp;text=The+Right+Way+to+Report+a+Bug" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html%3F2018-16&amp;title=The+Right+Way+to+Report+a+Bug" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2018/04/24/right-way-to-report-bugs.html%3F2018-16&amp;t=The+Right+Way+to+Report+a+Bug" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>You know, at <a href="https://www.zerocracy.com">Zerocracy</a>, either you are a programmer or a tester, and <a href="/2014/04/13/bugs-are-welcome.html">we pay</a> for each bug you find and report. Well, not quite. We pay for each bug report a project architect considers good enough to pay for. The architect’s decision is totally subjective and non-disputable, according to <a href="https://www.zerocracy.com/policy.html#29">§29</a> of the <a href="https://www.zerocracy.com/policy.html">Policy</a>. Some of our developers find this unfair and ask me to explain how they can report bugs such that they are definitely paid. Here is a non-exhaustive list of my recommendations.</p><figure class="jb_picture"><img itemprop="image" alt="Burn After Reading (2008) by Coen Brothers" src="/images/2018/04/burn-after-reading.jpg" longdesc="#d3a4c799" /><figcaption id="d3a4c799">Burn After Reading (2008) by Coen Brothers</figcaption></figure><p>To be honest, there are <a href="https://www.google.com/search?q=how+to+write+good+bug+reports">many articles</a> written before on this very subject. I will try not to repeat them. They mostly say reasonable things, like “be specific,” “choose a strong title,” “avoid duplicates,” and many others. My recommendations here are more of a psychological nature.</p><p><strong>Stay cool</strong>. Don’t expect all of your bugs to be accepted and paid for. Some of them won’t be. This must not stop you from reporting them.</p><aside class="quote">Present it as if the entire world will collapse tomorrow if they don't fix it.</aside><p><strong>Exaggerate</strong>. No matter how minor the bug is, present it as if the entire world will collapse tomorrow if they don’t fix it. Of course, they will make their own decision about the priority and severity of the bug, but don’t help them to make it against you.</p><p><strong>Victimize yourself</strong>. Don’t just say “the class is broken”—there is no victim in this statement. So, no need to save anyone’s life. The bug is minor—no need to pay. Instead, say “I can’t use the class.” Present yourself as a victim. Or even better, represent a group of victims: “Nobody can really use this class.”</p><p><strong>Push them</strong>. If a bug report is not paid for, don’t hesitate to ask why. Insist that it was a very important problem and you deserve to be paid. If they still don’t pay, forget it and move on. You must not look like it offends you somehow.</p><p><strong>Show efforts</strong>. The bug description must look “rich,” clearly demonstrating that you invested a lot of effort in its creation. If there is just a single line, it’s easier for them to not pay you—they won’t feel any guilt. However, if it’s long, detailed, properly formatted, and contains multiple supporting links, they will feel bad if they don’t pay.</p><p><strong>Look engaged</strong>. Say something like “I’m ready to investigate more and provide additional details, if you need me too.” Of course you won’t do that (in most cases), but you have to say it. This will look like you care and this bug comes right from your heart. How can they not pay for it?</p><p><strong>Look altruistic</strong>. Don’t show them that you are reporting these bugs just to get money. They know that anyway, but still. Look like you care about the project and honestly want to help. Say that you worry about the users, about the market, about the mission, about the bigger scope, etc.</p><p><strong>Aggregate</strong>. This may sound against the <a href="/2014/11/24/principles-of-bug-tracking.html">principles</a> of bug tracking I suggested earlier, but when your bugs are small and cosmetic—aggregate them. In such a case you have a chance to win. They will reject three minor bugs, but they won’t reject a bigger one with three minor parts.</p><p>I believe that if you follow these simple recommendations, you will be a more successful bug reporter. At least at <a href="https://www.zerocracy.com">Zerocracy</a>.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">What do you feel when you report a bug? <a href="https://twitter.com/hashtag/codeahead?src=hash&amp;ref_src=twsrc%5Etfw">#codeahead</a> <a href="https://twitter.com/hashtag/bugs?src=hash&amp;ref_src=twsrc%5Etfw">#bugs</a></p>--- Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1023455022997233664?ref_src=twsrc%5Etfw">July 29, 2018</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, place, tags, description, keywords, image, jb_picture, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2018-02-06 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="More Bugs, Please"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;A &lt;a href=&quot;/2015/06/11/wikipedia-bug-definition.html&quot;&gt;bug&lt;/a&gt; is something we find in a software product that “doesn’t look right” (this is my personal definition). A bug can be hidden or visible; it can be “already fixed” or “still present”; it can be critical or cosmetic; it can be urgent or of a low priority. What is important is that the &lt;a href=&quot;/2017/05/23/unlimited-number-of-bugs.html&quot;&gt;more&lt;/a&gt; bugs we are able to find and fix before our customers see them, the higher the perceived &lt;a href=&quot;/2017/12/26/software-quality-formula.html&quot;&gt;quality&lt;/a&gt; of the software. Simply put, bugs are a &lt;a href=&quot;/2014/04/13/bugs-are-welcome.html&quot;&gt;very good thing&lt;/a&gt;, if they are found by us, not our customers. &lt;a href=&quot;https://www.zerocracy.com&quot;&gt;We&lt;/a&gt; pay our programmers for &lt;a href=&quot;/2014/04/17/how-xdsd-is-different.html&quot;&gt;each bug&lt;/a&gt; they find. Here is a cheat sheet for them, showing where and how they can find those bugs, to make more money.&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;American Honey (2016) by Andrea Arnold&quot; src=&quot;/images/2018/02/american-honey.jpg&quot; longdesc=&quot;#02df6b04&quot; /&gt;&lt;figcaption id=&quot;02df6b04&quot;&gt;American Honey (2016) by Andrea Arnold&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;Obviously, if something is broken, it’s a bug; no need to mention it here. However, when a product is &lt;a href=&quot;/2017/03/24/tdd-that-works.html&quot;&gt;more or less stable&lt;/a&gt;, not too many things are visibly broken. But we still pay for bugs. What should you look out for? Read on. This list (in no particular order) will help you.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Lack of functionality&lt;/strong&gt;. If a class (&lt;a href=&quot;https://github.com/yegor256/cactoos/issues/558&quot;&gt;yegor256/cactoos#558&lt;/a&gt;) or the entire module (&lt;a href=&quot;https://github.com/yegor256/cactoos/issues/399&quot;&gt;yegor256/cactoos#399&lt;/a&gt;) doesn’t provide the functionality you &lt;em&gt;expect&lt;/em&gt; it to have, it’s a bug.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Lack of tests&lt;/strong&gt;. If a class doesn’t have a unit test (&lt;a href=&quot;https://github.com/yegor256/takes/issues/43&quot;&gt;yegor256/takes#43&lt;/a&gt;) or the existing test doesn’t cover some critical aspects of the class (&lt;a href=&quot;https://github.com/yegor256/cactoos/issues/375&quot;&gt;yegor256/cactoos#375&lt;/a&gt;), it’s a bug.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Lack of documentation&lt;/strong&gt;. If, say, a Javadoc block for a class does not clearly explain to you how to use the class, or the entire module is not documented well (&lt;a href=&quot;https://github.com/yegor256/takes/issues/790&quot;&gt;yegor256/takes#790&lt;/a&gt;), it’s a bug.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Suboptimal implementation&lt;/strong&gt;. If a piece of code doesn’t look good to you, and you think it can be refactored to look better, it’s a bug.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Design inconsistency&lt;/strong&gt;. If the design doesn’t look logical to you (&lt;a href=&quot;https://github.com/yegor256/cactoos/issues/436&quot;&gt;yegor256/cactoos#436&lt;/a&gt;) and you know how it can be improved, it’s a bug.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Naming is weird&lt;/strong&gt;. If class, variable or package names don’t look consistent and obvious to you, and you know how they can be fixed (&lt;a href=&quot;https://github.com/yegor256/cactoos/issues/274&quot;&gt;yegor256/cactoos#274&lt;/a&gt;), it’s a bug.&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Unstable test&lt;/strong&gt;. If a unit test fails sporadically (&lt;a href=&quot;https://github.com/yegor256/takes/issues/506&quot;&gt;yegor256/takes#506&lt;/a&gt;) or doesn’t work in some particular environment (&lt;a href=&quot;https://github.com/yegor256/jpeek/issues/151&quot;&gt;yegor256/jpeek#151&lt;/a&gt;), it’s a bug.&lt;/p&gt; &lt;p&gt;Also, it’s worth mentioning that minor, cosmetic, or poorly formulated &lt;a href=&quot;/2018/04/24/right-way-to-report-bugs.html&quot;&gt;bug reports&lt;/a&gt; will most likely be rejected or not paid for. If you want us to pay for your bug reports, make sure they &lt;a href=&quot;/2014/11/24/principles-of-bug-tracking.html&quot;&gt;sound right&lt;/a&gt;, in order to help us move the project forward to a better state.&lt;/p&gt; &lt;!-- There are some examples of minor bugs, which are not worth paying for, even though they are valid: * [yegor256/jpeek#158](https://github.com/yegor256/jpeek/issues/158) Cosmetic bugs are those that --&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html" /> <link rel="amphtml" href="https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.amp.html" /> <title>More Bugs, Please </title> <meta name='og:image' content='https://www.yegor256.com/images/2018/02/american-honey.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2018/02/american-honey.jpg'/><meta name='og:image:width' content='1280'/> <meta name='twitter:image:width' content='1280'/><meta name='og:image:height' content='832'/> <meta name='twitter:image:height' content='832'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='American Honey (2016) by Andrea Arnold'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2018/02/06/where-to-find-more-bugs.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2018/02/06/where-to-find-more-bugs.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html</code></p><h1 itemprop="name headline mainEntityOfPage">More Bugs, Please</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2018-02-06T00:00:00+00:00"> 6 February 2018 </time> </li> <li class="desktop-only" itemprop="locationCreated">Moscow, Russia</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>A <a href="/2015/06/11/wikipedia-bug-definition.html">bug</a> is something we find in a software product that “doesn’t look right” (this is my personal definition). A bug can be hidden or visible; it can be “already fixed” or “still present”; it can be critical or cosmetic; it can be urgent or of a low priority. What is important is that the <a href="/2017/05/23/unlimited-number-of-bugs.html">more</a> bugs we are able to find and fix before our customers see them, the higher the perceived <a href="/2017/12/26/software-quality-formula.html">quality</a> of the software. Simply put, bugs are a <a href="/2014/04/13/bugs-are-welcome.html">very good thing</a>, if they are found by us, not our customers. <a href="https://www.zerocracy.com">We</a> pay our programmers for <a href="/2014/04/17/how-xdsd-is-different.html">each bug</a> they find. Here is a cheat sheet for them, showing where and how they can find those bugs, to make more money.</p><figure class="jb_picture"><img itemprop="image" alt="American Honey (2016) by Andrea Arnold" src="/images/2018/02/american-honey.jpg" longdesc="#02df6b04" /><figcaption id="02df6b04">American Honey (2016) by Andrea Arnold</figcaption></figure><p>Obviously, if something is broken, it’s a bug; no need to mention it here. However, when a product is <a href="/2017/03/24/tdd-that-works.html">more or less stable</a>, not too many things are visibly broken. But we still pay for bugs. What should you look out for? Read on. This list (in no particular order) will help you.</p><p><strong>Lack of functionality</strong>. If a class (<a href="https://github.com/yegor256/cactoos/issues/558">yegor256/cactoos#558</a>) or the entire module (<a href="https://github.com/yegor256/cactoos/issues/399">yegor256/cactoos#399</a>) doesn’t provide the functionality you <em>expect</em> it to have, it’s a bug.</p><p><strong>Lack of tests</strong>. If a class doesn’t have a unit test (<a href="https://github.com/yegor256/takes/issues/43">yegor256/takes#43</a>) or the existing test doesn’t cover some critical aspects of the class (<a href="https://github.com/yegor256/cactoos/issues/375">yegor256/cactoos#375</a>), it’s a bug.</p><p><strong>Lack of documentation</strong>. If, say, a Javadoc block for a class does not clearly explain to you how to use the class, or the entire module is not documented well (<a href="https://github.com/yegor256/takes/issues/790">yegor256/takes#790</a>), it’s a bug.</p><p><strong>Suboptimal implementation</strong>. If a piece of code doesn’t look good to you, and you think it can be refactored to look better, it’s a bug.</p><p><strong>Design inconsistency</strong>. If the design doesn’t look logical to you (<a href="https://github.com/yegor256/cactoos/issues/436">yegor256/cactoos#436</a>) and you know how it can be improved, it’s a bug.</p><p><strong>Naming is weird</strong>. If class, variable or package names don’t look consistent and obvious to you, and you know how they can be fixed (<a href="https://github.com/yegor256/cactoos/issues/274">yegor256/cactoos#274</a>), it’s a bug.</p><p><strong>Unstable test</strong>. If a unit test fails sporadically (<a href="https://github.com/yegor256/takes/issues/506">yegor256/takes#506</a>) or doesn’t work in some particular environment (<a href="https://github.com/yegor256/jpeek/issues/151">yegor256/jpeek#151</a>), it’s a bug.</p><p>Also, it’s worth mentioning that minor, cosmetic, or poorly formulated <a href="/2018/04/24/right-way-to-report-bugs.html">bug reports</a> will most likely be rejected or not paid for. If you want us to pay for your bug reports, make sure they <a href="/2014/11/24/principles-of-bug-tracking.html">sound right</a>, in order to help us move the project forward to a better state.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html&amp;text=More+Bugs%2C+Please" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html%3F2018-05&amp;title=More+Bugs%2C+Please" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2018/02/06/where-to-find-more-bugs.html%3F2018-05&amp;t=More+Bugs%2C+Please" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>A <a href="/2015/06/11/wikipedia-bug-definition.html">bug</a> is something we find in a software product that “doesn’t look right” (this is my personal definition). A bug can be hidden or visible; it can be “already fixed” or “still present”; it can be critical or cosmetic; it can be urgent or of a low priority. What is important is that the <a href="/2017/05/23/unlimited-number-of-bugs.html">more</a> bugs we are able to find and fix before our customers see them, the higher the perceived <a href="/2017/12/26/software-quality-formula.html">quality</a> of the software. Simply put, bugs are a <a href="/2014/04/13/bugs-are-welcome.html">very good thing</a>, if they are found by us, not our customers. <a href="https://www.zerocracy.com">We</a> pay our programmers for <a href="/2014/04/17/how-xdsd-is-different.html">each bug</a> they find. Here is a cheat sheet for them, showing where and how they can find those bugs, to make more money.</p><figure class="jb_picture"><img itemprop="image" alt="American Honey (2016) by Andrea Arnold" src="/images/2018/02/american-honey.jpg" longdesc="#02df6b04" /><figcaption id="02df6b04">American Honey (2016) by Andrea Arnold</figcaption></figure><p>Obviously, if something is broken, it’s a bug; no need to mention it here. However, when a product is <a href="/2017/03/24/tdd-that-works.html">more or less stable</a>, not too many things are visibly broken. But we still pay for bugs. What should you look out for? Read on. This list (in no particular order) will help you.</p><p><strong>Lack of functionality</strong>. If a class (<a href="https://github.com/yegor256/cactoos/issues/558">yegor256/cactoos#558</a>) or the entire module (<a href="https://github.com/yegor256/cactoos/issues/399">yegor256/cactoos#399</a>) doesn’t provide the functionality you <em>expect</em> it to have, it’s a bug.</p><p><strong>Lack of tests</strong>. If a class doesn’t have a unit test (<a href="https://github.com/yegor256/takes/issues/43">yegor256/takes#43</a>) or the existing test doesn’t cover some critical aspects of the class (<a href="https://github.com/yegor256/cactoos/issues/375">yegor256/cactoos#375</a>), it’s a bug.</p><p><strong>Lack of documentation</strong>. If, say, a Javadoc block for a class does not clearly explain to you how to use the class, or the entire module is not documented well (<a href="https://github.com/yegor256/takes/issues/790">yegor256/takes#790</a>), it’s a bug.</p><p><strong>Suboptimal implementation</strong>. If a piece of code doesn’t look good to you, and you think it can be refactored to look better, it’s a bug.</p><p><strong>Design inconsistency</strong>. If the design doesn’t look logical to you (<a href="https://github.com/yegor256/cactoos/issues/436">yegor256/cactoos#436</a>) and you know how it can be improved, it’s a bug.</p><p><strong>Naming is weird</strong>. If class, variable or package names don’t look consistent and obvious to you, and you know how they can be fixed (<a href="https://github.com/yegor256/cactoos/issues/274">yegor256/cactoos#274</a>), it’s a bug.</p><p><strong>Unstable test</strong>. If a unit test fails sporadically (<a href="https://github.com/yegor256/takes/issues/506">yegor256/takes#506</a>) or doesn’t work in some particular environment (<a href="https://github.com/yegor256/jpeek/issues/151">yegor256/jpeek#151</a>), it’s a bug.</p><p>Also, it’s worth mentioning that minor, cosmetic, or poorly formulated <a href="/2018/04/24/right-way-to-report-bugs.html">bug reports</a> will most likely be rejected or not paid for. If you want us to pay for your bug reports, make sure they <a href="/2014/11/24/principles-of-bug-tracking.html">sound right</a>, in order to help us move the project forward to a better state.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, place, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2017-06-13 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="DynamoDB + Rake + Maven + Rack::Test"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;In &lt;a href=&quot;/2017/04/25/sixnines.html&quot;&gt;SixNines.io&lt;/a&gt;, one of my Ruby pet web apps, I’m using &lt;a href=&quot;https://aws.amazon.com/dynamodb/&quot;&gt;DynamoDB&lt;/a&gt;, a NoSQL cloud database by &lt;a href=&quot;https://aws.amazon.com/&quot;&gt;AWS&lt;/a&gt;. It works like a charm, but the problem is that it’s not so easy to create an integration test, to make sure my code works together with the “real” DynamoDB server and tables. Let me show you how it was solved. The code is open source and you can see it in the &lt;a href=&quot;https://github.com/yegor256/sixnines&quot;&gt;yegor256/sixnines&lt;/a&gt; GitHub repo.&lt;/p&gt; &lt;!--more--&gt; &lt;h2 id=&quot;how-to-bootstrap-dynamodb-local&quot;&gt;How to bootstrap DynamoDB Local&lt;/h2&gt; &lt;p&gt;First, you need to use &lt;a href=&quot;https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/&quot;&gt;DynamoDB Local&lt;/a&gt;, a command line tool created by AWS exactly for the purposes of testing. You need to start it before your integration tests and stop it afterwards.&lt;/p&gt; &lt;p&gt;To make things simpler I suggest you use &lt;a href=&quot;http://dynamodb.jcabi.com/&quot;&gt;&lt;code&gt;jcabi-dynamodb-maven-plugin&lt;/code&gt;&lt;/a&gt;, a &lt;a href=&quot;https://maven.apache.org/&quot;&gt;Maven&lt;/a&gt; plugin that I &lt;a href=&quot;/2014/05/01/dynamodb-local-maven-plugin.html&quot;&gt;made&lt;/a&gt; a few years ago. You will need to add &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml&quot;&gt;&lt;code&gt;pom.xml&lt;/code&gt;&lt;/a&gt; to your repository and start/stop Maven from a &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile&quot;&gt;&lt;code&gt;Rakefile&lt;/code&gt;&lt;/a&gt;, just like I’m doing &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L50-L67&quot;&gt;here&lt;/a&gt;:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:dynamo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;FileUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rm_rf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dynamodb-local/target&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spawn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mvn&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;install&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;chdir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dynamodb-local&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;at_exit&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`kill -TERM &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pid&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Dynamo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;aws&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe_table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;table_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sn-endpoints&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;rescue&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;retry&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;First, I’m removing &lt;code&gt;dynamodb-local/target&lt;/code&gt;, the directory where Maven keeps its temporary files, to make sure we always start from scratch.&lt;/p&gt; &lt;p&gt;Then, I’m starting &lt;code&gt;mvn install&lt;/code&gt;, using &lt;code&gt;Process.spawn&lt;/code&gt;, as a background process with &lt;code&gt;pid&lt;/code&gt; as its process ID (this won’t work in Windows, only Linux/Mac). Then I immediately register an &lt;a href=&quot;https://ruby-doc.org/core-2.2.3/Kernel.html#method-i-at_exit&quot;&gt;&lt;code&gt;at_exit&lt;/code&gt;&lt;/a&gt; Ruby hook, which will be executed if Ruby dies for any reason. I’m sure it’s obvious why I have to do that—in order to avoid garbage running in the background after Rake is finished or terminated.&lt;/p&gt; &lt;p&gt;Pay attention, I’m using &lt;code&gt;kill -TERM&lt;/code&gt; instead of &lt;code&gt;kill -KILL&lt;/code&gt;, in order to give Maven a chance to wrap everything up, terminate DynamoDB Local correctly, close its TCP port and exit.&lt;/p&gt; &lt;h2 id=&quot;how-to-check-that-its-running&quot;&gt;How to check that it’s running&lt;/h2&gt; &lt;p&gt;Next I’m checking the status of &lt;code&gt;sn-endpoints&lt;/code&gt;, one of the tables in the DynamoDB Local. It has to be there if the server is up and running. It will be created by &lt;code&gt;jcabi-dynamodb-maven-plugin&lt;/code&gt; according to &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/tables/sn-endpoints.json&quot;&gt;&lt;code&gt;sn-endpoints.json&lt;/code&gt;&lt;/a&gt;, its JSON configuration.&lt;/p&gt; &lt;p&gt;Most probably the table won’t be ready immediately though, since it takes time to bootstrap Maven, start the server, and create tables there. That’s why, if the exception is thrown, I catch it, wait for 5 seconds and try again. I keep trying many times, until the server is ready. Eventually it will be. It takes about 12-15 seconds on my MacBook, which means 2-3 attempts/exceptions.&lt;/p&gt; &lt;h2 id=&quot;how-to-connect-to-dynamodb-local&quot;&gt;How to connect to DynamoDB Local&lt;/h2&gt; &lt;p&gt;My classes need to know how to connect to the server during integration tests. In production they need to connect to AWS, in testing they have to know about the DynamoDB Local instance I just started. This is what I have in my class &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb&quot;&gt;&lt;code&gt;Dynamo&lt;/code&gt;&lt;/a&gt;, which is responsible for the very connection with DynamoDB. Its decision on where to connect is based on the environment variable &lt;code&gt;RACK_ENV&lt;/code&gt;, which is set to &lt;code&gt;&quot;test&quot;&lt;/code&gt; in &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb#L25&quot;&gt;&lt;code&gt;test__helper.rb&lt;/code&gt;&lt;/a&gt;, which is included by &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L39&quot;&gt;&lt;code&gt;rake/testtask&lt;/code&gt;&lt;/a&gt; in front of all other tests, thanks to the double underscore in its name.&lt;/p&gt; &lt;p&gt;If the environment variable is set to &lt;code&gt;&quot;test&quot;&lt;/code&gt;, &lt;code&gt;Dynamo&lt;/code&gt; takes the connectivity parameters from the YAML file &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb#L37&quot;&gt;&lt;code&gt;dynamodb-local/target/dynamo.yml&lt;/code&gt;&lt;/a&gt; created by &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L79-L100&quot;&gt;&lt;code&gt;maven-resources-plugin:copy-resources&lt;/code&gt;&lt;/a&gt;. The TCP port of the DynamoDB Local database will be &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/config/dynamo.yml&quot;&gt;there&lt;/a&gt;, as well as the DynamoDB authentication key and secret.&lt;/p&gt; &lt;h2 id=&quot;how-to-run-the-integration-tests&quot;&gt;How to run the integration tests&lt;/h2&gt; &lt;p&gt;This is the easiest part. I just use my objects the way they are supposed to be used in production and they connect to DynamoDB Local instead of AWS.&lt;/p&gt; &lt;p&gt;I’m using Rack::Test in order to test the entire application, via a set of HTTP calls. For example, &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/test/test_sixnines.rb#L143-L147&quot;&gt;here&lt;/a&gt; I’m trying to render Jeff’s user account page. Its HTTP response code is supposed to be 200:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unit&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AppTest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TestCase&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Rack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Methods&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sinatra&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Application&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_user_account&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cookie&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sixnines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jeff&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assert_equal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;##&lt;/p&gt; &lt;p&gt;Now you can run the entire test from the command line. You can see how &lt;a href=&quot;/2014/09/11/deployment-script-vs-rultor.html&quot;&gt;Rultor&lt;/a&gt; runs it while releasing a new version: &lt;a href=&quot;http://www.rultor.com/t/11705-302080694&quot;&gt;full log&lt;/a&gt;. Also, see how it works &lt;a href=&quot;https://travis-ci.org/yegor256/sixnines&quot;&gt;in Travis&lt;/a&gt;. In a nutshell:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;You call &lt;code&gt;rake&lt;/code&gt; in the command line and Rake starts;&lt;/li&gt; &lt;li&gt;Rake attempts to run the &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L32&quot;&gt;&lt;code&gt;default&lt;/code&gt;&lt;/a&gt; task, which depends on &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L36&quot;&gt;&lt;code&gt;test&lt;/code&gt;&lt;/a&gt;;&lt;/li&gt; &lt;li&gt;Rake attempts to run &lt;code&gt;test&lt;/code&gt;, which depends on &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L50&quot;&gt;&lt;code&gt;dynamo&lt;/code&gt;&lt;/a&gt;;&lt;/li&gt; &lt;li&gt;Rake, inside &lt;code&gt;test&lt;/code&gt; task, runs &lt;code&gt;mvn install&lt;/code&gt; in the background with this &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml&quot;&gt;&lt;code&gt;pom.xml&lt;/code&gt;&lt;/a&gt;;&lt;/li&gt; &lt;li&gt;Maven &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L38-L60&quot;&gt;unpacks&lt;/a&gt; DynamoDB Local installation package;&lt;/li&gt; &lt;li&gt;Maven &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L61-L78&quot;&gt;reserves&lt;/a&gt; a random TCP port and stores its value into &lt;code&gt;${dynamo.port}&lt;/code&gt;;&lt;/li&gt; &lt;li&gt;Maven &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L79-L100&quot;&gt;saves&lt;/a&gt; &lt;code&gt;${dynamo.port}&lt;/code&gt; and key/secret pair info;&lt;/li&gt; &lt;li&gt;Maven &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L101-L128&quot;&gt;starts&lt;/a&gt; DynamoDB Local, binding it to the reserved TCP port;&lt;/li&gt; &lt;li&gt;Rake &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L57-L65&quot;&gt;waits&lt;/a&gt; for DynamoDB Local availability on the reserved port;&lt;/li&gt; &lt;li&gt;Rake &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L38-L39&quot;&gt;imports&lt;/a&gt; all &lt;a href=&quot;https://github.com/yegor256/sixnines/tree/0.17/test&quot;&gt;test classes&lt;/a&gt; starting from &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb&quot;&gt;test__helper.rb&lt;/a&gt;;&lt;/li&gt; &lt;li&gt;Environment variable &lt;code&gt;RACK_ENV&lt;/code&gt; is &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb#L25&quot;&gt;set&lt;/a&gt; to &lt;code&gt;&quot;test&quot;&lt;/code&gt;;&lt;/li&gt; &lt;li&gt;Rack::Test &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/test/test_sixnines.rb#L145&quot;&gt;attempts&lt;/a&gt; to dispatch a web page;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb&quot;&gt;&lt;code&gt;Dynamo&lt;/code&gt;&lt;/a&gt; &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb#L37-L39&quot;&gt;loads&lt;/a&gt; YAML config from &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/config/dynamo.yml&quot;&gt;&lt;code&gt;dynamo.yml&lt;/code&gt;&lt;/a&gt; and connects to DynamoDB Local;&lt;/li&gt; &lt;li&gt;Rake stops;&lt;/li&gt; &lt;li&gt;Ruby &lt;a href=&quot;https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L53-L56&quot;&gt;terminates&lt;/a&gt; Maven and it stops DynamoDB Local.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;That’s it.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html" /> <link rel="amphtml" href="https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.amp.html" /> <title>DynamoDB + Rake + Maven + Rack::Test </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2017/06/13/dynamodb-rack-maven.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2017/06/13/dynamodb-rack-maven.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html</code></p><h1 itemprop="name headline mainEntityOfPage">DynamoDB + Rake + Maven + Rack::Test</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2017-06-13T00:00:00+00:00"> 13 June 2017 </time> </li> <li class="desktop-only" itemprop="locationCreated">Odessa, Ukraine</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>In <a href="/2017/04/25/sixnines.html">SixNines.io</a>, one of my Ruby pet web apps, I’m using <a href="https://aws.amazon.com/dynamodb/">DynamoDB</a>, a NoSQL cloud database by <a href="https://aws.amazon.com/">AWS</a>. It works like a charm, but the problem is that it’s not so easy to create an integration test, to make sure my code works together with the “real” DynamoDB server and tables. Let me show you how it was solved. The code is open source and you can see it in the <a href="https://github.com/yegor256/sixnines">yegor256/sixnines</a> GitHub repo.</p><h2 id="how-to-bootstrap-dynamodb-local">How to bootstrap DynamoDB Local</h2><p>First, you need to use <a href="https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/">DynamoDB Local</a>, a command line tool created by AWS exactly for the purposes of testing. You need to start it before your integration tests and stop it afterwards.</p><p>To make things simpler I suggest you use <a href="http://dynamodb.jcabi.com/"><code>jcabi-dynamodb-maven-plugin</code></a>, a <a href="https://maven.apache.org/">Maven</a> plugin that I <a href="/2014/05/01/dynamodb-local-maven-plugin.html">made</a> a few years ago. You will need to add <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml"><code>pom.xml</code></a> to your repository and start/stop Maven from a <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile"><code>Rakefile</code></a>, just like I’m doing <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L50-L67">here</a>:</p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="n">task</span> <span class="ss">:dynamo</span> <span class="k">do</span>
  <span class="no">FileUtils</span><span class="o">.</span><span class="n">rm_rf</span><span class="p">(</span><span class="s1">&#39;dynamodb-local/target&#39;</span><span class="p">)</span>
  <span class="n">pid</span> <span class="o">=</span> <span class="no">Process</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="s1">&#39;mvn&#39;</span><span class="p">,</span> <span class="s1">&#39;install&#39;</span><span class="p">,</span> <span class="ss">chdir</span><span class="p">:</span> <span class="s1">&#39;dynamodb-local&#39;</span><span class="p">)</span>
  <span class="nb">at_exit</span> <span class="k">do</span>
    <span class="sb">`kill -TERM </span><span class="si">#{</span><span class="n">pid</span><span class="si">}</span><span class="sb">`</span>
  <span class="k">end</span>
  <span class="k">begin</span>
    <span class="no">Dynamo</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">aws</span><span class="o">.</span><span class="n">describe_table</span><span class="p">(</span><span class="ss">table_name</span><span class="p">:</span> <span class="s1">&#39;sn-endpoints&#39;</span><span class="p">)</span>
  <span class="k">rescue</span> <span class="no">Exception</span> <span class="o">=&gt;</span> <span class="n">e</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">retry</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure><p>First, I’m removing <code>dynamodb-local/target</code>, the directory where Maven keeps its temporary files, to make sure we always start from scratch.</p><p>Then, I’m starting <code>mvn install</code>, using <code>Process.spawn</code>, as a background process with <code>pid</code> as its process ID (this won’t work in Windows, only Linux/Mac). Then I immediately register an <a href="https://ruby-doc.org/core-2.2.3/Kernel.html#method-i-at_exit"><code>at_exit</code></a> Ruby hook, which will be executed if Ruby dies for any reason. I’m sure it’s obvious why I have to do that—in order to avoid garbage running in the background after Rake is finished or terminated.</p><p>Pay attention, I’m using <code>kill -TERM</code> instead of <code>kill -KILL</code>, in order to give Maven a chance to wrap everything up, terminate DynamoDB Local correctly, close its TCP port and exit.</p><h2 id="how-to-check-that-its-running">How to check that it’s running</h2><p>Next I’m checking the status of <code>sn-endpoints</code>, one of the tables in the DynamoDB Local. It has to be there if the server is up and running. It will be created by <code>jcabi-dynamodb-maven-plugin</code> according to <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/tables/sn-endpoints.json"><code>sn-endpoints.json</code></a>, its JSON configuration.</p><p>Most probably the table won’t be ready immediately though, since it takes time to bootstrap Maven, start the server, and create tables there. That’s why, if the exception is thrown, I catch it, wait for 5 seconds and try again. I keep trying many times, until the server is ready. Eventually it will be. It takes about 12-15 seconds on my MacBook, which means 2-3 attempts/exceptions.</p><h2 id="how-to-connect-to-dynamodb-local">How to connect to DynamoDB Local</h2><p>My classes need to know how to connect to the server during integration tests. In production they need to connect to AWS, in testing they have to know about the DynamoDB Local instance I just started. This is what I have in my class <a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb"><code>Dynamo</code></a>, which is responsible for the very connection with DynamoDB. Its decision on where to connect is based on the environment variable <code>RACK_ENV</code>, which is set to <code>"test"</code> in <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb#L25"><code>test__helper.rb</code></a>, which is included by <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L39"><code>rake/testtask</code></a> in front of all other tests, thanks to the double underscore in its name.</p><p>If the environment variable is set to <code>"test"</code>, <code>Dynamo</code> takes the connectivity parameters from the YAML file <a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb#L37"><code>dynamodb-local/target/dynamo.yml</code></a> created by <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L79-L100"><code>maven-resources-plugin:copy-resources</code></a>. The TCP port of the DynamoDB Local database will be <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/config/dynamo.yml">there</a>, as well as the DynamoDB authentication key and secret.</p><h2 id="how-to-run-the-integration-tests">How to run the integration tests</h2><p>This is the easiest part. I just use my objects the way they are supposed to be used in production and they connect to DynamoDB Local instead of AWS.</p><p>I’m using Rack::Test in order to test the entire application, via a set of HTTP calls. For example, <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test_sixnines.rb#L143-L147">here</a> I’m trying to render Jeff’s user account page. Its HTTP response code is supposed to be 200:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">require</span> <span class="err">&#39;</span><span class="n">test</span><span class="o">/</span><span class="n">unit</span><span class="err">&#39;</span>
<span class="n">require</span> <span class="err">&#39;</span><span class="n">rack</span><span class="o">/</span><span class="n">test</span><span class="err">&#39;</span>
<span class="kd">class</span> <span class="nc">AppTest</span> <span class="o">&lt;</span> <span class="n">Test</span><span class="o">::</span><span class="n">Unit</span><span class="o">::</span><span class="n">TestCase</span>
  <span class="n">include</span> <span class="n">Rack</span><span class="o">::</span><span class="n">Test</span><span class="o">::</span><span class="n">Methods</span>
  <span class="n">def</span> <span class="n">app</span>
    <span class="n">Sinatra</span><span class="o">::</span><span class="n">Application</span>
  <span class="n">end</span>
  <span class="n">def</span> <span class="n">test_user_account</span>
    <span class="nf">header</span><span class="o">(</span><span class="err">&#39;</span><span class="n">Cookie</span><span class="err">&#39;</span><span class="o">,</span> <span class="err">&#39;</span><span class="n">sixnines</span><span class="o">=</span><span class="n">jeff</span><span class="err">&#39;</span><span class="o">)</span>
    <span class="n">get</span><span class="o">(</span><span class="err">&#39;</span><span class="o">/</span><span class="n">a</span><span class="err">&#39;</span><span class="o">)</span>
    <span class="n">assert_equal</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="n">last_response</span><span class="o">.</span><span class="na">status</span><span class="o">)</span>
  <span class="n">end</span></code></pre></figure><p>##</p><p>Now you can run the entire test from the command line. You can see how <a href="/2014/09/11/deployment-script-vs-rultor.html">Rultor</a> runs it while releasing a new version: <a href="http://www.rultor.com/t/11705-302080694">full log</a>. Also, see how it works <a href="https://travis-ci.org/yegor256/sixnines">in Travis</a>. In a nutshell:</p><ul> <li>You call <code>rake</code> in the command line and Rake starts;</li> <li>Rake attempts to run the <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L32"><code>default</code></a> task, which depends on <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L36"><code>test</code></a>;</li> <li>Rake attempts to run <code>test</code>, which depends on <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L50"><code>dynamo</code></a>;</li> <li>Rake, inside <code>test</code> task, runs <code>mvn install</code> in the background with this <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml"><code>pom.xml</code></a>;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L38-L60">unpacks</a> DynamoDB Local installation package;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L61-L78">reserves</a> a random TCP port and stores its value into <code>${dynamo.port}</code>;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L79-L100">saves</a> <code>${dynamo.port}</code> and key/secret pair info;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L101-L128">starts</a> DynamoDB Local, binding it to the reserved TCP port;</li> <li>Rake <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L57-L65">waits</a> for DynamoDB Local availability on the reserved port;</li> <li>Rake <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L38-L39">imports</a> all <a href="https://github.com/yegor256/sixnines/tree/0.17/test">test classes</a> starting from <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb">test__helper.rb</a>;</li> <li>Environment variable <code>RACK_ENV</code> is <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb#L25">set</a> to <code>"test"</code>;</li> <li>Rack::Test <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test_sixnines.rb#L145">attempts</a> to dispatch a web page;</li> <li><a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb"><code>Dynamo</code></a> <a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb#L37-L39">loads</a> YAML config from <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/config/dynamo.yml"><code>dynamo.yml</code></a> and connects to DynamoDB Local;</li> <li>Rake stops;</li> <li>Ruby <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L53-L56">terminates</a> Maven and it stops DynamoDB Local.</li></ul><p>That’s it.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html&amp;text=DynamoDB+%2B+Rake+%2B+Maven+%2B+Rack%3A%3ATest" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html%3F2017-24&amp;title=DynamoDB+%2B+Rake+%2B+Maven+%2B+Rack%3A%3ATest" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2017/06/13/dynamodb-rack-maven.html%3F2017-24&amp;t=DynamoDB+%2B+Rake+%2B+Maven+%2B+Rack%3A%3ATest" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>In <a href="/2017/04/25/sixnines.html">SixNines.io</a>, one of my Ruby pet web apps, I’m using <a href="https://aws.amazon.com/dynamodb/">DynamoDB</a>, a NoSQL cloud database by <a href="https://aws.amazon.com/">AWS</a>. It works like a charm, but the problem is that it’s not so easy to create an integration test, to make sure my code works together with the “real” DynamoDB server and tables. Let me show you how it was solved. The code is open source and you can see it in the <a href="https://github.com/yegor256/sixnines">yegor256/sixnines</a> GitHub repo.</p><h2 id="how-to-bootstrap-dynamodb-local">How to bootstrap DynamoDB Local</h2><p>First, you need to use <a href="https://aws.amazon.com/blogs/aws/dynamodb-local-for-desktop-development/">DynamoDB Local</a>, a command line tool created by AWS exactly for the purposes of testing. You need to start it before your integration tests and stop it afterwards.</p><p>To make things simpler I suggest you use <a href="http://dynamodb.jcabi.com/"><code>jcabi-dynamodb-maven-plugin</code></a>, a <a href="https://maven.apache.org/">Maven</a> plugin that I <a href="/2014/05/01/dynamodb-local-maven-plugin.html">made</a> a few years ago. You will need to add <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml"><code>pom.xml</code></a> to your repository and start/stop Maven from a <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile"><code>Rakefile</code></a>, just like I’m doing <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L50-L67">here</a>:</p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="n">task</span> <span class="ss">:dynamo</span> <span class="k">do</span>
  <span class="no">FileUtils</span><span class="o">.</span><span class="n">rm_rf</span><span class="p">(</span><span class="s1">&#39;dynamodb-local/target&#39;</span><span class="p">)</span>
  <span class="n">pid</span> <span class="o">=</span> <span class="no">Process</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="s1">&#39;mvn&#39;</span><span class="p">,</span> <span class="s1">&#39;install&#39;</span><span class="p">,</span> <span class="ss">chdir</span><span class="p">:</span> <span class="s1">&#39;dynamodb-local&#39;</span><span class="p">)</span>
  <span class="nb">at_exit</span> <span class="k">do</span>
    <span class="sb">`kill -TERM </span><span class="si">#{</span><span class="n">pid</span><span class="si">}</span><span class="sb">`</span>
  <span class="k">end</span>
  <span class="k">begin</span>
    <span class="no">Dynamo</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">aws</span><span class="o">.</span><span class="n">describe_table</span><span class="p">(</span><span class="ss">table_name</span><span class="p">:</span> <span class="s1">&#39;sn-endpoints&#39;</span><span class="p">)</span>
  <span class="k">rescue</span> <span class="no">Exception</span> <span class="o">=&gt;</span> <span class="n">e</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">retry</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure><p>First, I’m removing <code>dynamodb-local/target</code>, the directory where Maven keeps its temporary files, to make sure we always start from scratch.</p><p>Then, I’m starting <code>mvn install</code>, using <code>Process.spawn</code>, as a background process with <code>pid</code> as its process ID (this won’t work in Windows, only Linux/Mac). Then I immediately register an <a href="https://ruby-doc.org/core-2.2.3/Kernel.html#method-i-at_exit"><code>at_exit</code></a> Ruby hook, which will be executed if Ruby dies for any reason. I’m sure it’s obvious why I have to do that—in order to avoid garbage running in the background after Rake is finished or terminated.</p><p>Pay attention, I’m using <code>kill -TERM</code> instead of <code>kill -KILL</code>, in order to give Maven a chance to wrap everything up, terminate DynamoDB Local correctly, close its TCP port and exit.</p><h2 id="how-to-check-that-its-running">How to check that it’s running</h2><p>Next I’m checking the status of <code>sn-endpoints</code>, one of the tables in the DynamoDB Local. It has to be there if the server is up and running. It will be created by <code>jcabi-dynamodb-maven-plugin</code> according to <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/tables/sn-endpoints.json"><code>sn-endpoints.json</code></a>, its JSON configuration.</p><p>Most probably the table won’t be ready immediately though, since it takes time to bootstrap Maven, start the server, and create tables there. That’s why, if the exception is thrown, I catch it, wait for 5 seconds and try again. I keep trying many times, until the server is ready. Eventually it will be. It takes about 12-15 seconds on my MacBook, which means 2-3 attempts/exceptions.</p><h2 id="how-to-connect-to-dynamodb-local">How to connect to DynamoDB Local</h2><p>My classes need to know how to connect to the server during integration tests. In production they need to connect to AWS, in testing they have to know about the DynamoDB Local instance I just started. This is what I have in my class <a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb"><code>Dynamo</code></a>, which is responsible for the very connection with DynamoDB. Its decision on where to connect is based on the environment variable <code>RACK_ENV</code>, which is set to <code>"test"</code> in <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb#L25"><code>test__helper.rb</code></a>, which is included by <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L39"><code>rake/testtask</code></a> in front of all other tests, thanks to the double underscore in its name.</p><p>If the environment variable is set to <code>"test"</code>, <code>Dynamo</code> takes the connectivity parameters from the YAML file <a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb#L37"><code>dynamodb-local/target/dynamo.yml</code></a> created by <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L79-L100"><code>maven-resources-plugin:copy-resources</code></a>. The TCP port of the DynamoDB Local database will be <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/config/dynamo.yml">there</a>, as well as the DynamoDB authentication key and secret.</p><h2 id="how-to-run-the-integration-tests">How to run the integration tests</h2><p>This is the easiest part. I just use my objects the way they are supposed to be used in production and they connect to DynamoDB Local instead of AWS.</p><p>I’m using Rack::Test in order to test the entire application, via a set of HTTP calls. For example, <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test_sixnines.rb#L143-L147">here</a> I’m trying to render Jeff’s user account page. Its HTTP response code is supposed to be 200:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">require</span> <span class="err">&#39;</span><span class="n">test</span><span class="o">/</span><span class="n">unit</span><span class="err">&#39;</span>
<span class="n">require</span> <span class="err">&#39;</span><span class="n">rack</span><span class="o">/</span><span class="n">test</span><span class="err">&#39;</span>
<span class="kd">class</span> <span class="nc">AppTest</span> <span class="o">&lt;</span> <span class="n">Test</span><span class="o">::</span><span class="n">Unit</span><span class="o">::</span><span class="n">TestCase</span>
  <span class="n">include</span> <span class="n">Rack</span><span class="o">::</span><span class="n">Test</span><span class="o">::</span><span class="n">Methods</span>
  <span class="n">def</span> <span class="n">app</span>
    <span class="n">Sinatra</span><span class="o">::</span><span class="n">Application</span>
  <span class="n">end</span>
  <span class="n">def</span> <span class="n">test_user_account</span>
    <span class="nf">header</span><span class="o">(</span><span class="err">&#39;</span><span class="n">Cookie</span><span class="err">&#39;</span><span class="o">,</span> <span class="err">&#39;</span><span class="n">sixnines</span><span class="o">=</span><span class="n">jeff</span><span class="err">&#39;</span><span class="o">)</span>
    <span class="n">get</span><span class="o">(</span><span class="err">&#39;</span><span class="o">/</span><span class="n">a</span><span class="err">&#39;</span><span class="o">)</span>
    <span class="n">assert_equal</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="n">last_response</span><span class="o">.</span><span class="na">status</span><span class="o">)</span>
  <span class="n">end</span></code></pre></figure><p>##</p><p>Now you can run the entire test from the command line. You can see how <a href="/2014/09/11/deployment-script-vs-rultor.html">Rultor</a> runs it while releasing a new version: <a href="http://www.rultor.com/t/11705-302080694">full log</a>. Also, see how it works <a href="https://travis-ci.org/yegor256/sixnines">in Travis</a>. In a nutshell:</p><ul> <li>You call <code>rake</code> in the command line and Rake starts;</li> <li>Rake attempts to run the <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L32"><code>default</code></a> task, which depends on <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L36"><code>test</code></a>;</li> <li>Rake attempts to run <code>test</code>, which depends on <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L50"><code>dynamo</code></a>;</li> <li>Rake, inside <code>test</code> task, runs <code>mvn install</code> in the background with this <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml"><code>pom.xml</code></a>;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L38-L60">unpacks</a> DynamoDB Local installation package;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L61-L78">reserves</a> a random TCP port and stores its value into <code>${dynamo.port}</code>;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L79-L100">saves</a> <code>${dynamo.port}</code> and key/secret pair info;</li> <li>Maven <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/pom.xml#L101-L128">starts</a> DynamoDB Local, binding it to the reserved TCP port;</li> <li>Rake <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L57-L65">waits</a> for DynamoDB Local availability on the reserved port;</li> <li>Rake <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L38-L39">imports</a> all <a href="https://github.com/yegor256/sixnines/tree/0.17/test">test classes</a> starting from <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb">test__helper.rb</a>;</li> <li>Environment variable <code>RACK_ENV</code> is <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test__helper.rb#L25">set</a> to <code>"test"</code>;</li> <li>Rack::Test <a href="https://github.com/yegor256/sixnines/blob/0.17/test/test_sixnines.rb#L145">attempts</a> to dispatch a web page;</li> <li><a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb"><code>Dynamo</code></a> <a href="https://github.com/yegor256/sixnines/blob/0.17/objects/dynamo.rb#L37-L39">loads</a> YAML config from <a href="https://github.com/yegor256/sixnines/blob/0.17/dynamodb-local/config/dynamo.yml"><code>dynamo.yml</code></a> and connects to DynamoDB Local;</li> <li>Rake stops;</li> <li>Ruby <a href="https://github.com/yegor256/sixnines/blob/0.17/Rakefile#L53-L56">terminates</a> Maven and it stops DynamoDB Local.</li></ul><p>That’s it.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, redirect_from, layout, title, date, place, tags, description, keywords, image, jb_picture, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2017-05-23 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Any Program Has an Unlimited Number of Bugs"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;This may sound strange, but I will prove it: no matter how big or stable a piece of software is, it has an &lt;em&gt;unlimited&lt;/em&gt; number of bugs not yet found. No matter how many of them we have already managed to find and fix, there are still too many left to count.&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;L&amp;#39;amico di famiglia (2006) by Paolo Sorrentino&quot; src=&quot;/images/2017/05/lamico-di-famiglia.jpg&quot; longdesc=&quot;#5232e494&quot; /&gt;&lt;figcaption id=&quot;5232e494&quot;&gt;L&amp;#39;amico di famiglia (2006) by Paolo Sorrentino&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;Let’s take this simple Java method that calculates a sum of two integers as an example:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;This simple program has an &lt;em&gt;unlimited&lt;/em&gt; number of bugs.&lt;/p&gt; &lt;p&gt;To prove this claim we just need to put two thoughts together:&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;p&gt;First, a bug is something that compromises the quality of software, which, according to &lt;a href=&quot;https://standards.ieee.org/findstds/standard/610.12-1990.html&quot;&gt;IEEE 610.12-1990&lt;/a&gt;, is “the degree to which a system meets specified requirements or &lt;em&gt;user expectations&lt;/em&gt;.”&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Second, requirements and expectations may be functional and non-functional. The latter include performance, resilience, robustness, &lt;em&gt;maintainability&lt;/em&gt;, and a few dozen other &lt;a href=&quot;https://en.wikipedia.org/wiki/Non-functional_requirement&quot;&gt;NFRs&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;p&gt;It is obvious that there are at least two variables in this equation that are ambiguous: user expectations and &lt;a href=&quot;/2015/06/11/wikipedia-bug-definition.html&quot;&gt;maintainability&lt;/a&gt;. We can’t be precise about them and that’s why the number of bugs they will produce has no limit.&lt;/p&gt; &lt;p&gt;Of course, only a very limited subset of the entire set of bugs has any real business impact. Most of the bugs that exist in a program may stay there even after it is shipped to its users—nobody will ever find them or else the damage they cause to the user experience will be insignificant.&lt;/p&gt; &lt;p&gt;Finally, take a look at the method &lt;code&gt;sum()&lt;/code&gt; one more time. How about these bugs:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;It doesn’t handle overflows&lt;/li&gt; &lt;li&gt;It doesn’t have any user documentation&lt;/li&gt; &lt;li&gt;Its design is not object-oriented&lt;/li&gt; &lt;li&gt;It doesn’t sum three or more numbers&lt;/li&gt; &lt;li&gt;It doesn’t sum &lt;code&gt;double&lt;/code&gt; numbers&lt;/li&gt; &lt;li&gt;It doesn’t cast &lt;code&gt;long&lt;/code&gt; to &lt;code&gt;int&lt;/code&gt; automatically&lt;/li&gt; &lt;li&gt;It doesn’t skip execution if one argument is zero&lt;/li&gt; &lt;li&gt;It doesn’t cache results of previous calculations&lt;/li&gt; &lt;li&gt;There is no logging&lt;/li&gt; &lt;li&gt;Checkstyle would complain since arguments are not &lt;code&gt;final&lt;/code&gt;&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;I’m sure you can find many more.&lt;/p&gt; &lt;p&gt;BTW, Glenford J. Myers said something very similar in his book “&lt;a href=&quot;http://amzn.to/1Y3qAbN&quot;&gt;The Art of Software Testing&lt;/a&gt;,” which I &lt;a href=&quot;/2014/08/22/art-of-software-testing.html&quot;&gt;reviewed&lt;/a&gt; earlier.&lt;/p&gt; &lt;p&gt;Bill Hetzel, &lt;a href=&quot;http://amzn.to/2HziEtM&quot;&gt;&lt;strong&gt;The Complete Guide to Software Testing&lt;/strong&gt;&lt;/a&gt; (1993): “Some Theoretical Limits to Testing: ‘We can never be sure the specifications are correct,’ ‘No testing system can identify every correct program,’ ‘We can never be certain that a testing system is correct.’ These theoretical limits tell us that there will never be a way to be sure we have a perfect understanding of what a program is supposed to do (the expected or required results) and that any testing system we might construct will always have some possibility of failing. In short, we cannot achieve 100 percent confidence no matter how much time and energy we put into it!”&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html" /> <link rel="amphtml" href="https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.amp.html" /> <title>Any Program Has an Unlimited Number of Bugs </title> <meta name='og:image' content='https://www.yegor256.com/images/2017/05/lamico-di-famiglia.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2017/05/lamico-di-famiglia.jpg'/><meta name='og:image:width' content='1280'/> <meta name='twitter:image:width' content='1280'/><meta name='og:image:height' content='578'/> <meta name='twitter:image:height' content='578'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='L&#39;amico di famiglia (2006) by Paolo Sorrentino'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2017/05/23/unlimited-number-of-bugs.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2017/05/23/unlimited-number-of-bugs.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html</code></p><h1 itemprop="name headline mainEntityOfPage">Any Program Has an Unlimited Number of Bugs</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2017-05-23T00:00:00+00:00"> 23 May 2017 </time> </li> <li class="desktop-only" itemprop="locationCreated">Odessa, Ukraine</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>This may sound strange, but I will prove it: no matter how big or stable a piece of software is, it has an <em>unlimited</em> number of bugs not yet found. No matter how many of them we have already managed to find and fix, there are still too many left to count.</p><figure class="jb_picture"><img itemprop="image" alt="L&#39;amico di famiglia (2006) by Paolo Sorrentino" src="/images/2017/05/lamico-di-famiglia.jpg" longdesc="#5232e494" /><figcaption id="5232e494">L&#39;amico di famiglia (2006) by Paolo Sorrentino</figcaption></figure><p>Let’s take this simple Java method that calculates a sum of two integers as an example:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kt">int</span> <span class="nf">sum</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure><p>This simple program has an <em>unlimited</em> number of bugs.</p><p>To prove this claim we just need to put two thoughts together:</p><ul> <li><p>First, a bug is something that compromises the quality of software, which, according to <a href="https://standards.ieee.org/findstds/standard/610.12-1990.html">IEEE 610.12-1990</a>, is “the degree to which a system meets specified requirements or <em>user expectations</em>.”</p></li> <li><p>Second, requirements and expectations may be functional and non-functional. The latter include performance, resilience, robustness, <em>maintainability</em>, and a few dozen other <a href="https://en.wikipedia.org/wiki/Non-functional_requirement">NFRs</a>.</p></li></ul><p>It is obvious that there are at least two variables in this equation that are ambiguous: user expectations and <a href="/2015/06/11/wikipedia-bug-definition.html">maintainability</a>. We can’t be precise about them and that’s why the number of bugs they will produce has no limit.</p><p>Of course, only a very limited subset of the entire set of bugs has any real business impact. Most of the bugs that exist in a program may stay there even after it is shipped to its users—nobody will ever find them or else the damage they cause to the user experience will be insignificant.</p><p>Finally, take a look at the method <code>sum()</code> one more time. How about these bugs:</p><ul> <li>It doesn’t handle overflows</li> <li>It doesn’t have any user documentation</li> <li>Its design is not object-oriented</li> <li>It doesn’t sum three or more numbers</li> <li>It doesn’t sum <code>double</code> numbers</li> <li>It doesn’t cast <code>long</code> to <code>int</code> automatically</li> <li>It doesn’t skip execution if one argument is zero</li> <li>It doesn’t cache results of previous calculations</li> <li>There is no logging</li> <li>Checkstyle would complain since arguments are not <code>final</code></li></ul><p>I’m sure you can find many more.</p><p>BTW, Glenford J. Myers said something very similar in his book “<a href="http://amzn.to/1Y3qAbN">The Art of Software Testing</a>,” which I <a href="/2014/08/22/art-of-software-testing.html">reviewed</a> earlier.</p><p>Bill Hetzel, <a href="http://amzn.to/2HziEtM"><strong>The Complete Guide to Software Testing</strong></a> (1993): “Some Theoretical Limits to Testing: ‘We can never be sure the specifications are correct,’ ‘No testing system can identify every correct program,’ ‘We can never be certain that a testing system is correct.’ These theoretical limits tell us that there will never be a way to be sure we have a perfect understanding of what a program is supposed to do (the expected or required results) and that any testing system we might construct will always have some possibility of failing. In short, we cannot achieve 100 percent confidence no matter how much time and energy we put into it!”</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html&amp;text=Any+Program+Has+an+Unlimited+Number+of+Bugs" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html%3F2017-21&amp;title=Any+Program+Has+an+Unlimited+Number+of+Bugs" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2017/05/23/unlimited-number-of-bugs.html%3F2017-21&amp;t=Any+Program+Has+an+Unlimited+Number+of+Bugs" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>This may sound strange, but I will prove it: no matter how big or stable a piece of software is, it has an <em>unlimited</em> number of bugs not yet found. No matter how many of them we have already managed to find and fix, there are still too many left to count.</p><figure class="jb_picture"><img itemprop="image" alt="L&#39;amico di famiglia (2006) by Paolo Sorrentino" src="/images/2017/05/lamico-di-famiglia.jpg" longdesc="#5232e494" /><figcaption id="5232e494">L&#39;amico di famiglia (2006) by Paolo Sorrentino</figcaption></figure><p>Let’s take this simple Java method that calculates a sum of two integers as an example:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kt">int</span> <span class="nf">sum</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure><p>This simple program has an <em>unlimited</em> number of bugs.</p><p>To prove this claim we just need to put two thoughts together:</p><ul> <li><p>First, a bug is something that compromises the quality of software, which, according to <a href="https://standards.ieee.org/findstds/standard/610.12-1990.html">IEEE 610.12-1990</a>, is “the degree to which a system meets specified requirements or <em>user expectations</em>.”</p></li> <li><p>Second, requirements and expectations may be functional and non-functional. The latter include performance, resilience, robustness, <em>maintainability</em>, and a few dozen other <a href="https://en.wikipedia.org/wiki/Non-functional_requirement">NFRs</a>.</p></li></ul><p>It is obvious that there are at least two variables in this equation that are ambiguous: user expectations and <a href="/2015/06/11/wikipedia-bug-definition.html">maintainability</a>. We can’t be precise about them and that’s why the number of bugs they will produce has no limit.</p><p>Of course, only a very limited subset of the entire set of bugs has any real business impact. Most of the bugs that exist in a program may stay there even after it is shipped to its users—nobody will ever find them or else the damage they cause to the user experience will be insignificant.</p><p>Finally, take a look at the method <code>sum()</code> one more time. How about these bugs:</p><ul> <li>It doesn’t handle overflows</li> <li>It doesn’t have any user documentation</li> <li>Its design is not object-oriented</li> <li>It doesn’t sum three or more numbers</li> <li>It doesn’t sum <code>double</code> numbers</li> <li>It doesn’t cast <code>long</code> to <code>int</code> automatically</li> <li>It doesn’t skip execution if one argument is zero</li> <li>It doesn’t cache results of previous calculations</li> <li>There is no logging</li> <li>Checkstyle would complain since arguments are not <code>final</code></li></ul><p>I’m sure you can find many more.</p><p>BTW, Glenford J. Myers said something very similar in his book “<a href="http://amzn.to/1Y3qAbN">The Art of Software Testing</a>,” which I <a href="/2014/08/22/art-of-software-testing.html">reviewed</a> earlier.</p><p>Bill Hetzel, <a href="http://amzn.to/2HziEtM"><strong>The Complete Guide to Software Testing</strong></a> (1993): “Some Theoretical Limits to Testing: ‘We can never be sure the specifications are correct,’ ‘No testing system can identify every correct program,’ ‘We can never be certain that a testing system is correct.’ These theoretical limits tell us that there will never be a way to be sure we have a perfect understanding of what a program is supposed to do (the expected or required results) and that any testing system we might construct will always have some possibility of failing. In short, we cannot achieve 100 percent confidence no matter how much time and energy we put into it!”</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, place, tags, description, keywords, image, jb_picture, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2017-05-17 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Single Statement Unit Tests"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;Many articles and books have already been written about unit testing patterns and anti-patterns. I want to add one more recommendation which, I believe, can help us make our tests, &lt;em&gt;and&lt;/em&gt; our production code, more &lt;em&gt;object-oriented&lt;/em&gt;. Here it is: a test method must contain nothing but a single &lt;code&gt;assert&lt;/code&gt;.&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;Bullet (1996) by Julien Temple&quot; src=&quot;/images/2017/05/bullet.jpg&quot; longdesc=&quot;#80ac9633&quot; /&gt;&lt;figcaption id=&quot;80ac9633&quot;&gt;Bullet (1996) by Julien Temple&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;Look at this test method from &lt;code&gt;RandomStreamTest&lt;/code&gt; from OpenJDK 8, created by Brian Goetz:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testIntStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;There are two parts in this method: the algorithm and the assertion. The algorithm prepares two arrays of integers and the assertion compares them and throws &lt;code&gt;AssertionError&lt;/code&gt; if they are not equal.&lt;/p&gt; &lt;aside class=&quot;youtube&quot;&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=1bAixLaOCSA&quot;&gt;&lt;div class=&quot;box&quot;&gt; &lt;img src=&quot;https://i.ytimg.com/vi/1bAixLaOCSA/mqdefault.jpg&quot; alt=&quot;YouTube video #1bAixLaOCSA&quot; /&gt; &lt;div class=&quot;play&quot;&gt;&lt;i class=&quot;icon icon-play&quot;&gt;&lt;/i&gt;&lt;/div&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt;Java Day Minsk 2017 | Yegor Bugayenko - Object Oriented JUnit Tests; 3 June 2017.&lt;/div&gt;&lt;/aside&gt; &lt;p&gt;I’m saying that the first part, the algorithm, is the one we should try to avoid. The only thing we must have is the assertion. Here is how I would re-design this test method:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testIntStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ArrayFromRandom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ArrayFromRandom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ArrayFromRandom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;If Java had &lt;a href=&quot;/2017/05/16/monikers.html&quot;&gt;monikers&lt;/a&gt; this code would look even more elegant:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testIntStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assertEquals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ArrayFromRandom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SIZE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toArray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;As you can see, there is only one “statement” in this method: &lt;code&gt;assertEquals()&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;http://hamcrest.org/&quot;&gt;Hamcrest&lt;/a&gt; with its &lt;a href=&quot;http://hamcrest.org/JavaHamcrest/javadoc/2.0.0.0/org/hamcrest/MatcherAssert.html&quot;&gt;&lt;code&gt;assertThat()&lt;/code&gt;&lt;/a&gt; and its &lt;a href=&quot;http://hamcrest.org/JavaHamcrest/javadoc/2.0.0.0/allclasses-frame.html&quot;&gt;collection&lt;/a&gt; of basic matchers is a perfect instrument to make our single-statement test methods even more cohesive and readable.&lt;/p&gt; &lt;aside class=&quot;youtube&quot;&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=CCr8hRE_TUs&quot;&gt;&lt;div class=&quot;box&quot;&gt; &lt;img src=&quot;https://i.ytimg.com/vi/CCr8hRE_TUs/mqdefault.jpg&quot; alt=&quot;YouTube video #CCr8hRE_TUs&quot; /&gt; &lt;div class=&quot;play&quot;&gt;&lt;i class=&quot;icon icon-play&quot;&gt;&lt;/i&gt;&lt;/div&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt;Object-Oriented Flavor for JUnit Tests; 29 May 2017.&lt;/div&gt;&lt;/aside&gt; &lt;p&gt;There are a number of practical benefits of this principle, if we agree to follow it:&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Reusability&lt;/strong&gt;. The classes we will have to create for test assertions will be reusable in other test methods and test cases. Just as, in the example above, &lt;code&gt;ArrayFromRandom&lt;/code&gt; could be used somewhere else. Similarly, Hamcrest matchers may and will constitute a library of reusable test components.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Brevity&lt;/strong&gt;. Since it will be rather difficult to create a long test method when it only has a single &lt;code&gt;assert&lt;/code&gt;, you and your fellow programmers will inevitably write shorter and more readable code.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Readability&lt;/strong&gt;. With a single &lt;code&gt;assert&lt;/code&gt; it will always be obvious what the intent of the test method is. It will start with the intent declaration while all other lower level details will be indented.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;strong&gt;Immutability&lt;/strong&gt;. It will be almost impossible to have &lt;a href=&quot;/2014/09/16/getters-and-setters-are-evil.html&quot;&gt;setters&lt;/a&gt; in the production code if test methods have no place for algorithmic code. You inevitably will create &lt;a href=&quot;/2014/06/09/objects-should-be-immutable.html&quot;&gt;immutable objects&lt;/a&gt; to make them testable with a single &lt;code&gt;assert&lt;/code&gt;.&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;p&gt;The biggest benefit we get when this principle is applied to our tests is that they become declarative and object-oriented, instead of being algorithmic, imperative, and procedural.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html" /> <link rel="amphtml" href="https://www.yegor256.com/2017/05/17/single-statement-unit-tests.amp.html" /> <title>Single Statement Unit Tests </title> <meta name='og:image' content='https://www.yegor256.com/images/2017/05/bullet.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2017/05/bullet.jpg'/><meta name='og:image:width' content='1670'/> <meta name='twitter:image:width' content='1670'/><meta name='og:image:height' content='924'/> <meta name='twitter:image:height' content='924'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='Bullet (1996) by Julien Temple'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2017/05/17/single-statement-unit-tests.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2017/05/17/single-statement-unit-tests.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html</code></p><h1 itemprop="name headline mainEntityOfPage">Single Statement Unit Tests</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2017-05-17T00:00:00+00:00"> 17 May 2017 </time> </li> <li class="desktop-only" itemprop="locationCreated">Odessa, Ukraine</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>Many articles and books have already been written about unit testing patterns and anti-patterns. I want to add one more recommendation which, I believe, can help us make our tests, <em>and</em> our production code, more <em>object-oriented</em>. Here it is: a test method must contain nothing but a single <code>assert</code>.</p><figure class="jb_picture"><img itemprop="image" alt="Bullet (1996) by Julien Temple" src="/images/2017/05/bullet.jpg" longdesc="#80ac9633" /><figcaption id="80ac9633">Bullet (1996) by Julien Temple</figcaption></figure><p>Look at this test method from <code>RandomStreamTest</code> from OpenJDK 8, created by Brian Goetz:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIntStream</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">final</span> <span class="kt">long</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
  <span class="kd">final</span> <span class="n">Random</span> <span class="n">r1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">);</span>
  <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">SIZE</span><span class="o">];</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SIZE</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">final</span> <span class="n">Random</span> <span class="n">r2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">);</span>
  <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">b</span> <span class="o">=</span> <span class="n">r2</span><span class="o">.</span><span class="na">ints</span><span class="o">().</span><span class="na">limit</span><span class="o">(</span><span class="n">SIZE</span><span class="o">).</span><span class="na">toArray</span><span class="o">();</span>
  <span class="n">assertEquals</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>There are two parts in this method: the algorithm and the assertion. The algorithm prepares two arrays of integers and the assertion compares them and throws <code>AssertionError</code> if they are not equal.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=1bAixLaOCSA"><div class="box"> <img src="https://i.ytimg.com/vi/1bAixLaOCSA/mqdefault.jpg" alt="YouTube video #1bAixLaOCSA" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Java Day Minsk 2017 | Yegor Bugayenko - Object Oriented JUnit Tests; 3 June 2017.</div></aside><p>I’m saying that the first part, the algorithm, is the one we should try to avoid. The only thing we must have is the assertion. Here is how I would re-design this test method:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIntStream</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">final</span> <span class="kt">long</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
  <span class="n">assertEquals</span><span class="o">(</span>
    <span class="k">new</span> <span class="n">ArrayFromRandom</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">)</span>
    <span class="o">).</span><span class="na">toArray</span><span class="o">(</span><span class="n">SIZE</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">).</span><span class="na">ints</span><span class="o">().</span><span class="na">limit</span><span class="o">(</span><span class="n">SIZE</span><span class="o">).</span><span class="na">toArray</span><span class="o">()</span>
  <span class="o">);</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ArrayFromRandom</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">random</span><span class="o">;</span>
  <span class="n">ArrayFromRandom</span><span class="o">(</span><span class="n">Random</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">random</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kt">int</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">s</span><span class="o">];</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>If Java had <a href="/2017/05/16/monikers.html">monikers</a> this code would look even more elegant:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIntStream</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">assertEquals</span><span class="o">(</span>
    <span class="k">new</span> <span class="n">ArrayFromRandom</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="n">as</span> <span class="n">seed</span><span class="o">)</span>
    <span class="o">).</span><span class="na">toArray</span><span class="o">(</span><span class="n">SIZE</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">).</span><span class="na">ints</span><span class="o">().</span><span class="na">limit</span><span class="o">(</span><span class="n">SIZE</span><span class="o">).</span><span class="na">toArray</span><span class="o">()</span>
  <span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>As you can see, there is only one “statement” in this method: <code>assertEquals()</code>.</p><p><a href="http://hamcrest.org/">Hamcrest</a> with its <a href="http://hamcrest.org/JavaHamcrest/javadoc/2.0.0.0/org/hamcrest/MatcherAssert.html"><code>assertThat()</code></a> and its <a href="http://hamcrest.org/JavaHamcrest/javadoc/2.0.0.0/allclasses-frame.html">collection</a> of basic matchers is a perfect instrument to make our single-statement test methods even more cohesive and readable.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=CCr8hRE_TUs"><div class="box"> <img src="https://i.ytimg.com/vi/CCr8hRE_TUs/mqdefault.jpg" alt="YouTube video #CCr8hRE_TUs" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Object-Oriented Flavor for JUnit Tests; 29 May 2017.</div></aside><p>There are a number of practical benefits of this principle, if we agree to follow it:</p><ul> <li><p><strong>Reusability</strong>. The classes we will have to create for test assertions will be reusable in other test methods and test cases. Just as, in the example above, <code>ArrayFromRandom</code> could be used somewhere else. Similarly, Hamcrest matchers may and will constitute a library of reusable test components.</p></li> <li><p><strong>Brevity</strong>. Since it will be rather difficult to create a long test method when it only has a single <code>assert</code>, you and your fellow programmers will inevitably write shorter and more readable code.</p></li> <li><p><strong>Readability</strong>. With a single <code>assert</code> it will always be obvious what the intent of the test method is. It will start with the intent declaration while all other lower level details will be indented.</p></li> <li><p><strong>Immutability</strong>. It will be almost impossible to have <a href="/2014/09/16/getters-and-setters-are-evil.html">setters</a> in the production code if test methods have no place for algorithmic code. You inevitably will create <a href="/2014/06/09/objects-should-be-immutable.html">immutable objects</a> to make them testable with a single <code>assert</code>.</p></li></ul><p>The biggest benefit we get when this principle is applied to our tests is that they become declarative and object-oriented, instead of being algorithmic, imperative, and procedural.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html&amp;text=Single+Statement+Unit+Tests" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html%3F2017-20&amp;title=Single+Statement+Unit+Tests" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2017/05/17/single-statement-unit-tests.html%3F2017-20&amp;t=Single+Statement+Unit+Tests" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>Many articles and books have already been written about unit testing patterns and anti-patterns. I want to add one more recommendation which, I believe, can help us make our tests, <em>and</em> our production code, more <em>object-oriented</em>. Here it is: a test method must contain nothing but a single <code>assert</code>.</p><figure class="jb_picture"><img itemprop="image" alt="Bullet (1996) by Julien Temple" src="/images/2017/05/bullet.jpg" longdesc="#80ac9633" /><figcaption id="80ac9633">Bullet (1996) by Julien Temple</figcaption></figure><p>Look at this test method from <code>RandomStreamTest</code> from OpenJDK 8, created by Brian Goetz:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIntStream</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">final</span> <span class="kt">long</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
  <span class="kd">final</span> <span class="n">Random</span> <span class="n">r1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">);</span>
  <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">SIZE</span><span class="o">];</span>
  <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SIZE</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">r1</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">final</span> <span class="n">Random</span> <span class="n">r2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">);</span>
  <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">b</span> <span class="o">=</span> <span class="n">r2</span><span class="o">.</span><span class="na">ints</span><span class="o">().</span><span class="na">limit</span><span class="o">(</span><span class="n">SIZE</span><span class="o">).</span><span class="na">toArray</span><span class="o">();</span>
  <span class="n">assertEquals</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>There are two parts in this method: the algorithm and the assertion. The algorithm prepares two arrays of integers and the assertion compares them and throws <code>AssertionError</code> if they are not equal.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=1bAixLaOCSA"><div class="box"> <img src="https://i.ytimg.com/vi/1bAixLaOCSA/mqdefault.jpg" alt="YouTube video #1bAixLaOCSA" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Java Day Minsk 2017 | Yegor Bugayenko - Object Oriented JUnit Tests; 3 June 2017.</div></aside><p>I’m saying that the first part, the algorithm, is the one we should try to avoid. The only thing we must have is the assertion. Here is how I would re-design this test method:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIntStream</span><span class="o">()</span> <span class="o">{</span>
  <span class="kd">final</span> <span class="kt">long</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
  <span class="n">assertEquals</span><span class="o">(</span>
    <span class="k">new</span> <span class="n">ArrayFromRandom</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">)</span>
    <span class="o">).</span><span class="na">toArray</span><span class="o">(</span><span class="n">SIZE</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">).</span><span class="na">ints</span><span class="o">().</span><span class="na">limit</span><span class="o">(</span><span class="n">SIZE</span><span class="o">).</span><span class="na">toArray</span><span class="o">()</span>
  <span class="o">);</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ArrayFromRandom</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Random</span> <span class="n">random</span><span class="o">;</span>
  <span class="n">ArrayFromRandom</span><span class="o">(</span><span class="n">Random</span> <span class="n">r</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">random</span> <span class="o">=</span> <span class="n">r</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kt">int</span><span class="o">[]</span> <span class="nf">toArray</span><span class="o">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">s</span><span class="o">];</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
      <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>If Java had <a href="/2017/05/16/monikers.html">monikers</a> this code would look even more elegant:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testIntStream</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">assertEquals</span><span class="o">(</span>
    <span class="k">new</span> <span class="n">ArrayFromRandom</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="n">as</span> <span class="n">seed</span><span class="o">)</span>
    <span class="o">).</span><span class="na">toArray</span><span class="o">(</span><span class="n">SIZE</span><span class="o">),</span>
    <span class="k">new</span> <span class="n">Random</span><span class="o">(</span><span class="n">seed</span><span class="o">).</span><span class="na">ints</span><span class="o">().</span><span class="na">limit</span><span class="o">(</span><span class="n">SIZE</span><span class="o">).</span><span class="na">toArray</span><span class="o">()</span>
  <span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>As you can see, there is only one “statement” in this method: <code>assertEquals()</code>.</p><p><a href="http://hamcrest.org/">Hamcrest</a> with its <a href="http://hamcrest.org/JavaHamcrest/javadoc/2.0.0.0/org/hamcrest/MatcherAssert.html"><code>assertThat()</code></a> and its <a href="http://hamcrest.org/JavaHamcrest/javadoc/2.0.0.0/allclasses-frame.html">collection</a> of basic matchers is a perfect instrument to make our single-statement test methods even more cohesive and readable.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=CCr8hRE_TUs"><div class="box"> <img src="https://i.ytimg.com/vi/CCr8hRE_TUs/mqdefault.jpg" alt="YouTube video #CCr8hRE_TUs" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Object-Oriented Flavor for JUnit Tests; 29 May 2017.</div></aside><p>There are a number of practical benefits of this principle, if we agree to follow it:</p><ul> <li><p><strong>Reusability</strong>. The classes we will have to create for test assertions will be reusable in other test methods and test cases. Just as, in the example above, <code>ArrayFromRandom</code> could be used somewhere else. Similarly, Hamcrest matchers may and will constitute a library of reusable test components.</p></li> <li><p><strong>Brevity</strong>. Since it will be rather difficult to create a long test method when it only has a single <code>assert</code>, you and your fellow programmers will inevitably write shorter and more readable code.</p></li> <li><p><strong>Readability</strong>. With a single <code>assert</code> it will always be obvious what the intent of the test method is. It will start with the intent declaration while all other lower level details will be indented.</p></li> <li><p><strong>Immutability</strong>. It will be almost impossible to have <a href="/2014/09/16/getters-and-setters-are-evil.html">setters</a> in the production code if test methods have no place for algorithmic code. You inevitably will create <a href="/2014/06/09/objects-should-be-immutable.html">immutable objects</a> to make them testable with a single <code>assert</code>.</p></li></ul><p>The biggest benefit we get when this principle is applied to our tests is that they become declarative and object-oriented, instead of being algorithmic, imperative, and procedural.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, place, tags, description, keywords, image, jb_picture, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2017-03-24 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="The TDD That Works for Me"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Test-driven_development&quot;&gt;Test-driven development&lt;/a&gt; (a.k.a. TDD) was &lt;a href=&quot;https://www.quora.com/Why-does-Kent-Beck-refer-to-the-rediscovery-of-test-driven-development&quot;&gt;rediscovered&lt;/a&gt; by &lt;a href=&quot;https://en.wikipedia.org/wiki/Kent_Beck&quot;&gt;Kent Beck&lt;/a&gt; and explained in &lt;a href=&quot;http://amzn.to/2mTuxCs&quot;&gt;his famous book&lt;/a&gt; in 2002. In 2014, David Heinemeier Hansson (the creator of Ruby on Rails) said that TDD &lt;a href=&quot;http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html&quot;&gt;is dead&lt;/a&gt; and only &lt;a href=&quot;http://david.heinemeierhansson.com/2014/test-induced-design-damage.html&quot;&gt;harms architecture&lt;/a&gt;. &lt;a href=&quot;https://en.wikipedia.org/wiki/Robert_Cecil_Martin&quot;&gt;Robert Martin&lt;/a&gt; (the inventor of the &lt;a href=&quot;/2017/03/28/solid.html&quot;&gt;SOLID principles&lt;/a&gt;) &lt;a href=&quot;https://8thlight.com/blog/uncle-bob/2014/04/25/MonogamousTDD.html&quot;&gt;disagreed&lt;/a&gt; and &lt;a href=&quot;https://8thlight.com/blog/uncle-bob/2014/04/30/When-tdd-does-not-work.html&quot;&gt;explained&lt;/a&gt; that TDD may not work only in certain cases. A few days later, he even &lt;a href=&quot;https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html&quot;&gt;compared&lt;/a&gt; the importance of TDD with the importance of hand-washing for medicine, and added that “it would not surprise me if, one day, TDD had the force of law behind it.” Two years later, now just a few months ago, he wrote &lt;a href=&quot;http://blog.cleancoder.com/uncle-bob/2017/03/03/TDD-Harms-Architecture.html&quot;&gt;more&lt;/a&gt; about it, and &lt;a href=&quot;http://blog.cleancoder.com/uncle-bob/2017/03/06/TestingLikeTheTSA.html&quot;&gt;more&lt;/a&gt;, and &lt;a href=&quot;http://blog.cleancoder.com/uncle-bob/2016/11/10/TDD-Doesnt-work.html&quot;&gt;more&lt;/a&gt;. This subject seems to be hot. Of course, I have my own take on it; let me share.&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;La grande bellezza (2013) by Paolo Sorrentino&quot; src=&quot;/images/2017/03/la-grande-bellezza.jpg&quot; longdesc=&quot;#91c781a0&quot; /&gt;&lt;figcaption id=&quot;91c781a0&quot;&gt;La grande bellezza (2013) by Paolo Sorrentino&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;In theory, TDD means “writing tests first and code next.” In practice, according to &lt;a href=&quot;https://www.zerocracy.com&quot;&gt;my experience&lt;/a&gt; while working with more than 250 developers over the last four years, it means writing tests when we’re in a good mood and have nothing else to do. And this is only logical, if we understand TDD literally, by &lt;a href=&quot;https://en.wikipedia.org/wiki/Kent_Beck&quot;&gt;the book&lt;/a&gt;.&lt;/p&gt; &lt;aside class=&quot;quote&quot;&gt;I have never done TDD by the book: tests first and code next.&lt;/aside&gt; &lt;p&gt;Writing a test for a class without having that class in front of you is &lt;em&gt;difficult&lt;/em&gt;. I would even say impossible, if we are talking about real code, not calculator examples. It’s also very &lt;em&gt;inefficient&lt;/em&gt;, because tests by definition are much more rigid than the code they validate—creating them first will cause many re-do cycles until the design is stabilized.&lt;/p&gt; &lt;p&gt;I’ve personally &lt;a href=&quot;https://github.com/yegor256&quot;&gt;written&lt;/a&gt; almost 300,000 lines of code in Java, Ruby, PHP, and JavaScript over the last four years, and I have never done TDD by the book: “write a test, make it run, make it right.” Ever.&lt;/p&gt; &lt;h2 id=&quot;code-deploy-break-test-fix&quot;&gt;Code, Deploy, Break, Test, Fix&lt;/h2&gt; &lt;p&gt;Even though I’m a huge fan of automated testing (unit or integration) and totally &lt;a href=&quot;https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html&quot;&gt;agree&lt;/a&gt; with Uncle Bob: Those who don’t write tests must be put &lt;a href=&quot;/2015/11/24/imprisonment-for-irresponsible-coding.html&quot;&gt;in jail&lt;/a&gt;, I just have my own interpretation of TDD. This is how it looks:&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;ul&gt; &lt;li&gt; &lt;p&gt;First, I write &lt;strong&gt;code&lt;/strong&gt; without any tests. A lot of code. I implement the functionality and create the design. Dozens of classes. Of course, the build is automated, the deployment pipeline is configured, and I can test the product myself in a sandbox. I make sure “&lt;a href=&quot;https://blog.codinghorror.com/the-works-on-my-machine-certification-program/&quot;&gt;it works on my machine&lt;/a&gt;.”&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Then, I &lt;strong&gt;deploy&lt;/strong&gt; it to production. Yes, it goes to my “users” without any tests because it works for me. They are either real users if it’s something open source or one of my &lt;a href=&quot;/pets.html&quot;&gt;pet projects&lt;/a&gt;, or manual testers if it’s a money project.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Then, they &lt;strong&gt;break&lt;/strong&gt; it. They either test it or they use it; it doesn’t matter. They just find problems and report bugs. As many as they can.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Right after some bugs are reported, I pick the most critical of them and…voilà!…I create an automated &lt;strong&gt;test&lt;/strong&gt;. The bug is a message to me that my tests are weak; I have to fix them first. A new test will prove that the code is broken. Or maybe I fix an existing one. This is where I go “tests first.” I don’t touch the production code until I manage to break my build and prove the problem’s existence with a new test. Then, I do &lt;code&gt;git commit.&lt;/code&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Finally, it’s time to &lt;strong&gt;fix&lt;/strong&gt; the problem. I make changes to the production code in order to make sure the build is green again. Then, I do &lt;code&gt;git commit&lt;/code&gt; and &lt;code&gt;git push.&lt;/code&gt; And I go back to the “deploy” step; the updated product goes to my users.&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Once in a while, I have to make serious modifications to the product, like to introduce a new feature or perform a massive refactoring. In this case, I go back to the first step and do it without tests.&lt;/p&gt; &lt;h2 id=&quot;the-reasoning-behind&quot;&gt;The Reasoning Behind&lt;/h2&gt; &lt;p&gt;The justification behind this no-tests-upfront approach is simple: We don’t need to test until it’s broken, mostly because we understand that it’s technically not possible to test everything or to fix all bugs. We have to fix only what’s visible and intolerable by the business. If the business doesn’t care or our users/testers don’t see our bugs—we must not &lt;strong&gt;waste&lt;/strong&gt; project resources on fixing them.&lt;/p&gt; &lt;aside class=&quot;quote&quot;&gt;I only create tests later when my users express the need for them by reporting bugs.&lt;/aside&gt; &lt;p&gt;On the other hand, when the business or our users/testers are complaining, we have to be very strict with ourselves; our testing system is weak and must be fixed first. We can’t just fix the production code and deploy, because in this case, we may make this mistake again after some refactoring, and our tests won’t catch it. The user will find the bug again, and the business will pay us again to fix it. That will be the &lt;strong&gt;waste&lt;/strong&gt; of resources.&lt;/p&gt; &lt;p&gt;As you can see, it’s all money-driven. First, don’t fix anything if nobody pays for it. Second, fix it once and for all if they actually paid. It’s as simple as that.&lt;/p&gt; &lt;h2 id=&quot;the-dynamics&quot;&gt;The Dynamics&lt;/h2&gt; &lt;p&gt;Thanks to this test-and-fix-only-when-broken approach, the balance between production code and test code is not the same over the entire project lifecycle. When the project starts, there are almost no tests. Then, the number of tests grows together with the number of bugs. Eventually, the situation stabilizes, and we can move the product from beta version to the first release.&lt;/p&gt; &lt;p&gt;I created a simple &lt;a href=&quot;https://github.com/yegor256/tdx&quot;&gt;command line tool&lt;/a&gt; in order to demonstrate the statistics from a few projects of mine, to prove my point. Take a look at these graphs:&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/yegor256/takes&quot;&gt;yegor256/takes&lt;/a&gt; (Web framework, Java):&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf-takes.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/yegor256/xembly&quot;&gt;yegor256/xembly&lt;/a&gt; (XML builder, Java):&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf-xembly.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/jcabi/jcabi-aspects&quot;&gt;jcabi/jcabi-aspects&lt;/a&gt; (AOP library, Java):&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf-jcabi-aspects.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/yegor256/s3auth&quot;&gt;yegor256/s3auth&lt;/a&gt; (S3 gateway, Java):&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf-s3auth.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;p&gt;First commercial project:&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf-xockets-layer.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;p&gt;Second commercial project:&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;object data=&quot;https://www.yegor256.com/images/2017/03/cdbtf-xockets-hadoop-transport.svg&quot; type=&quot;image/svg+xml&quot; itemprop=&quot;image&quot; style=&quot;width:600px;max-width:100%;&quot; alt=&quot;The figure&quot;&gt;&lt;/object&gt;&lt;/figure&gt; &lt;p&gt;In each graph, there are two parts. The first one on the top demonstrates the dynamics of production &lt;a href=&quot;/2014/11/14/hits-of-code.html&quot;&gt;Hits-of-Code&lt;/a&gt; (green line), test-related HoC (red line), and the number of issues reported to GitHub (orange line).&lt;/p&gt; &lt;p&gt;The bottom part shows how big the test-related HoC portion is relative to all project activity. In other words, it shows how much &lt;em&gt;effort&lt;/em&gt; the project invested into automated tests, compared with the total effort.&lt;/p&gt; &lt;p&gt;This is what I want you to pay attention to: The shape of the curve is almost the same in every project. It looks very similar to a &lt;a href=&quot;https://en.wikipedia.org/wiki/Learning_curve&quot;&gt;learning curve&lt;/a&gt;, where we start to learn fast and then slow down over time:&lt;/p&gt; &lt;figure class=&quot;unprintable&quot;&gt;&lt;img src=&quot;https://www.yegor256.com/images/2017/03/cdbtf-graph.png&quot; itemprop=&quot;image&quot; style=&quot;width:450px;max-width:100%;&quot; alt=&quot;The figure&quot; /&gt;&lt;/figure&gt; &lt;p&gt;This perfectly illustrates what I just described above. I don’t need tests at the beginning of the project; I create them later when my users express the need for them by reporting bugs. This dynamic looks only logical to me.&lt;/p&gt; &lt;p&gt;You can also analyze your project using &lt;a href=&quot;https://github.com/yegor256/tdx&quot;&gt;my tool&lt;/a&gt; and see the graph. It would be interesting to learn what kind of curve you will get.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2017/03/24/tdd-that-works.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2017/03/24/tdd-that-works.html" /> <link rel="amphtml" href="https://www.yegor256.com/2017/03/24/tdd-that-works.amp.html" /> <title>The TDD That Works for Me </title> <meta name='og:image' content='https://www.yegor256.com/images/2017/03/la-grande-bellezza.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2017/03/la-grande-bellezza.jpg'/><meta name='og:image:width' content='1917'/> <meta name='twitter:image:width' content='1917'/><meta name='og:image:height' content='812'/> <meta name='twitter:image:height' content='812'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='La grande bellezza (2013) by Paolo Sorrentino'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2017/03/24/tdd-that-works.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2017/03/24/tdd-that-works.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2017/03/24/tdd-that-works.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2017/03/24/tdd-that-works.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2017/03/24/tdd-that-works.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2017/03/24/tdd-that-works.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2017/03/24/tdd-that-works.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2017/03/24/tdd-that-works.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2017/03/24/tdd-that-works.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2017/03/24/tdd-that-works.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2017/03/24/tdd-that-works.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2017/03/24/tdd-that-works.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2017/03/24/tdd-that-works.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2017/03/24/tdd-that-works.html</code></p><h1 itemprop="name headline mainEntityOfPage">The TDD That Works for Me</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2017-03-24T00:00:00+00:00"> 24 March 2017 </time> </li> <li class="desktop-only" itemprop="locationCreated">Frankfurt, Germany</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2017/03/24/tdd-that-works.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p><a href="https://en.wikipedia.org/wiki/Test-driven_development">Test-driven development</a> (a.k.a. TDD) was <a href="https://www.quora.com/Why-does-Kent-Beck-refer-to-the-rediscovery-of-test-driven-development">rediscovered</a> by <a href="https://en.wikipedia.org/wiki/Kent_Beck">Kent Beck</a> and explained in <a href="http://amzn.to/2mTuxCs">his famous book</a> in 2002. In 2014, David Heinemeier Hansson (the creator of Ruby on Rails) said that TDD <a href="http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html">is dead</a> and only <a href="http://david.heinemeierhansson.com/2014/test-induced-design-damage.html">harms architecture</a>. <a href="https://en.wikipedia.org/wiki/Robert_Cecil_Martin">Robert Martin</a> (the inventor of the <a href="/2017/03/28/solid.html">SOLID principles</a>) <a href="https://8thlight.com/blog/uncle-bob/2014/04/25/MonogamousTDD.html">disagreed</a> and <a href="https://8thlight.com/blog/uncle-bob/2014/04/30/When-tdd-does-not-work.html">explained</a> that TDD may not work only in certain cases. A few days later, he even <a href="https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html">compared</a> the importance of TDD with the importance of hand-washing for medicine, and added that “it would not surprise me if, one day, TDD had the force of law behind it.” Two years later, now just a few months ago, he wrote <a href="http://blog.cleancoder.com/uncle-bob/2017/03/03/TDD-Harms-Architecture.html">more</a> about it, and <a href="http://blog.cleancoder.com/uncle-bob/2017/03/06/TestingLikeTheTSA.html">more</a>, and <a href="http://blog.cleancoder.com/uncle-bob/2016/11/10/TDD-Doesnt-work.html">more</a>. This subject seems to be hot. Of course, I have my own take on it; let me share.</p><figure class="jb_picture"><img itemprop="image" alt="La grande bellezza (2013) by Paolo Sorrentino" src="/images/2017/03/la-grande-bellezza.jpg" longdesc="#91c781a0" /><figcaption id="91c781a0">La grande bellezza (2013) by Paolo Sorrentino</figcaption></figure><p>In theory, TDD means “writing tests first and code next.” In practice, according to <a href="https://www.zerocracy.com">my experience</a> while working with more than 250 developers over the last four years, it means writing tests when we’re in a good mood and have nothing else to do. And this is only logical, if we understand TDD literally, by <a href="https://en.wikipedia.org/wiki/Kent_Beck">the book</a>.</p><aside class="quote">I have never done TDD by the book: tests first and code next.</aside><p>Writing a test for a class without having that class in front of you is <em>difficult</em>. I would even say impossible, if we are talking about real code, not calculator examples. It’s also very <em>inefficient</em>, because tests by definition are much more rigid than the code they validate—creating them first will cause many re-do cycles until the design is stabilized.</p><p>I’ve personally <a href="https://github.com/yegor256">written</a> almost 300,000 lines of code in Java, Ruby, PHP, and JavaScript over the last four years, and I have never done TDD by the book: “write a test, make it run, make it right.” Ever.</p><h2 id="code-deploy-break-test-fix">Code, Deploy, Break, Test, Fix</h2><p>Even though I’m a huge fan of automated testing (unit or integration) and totally <a href="https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html">agree</a> with Uncle Bob: Those who don’t write tests must be put <a href="/2015/11/24/imprisonment-for-irresponsible-coding.html">in jail</a>, I just have my own interpretation of TDD. This is how it looks:</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><ul> <li><p>First, I write <strong>code</strong> without any tests. A lot of code. I implement the functionality and create the design. Dozens of classes. Of course, the build is automated, the deployment pipeline is configured, and I can test the product myself in a sandbox. I make sure “<a href="https://blog.codinghorror.com/the-works-on-my-machine-certification-program/">it works on my machine</a>.”</p></li> <li><p>Then, I <strong>deploy</strong> it to production. Yes, it goes to my “users” without any tests because it works for me. They are either real users if it’s something open source or one of my <a href="/pets.html">pet projects</a>, or manual testers if it’s a money project.</p></li> <li><p>Then, they <strong>break</strong> it. They either test it or they use it; it doesn’t matter. They just find problems and report bugs. As many as they can.</p></li> <li><p>Right after some bugs are reported, I pick the most critical of them and…voilà!…I create an automated <strong>test</strong>. The bug is a message to me that my tests are weak; I have to fix them first. A new test will prove that the code is broken. Or maybe I fix an existing one. This is where I go “tests first.” I don’t touch the production code until I manage to break my build and prove the problem’s existence with a new test. Then, I do <code>git commit.</code></p></li> <li><p>Finally, it’s time to <strong>fix</strong> the problem. I make changes to the production code in order to make sure the build is green again. Then, I do <code>git commit</code> and <code>git push.</code> And I go back to the “deploy” step; the updated product goes to my users.</p></li></ul><p>Once in a while, I have to make serious modifications to the product, like to introduce a new feature or perform a massive refactoring. In this case, I go back to the first step and do it without tests.</p><h2 id="the-reasoning-behind">The Reasoning Behind</h2><p>The justification behind this no-tests-upfront approach is simple: We don’t need to test until it’s broken, mostly because we understand that it’s technically not possible to test everything or to fix all bugs. We have to fix only what’s visible and intolerable by the business. If the business doesn’t care or our users/testers don’t see our bugs—we must not <strong>waste</strong> project resources on fixing them.</p><aside class="quote">I only create tests later when my users express the need for them by reporting bugs.</aside><p>On the other hand, when the business or our users/testers are complaining, we have to be very strict with ourselves; our testing system is weak and must be fixed first. We can’t just fix the production code and deploy, because in this case, we may make this mistake again after some refactoring, and our tests won’t catch it. The user will find the bug again, and the business will pay us again to fix it. That will be the <strong>waste</strong> of resources.</p><p>As you can see, it’s all money-driven. First, don’t fix anything if nobody pays for it. Second, fix it once and for all if they actually paid. It’s as simple as that.</p><h2 id="the-dynamics">The Dynamics</h2><p>Thanks to this test-and-fix-only-when-broken approach, the balance between production code and test code is not the same over the entire project lifecycle. When the project starts, there are almost no tests. Then, the number of tests grows together with the number of bugs. Eventually, the situation stabilizes, and we can move the product from beta version to the first release.</p><p>I created a simple <a href="https://github.com/yegor256/tdx">command line tool</a> in order to demonstrate the statistics from a few projects of mine, to prove my point. Take a look at these graphs:</p><p><a href="https://github.com/yegor256/takes">yegor256/takes</a> (Web framework, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-takes.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/yegor256/xembly">yegor256/xembly</a> (XML builder, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-xembly.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/jcabi/jcabi-aspects">jcabi/jcabi-aspects</a> (AOP library, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-jcabi-aspects.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/yegor256/s3auth">yegor256/s3auth</a> (S3 gateway, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-s3auth.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>First commercial project:</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-xockets-layer.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>Second commercial project:</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-xockets-hadoop-transport.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>In each graph, there are two parts. The first one on the top demonstrates the dynamics of production <a href="/2014/11/14/hits-of-code.html">Hits-of-Code</a> (green line), test-related HoC (red line), and the number of issues reported to GitHub (orange line).</p><p>The bottom part shows how big the test-related HoC portion is relative to all project activity. In other words, it shows how much <em>effort</em> the project invested into automated tests, compared with the total effort.</p><p>This is what I want you to pay attention to: The shape of the curve is almost the same in every project. It looks very similar to a <a href="https://en.wikipedia.org/wiki/Learning_curve">learning curve</a>, where we start to learn fast and then slow down over time:</p><figure class="unprintable"><img src="https://www.yegor256.com/images/2017/03/cdbtf-graph.png" itemprop="image" style="width:450px;max-width:100%;" alt="The figure" /></figure><p>This perfectly illustrates what I just described above. I don’t need tests at the beginning of the project; I create them later when my users express the need for them by reporting bugs. This dynamic looks only logical to me.</p><p>You can also analyze your project using <a href="https://github.com/yegor256/tdx">my tool</a> and see the graph. It would be interesting to learn what kind of curve you will get.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2017/03/24/tdd-that-works.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html&amp;text=The+TDD+That+Works+for+Me" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html%3F2017-12&amp;title=The+TDD+That+Works+for+Me" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2017/03/24/tdd-that-works.html%3F2017-12&amp;t=The+TDD+That+Works+for+Me" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p><a href="https://en.wikipedia.org/wiki/Test-driven_development">Test-driven development</a> (a.k.a. TDD) was <a href="https://www.quora.com/Why-does-Kent-Beck-refer-to-the-rediscovery-of-test-driven-development">rediscovered</a> by <a href="https://en.wikipedia.org/wiki/Kent_Beck">Kent Beck</a> and explained in <a href="http://amzn.to/2mTuxCs">his famous book</a> in 2002. In 2014, David Heinemeier Hansson (the creator of Ruby on Rails) said that TDD <a href="http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html">is dead</a> and only <a href="http://david.heinemeierhansson.com/2014/test-induced-design-damage.html">harms architecture</a>. <a href="https://en.wikipedia.org/wiki/Robert_Cecil_Martin">Robert Martin</a> (the inventor of the <a href="/2017/03/28/solid.html">SOLID principles</a>) <a href="https://8thlight.com/blog/uncle-bob/2014/04/25/MonogamousTDD.html">disagreed</a> and <a href="https://8thlight.com/blog/uncle-bob/2014/04/30/When-tdd-does-not-work.html">explained</a> that TDD may not work only in certain cases. A few days later, he even <a href="https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html">compared</a> the importance of TDD with the importance of hand-washing for medicine, and added that “it would not surprise me if, one day, TDD had the force of law behind it.” Two years later, now just a few months ago, he wrote <a href="http://blog.cleancoder.com/uncle-bob/2017/03/03/TDD-Harms-Architecture.html">more</a> about it, and <a href="http://blog.cleancoder.com/uncle-bob/2017/03/06/TestingLikeTheTSA.html">more</a>, and <a href="http://blog.cleancoder.com/uncle-bob/2016/11/10/TDD-Doesnt-work.html">more</a>. This subject seems to be hot. Of course, I have my own take on it; let me share.</p><figure class="jb_picture"><img itemprop="image" alt="La grande bellezza (2013) by Paolo Sorrentino" src="/images/2017/03/la-grande-bellezza.jpg" longdesc="#91c781a0" /><figcaption id="91c781a0">La grande bellezza (2013) by Paolo Sorrentino</figcaption></figure><p>In theory, TDD means “writing tests first and code next.” In practice, according to <a href="https://www.zerocracy.com">my experience</a> while working with more than 250 developers over the last four years, it means writing tests when we’re in a good mood and have nothing else to do. And this is only logical, if we understand TDD literally, by <a href="https://en.wikipedia.org/wiki/Kent_Beck">the book</a>.</p><aside class="quote">I have never done TDD by the book: tests first and code next.</aside><p>Writing a test for a class without having that class in front of you is <em>difficult</em>. I would even say impossible, if we are talking about real code, not calculator examples. It’s also very <em>inefficient</em>, because tests by definition are much more rigid than the code they validate—creating them first will cause many re-do cycles until the design is stabilized.</p><p>I’ve personally <a href="https://github.com/yegor256">written</a> almost 300,000 lines of code in Java, Ruby, PHP, and JavaScript over the last four years, and I have never done TDD by the book: “write a test, make it run, make it right.” Ever.</p><h2 id="code-deploy-break-test-fix">Code, Deploy, Break, Test, Fix</h2><p>Even though I’m a huge fan of automated testing (unit or integration) and totally <a href="https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html">agree</a> with Uncle Bob: Those who don’t write tests must be put <a href="/2015/11/24/imprisonment-for-irresponsible-coding.html">in jail</a>, I just have my own interpretation of TDD. This is how it looks:</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><ul> <li><p>First, I write <strong>code</strong> without any tests. A lot of code. I implement the functionality and create the design. Dozens of classes. Of course, the build is automated, the deployment pipeline is configured, and I can test the product myself in a sandbox. I make sure “<a href="https://blog.codinghorror.com/the-works-on-my-machine-certification-program/">it works on my machine</a>.”</p></li> <li><p>Then, I <strong>deploy</strong> it to production. Yes, it goes to my “users” without any tests because it works for me. They are either real users if it’s something open source or one of my <a href="/pets.html">pet projects</a>, or manual testers if it’s a money project.</p></li> <li><p>Then, they <strong>break</strong> it. They either test it or they use it; it doesn’t matter. They just find problems and report bugs. As many as they can.</p></li> <li><p>Right after some bugs are reported, I pick the most critical of them and…voilà!…I create an automated <strong>test</strong>. The bug is a message to me that my tests are weak; I have to fix them first. A new test will prove that the code is broken. Or maybe I fix an existing one. This is where I go “tests first.” I don’t touch the production code until I manage to break my build and prove the problem’s existence with a new test. Then, I do <code>git commit.</code></p></li> <li><p>Finally, it’s time to <strong>fix</strong> the problem. I make changes to the production code in order to make sure the build is green again. Then, I do <code>git commit</code> and <code>git push.</code> And I go back to the “deploy” step; the updated product goes to my users.</p></li></ul><p>Once in a while, I have to make serious modifications to the product, like to introduce a new feature or perform a massive refactoring. In this case, I go back to the first step and do it without tests.</p><h2 id="the-reasoning-behind">The Reasoning Behind</h2><p>The justification behind this no-tests-upfront approach is simple: We don’t need to test until it’s broken, mostly because we understand that it’s technically not possible to test everything or to fix all bugs. We have to fix only what’s visible and intolerable by the business. If the business doesn’t care or our users/testers don’t see our bugs—we must not <strong>waste</strong> project resources on fixing them.</p><aside class="quote">I only create tests later when my users express the need for them by reporting bugs.</aside><p>On the other hand, when the business or our users/testers are complaining, we have to be very strict with ourselves; our testing system is weak and must be fixed first. We can’t just fix the production code and deploy, because in this case, we may make this mistake again after some refactoring, and our tests won’t catch it. The user will find the bug again, and the business will pay us again to fix it. That will be the <strong>waste</strong> of resources.</p><p>As you can see, it’s all money-driven. First, don’t fix anything if nobody pays for it. Second, fix it once and for all if they actually paid. It’s as simple as that.</p><h2 id="the-dynamics">The Dynamics</h2><p>Thanks to this test-and-fix-only-when-broken approach, the balance between production code and test code is not the same over the entire project lifecycle. When the project starts, there are almost no tests. Then, the number of tests grows together with the number of bugs. Eventually, the situation stabilizes, and we can move the product from beta version to the first release.</p><p>I created a simple <a href="https://github.com/yegor256/tdx">command line tool</a> in order to demonstrate the statistics from a few projects of mine, to prove my point. Take a look at these graphs:</p><p><a href="https://github.com/yegor256/takes">yegor256/takes</a> (Web framework, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-takes.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/yegor256/xembly">yegor256/xembly</a> (XML builder, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-xembly.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/jcabi/jcabi-aspects">jcabi/jcabi-aspects</a> (AOP library, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-jcabi-aspects.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/yegor256/s3auth">yegor256/s3auth</a> (S3 gateway, Java):</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-s3auth.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>First commercial project:</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-xockets-layer.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>Second commercial project:</p><figure class="unprintable"><object data="https://www.yegor256.com/images/2017/03/cdbtf-xockets-hadoop-transport.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>In each graph, there are two parts. The first one on the top demonstrates the dynamics of production <a href="/2014/11/14/hits-of-code.html">Hits-of-Code</a> (green line), test-related HoC (red line), and the number of issues reported to GitHub (orange line).</p><p>The bottom part shows how big the test-related HoC portion is relative to all project activity. In other words, it shows how much <em>effort</em> the project invested into automated tests, compared with the total effort.</p><p>This is what I want you to pay attention to: The shape of the curve is almost the same in every project. It looks very similar to a <a href="https://en.wikipedia.org/wiki/Learning_curve">learning curve</a>, where we start to learn fast and then slow down over time:</p><figure class="unprintable"><img src="https://www.yegor256.com/images/2017/03/cdbtf-graph.png" itemprop="image" style="width:450px;max-width:100%;" alt="The figure" /></figure><p>This perfectly illustrates what I just described above. I don’t need tests at the beginning of the project; I create them later when my users express the need for them by reporting bugs. This dynamic looks only logical to me.</p><p>You can also analyze your project using <a href="https://github.com/yegor256/tdx">my tool</a> and see the graph. It would be interesting to learn what kind of curve you will get.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, place, tags, description, keywords, image, jb_picture, republished, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2015-09-10 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="When Do You Stop Testing?"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;There is a software to be tested. There is a team of testers. There is some money in the budget. There is some time in the schedule. We start right now. Testers are trying to break the product, finding bugs, reporting bugs, communicating with programmers when necessary, doing their best to find what’s wrong. Eventually they stop and say “we’re done.” How do they know when to stop? When there is enough testing? It’s obvious—when there are &lt;em&gt;no more bugs left&lt;/em&gt; and the product can be shipped! If you think like this, I have bad news for you. You’re &lt;em&gt;fundamentally wrong&lt;/em&gt;.&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;La fille sur le pont (1999) by Patrice Leconte&quot; src=&quot;/images/2015/09/la-fille-sur-le-pont.jpg&quot; longdesc=&quot;#3e0b5dd3&quot; /&gt;&lt;figcaption id=&quot;3e0b5dd3&quot;&gt;La fille sur le pont (1999) by Patrice Leconte&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;All this is perfectly explained by Glenford Myers in his &lt;a href=&quot;http://amzn.to/1Y3qAbN&quot;&gt;great book&lt;/a&gt; &lt;a href=&quot;/2014/08/22/art-of-software-testing.html&quot;&gt;The Art of Software Testing&lt;/a&gt;. I will just summarize it here again.&lt;/p&gt; &lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://amzn.to/1Y3qAbN&quot;&gt;&lt;img src=&quot;https://www.yegor256.com/images/2015/04/book-art-of-testing.jpg&quot; style=&quot;width:96px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;First, “testing is the process of executing a program with the intent of &lt;em&gt;finding errors&lt;/em&gt;” (page 6). Pay attention, the intent is to find errors. Not to prove that the product works fine, but to prove that it &lt;em&gt;doesn’t work&lt;/em&gt; as intended. The goal of any tester is to show how the product can be broken, how it fails on different inputs, how it crashes under stress, how it misunderstands the user, how it doesn’t satisfy the requirements. This is why Dr. Myers is calling testing “a destructive, even sadistic, process” (page 6). This is what most testers don’t understand.&lt;/p&gt; &lt;aside class=&quot;youtube&quot;&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=wd-SA1HVmLg&quot;&gt;&lt;div class=&quot;box&quot;&gt; &lt;img src=&quot;https://i.ytimg.com/vi/wd-SA1HVmLg/mqdefault.jpg&quot; alt=&quot;YouTube video #wd-SA1HVmLg&quot; /&gt; &lt;div class=&quot;play&quot;&gt;&lt;i class=&quot;icon icon-play&quot;&gt;&lt;/i&gt;&lt;/div&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt;How Do You Know When Your Product is Ready to be Shipped?; 18 November 2016.&lt;/div&gt;&lt;/aside&gt; &lt;p&gt;Second, any software &lt;a href=&quot;/2017/05/23/unlimited-number-of-bugs.html&quot;&gt;has&lt;/a&gt; an &lt;em&gt;unlimited amount of bugs&lt;/em&gt;. Dr. Myers says that “you cannot test a program to guarantee that it is error free” (page 10) and that “it is impractical, often impossible, to find all the errors in a program” (page 8). This is also what most testers don’t understand. They believe that there is a &lt;a href=&quot;/2015/06/18/good-programmers-bug-free.html&quot;&gt;limited number&lt;/a&gt; of bugs, which they have to find and call it a day. There literally &lt;a href=&quot;/2017/05/23/unlimited-number-of-bugs.html&quot;&gt;no limit&lt;/a&gt;! The amount of bugs is unlimited, in any software product. No matter how small or big, complex or simple, new or old is the product.&lt;/p&gt; &lt;aside class=&quot;quote&quot;&gt;They can't find all bugs, no matter how much time we give them&lt;/aside&gt; &lt;p&gt;Having these axioms in mind, let’s try to decide when testers have to stop. According to Dr. Myers, “one of the most difficult questions to answer when testing a program is determining when to stop, since there is no way of knowing if the error just detected is the last remaining error” (page 135).&lt;/p&gt; &lt;p&gt;They can’t find all bugs, no matter how much time we give them. And they are motivated to find more and more of them. But at some point of time we must make a decision and release the product. Looks like we will release it with bugs inside? Yes, indeed! We will release a product &lt;em&gt;full of bugs&lt;/em&gt;. The only question is how many of them were found already and how critical they were.&lt;/p&gt; &lt;p&gt;Let’s put it all together. There are too many bugs to be able to find all of them in a reasonable amount of time. However, we have to release a new version, sooner or later. At the same time, testers will always tell us that there are more bugs there and they can find more, just need more time. What to do?&lt;/p&gt; &lt;p&gt;Dr. Myers says that “since the goal of testing is to find errors, why not make the completion criterion the detection of some predefined number of errors?” (page 136). Indeed, we should predict how many bugs are just enough to find, in order to have a desirable level of &lt;em&gt;confidence&lt;/em&gt; that the product is ready to be shipped. Then, ship it, consciously understanding that it still has an unlimited amount of not yet discovered bugs.&lt;/p&gt; &lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://amzn.to/266oJr4&quot;&gt;&lt;img src=&quot;https://www.yegor256.com/images/2015/04/book-object-thinking.jpg&quot; style=&quot;width:96px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;David West in &lt;a href=&quot;http://amzn.to/266oJr4&quot;&gt;Object Thinking&lt;/a&gt; says that “software is released for use, not when it is known to be correct, but when the rate of discovering errors slows down to one that management considers acceptable” (page 13).&lt;/p&gt; &lt;p&gt;Thus, the only valid criteria for exiting a testing process is the discovery of a &lt;em&gt;forecast&lt;/em&gt; amount of bugs.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2015/09/10/testing-exit-criteria.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2015/09/10/testing-exit-criteria.html" /> <link rel="amphtml" href="https://www.yegor256.com/2015/09/10/testing-exit-criteria.amp.html" /> <title>When Do You Stop Testing? </title> <meta name='og:image' content='https://www.yegor256.com/images/2015/09/la-fille-sur-le-pont.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2015/09/la-fille-sur-le-pont.jpg'/><meta name='og:image:width' content='1280'/> <meta name='twitter:image:width' content='1280'/><meta name='og:image:height' content='720'/> <meta name='twitter:image:height' content='720'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='La fille sur le pont (1999) by Patrice Leconte'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2015/09/10/testing-exit-criteria.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2015/09/10/testing-exit-criteria.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2015/09/10/testing-exit-criteria.html</code></p><h1 itemprop="name headline mainEntityOfPage">When Do You Stop Testing?</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2015-09-10T00:00:00+00:00"> 10 September 2015 </time> </li> <li class="desktop-only" itemprop="locationCreated">Moscow, Russia</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2015/09/10/testing-exit-criteria.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><ul class="subline"> <li>Republished in:</li> <li><a href="https://cacm.acm.org/blogs/blog-cacm/228226-the-goal-of-software-testing/fulltext">BLOG@CACM</a></li></ul><p class="unprintable"><p>There is a software to be tested. There is a team of testers. There is some money in the budget. There is some time in the schedule. We start right now. Testers are trying to break the product, finding bugs, reporting bugs, communicating with programmers when necessary, doing their best to find what’s wrong. Eventually they stop and say “we’re done.” How do they know when to stop? When there is enough testing? It’s obvious—when there are <em>no more bugs left</em> and the product can be shipped! If you think like this, I have bad news for you. You’re <em>fundamentally wrong</em>.</p><figure class="jb_picture"><img itemprop="image" alt="La fille sur le pont (1999) by Patrice Leconte" src="/images/2015/09/la-fille-sur-le-pont.jpg" longdesc="#3e0b5dd3" /><figcaption id="3e0b5dd3">La fille sur le pont (1999) by Patrice Leconte</figcaption></figure><p>All this is perfectly explained by Glenford Myers in his <a href="http://amzn.to/1Y3qAbN">great book</a> <a href="/2014/08/22/art-of-software-testing.html">The Art of Software Testing</a>. I will just summarize it here again.</p><figure class="badge"><a href="http://amzn.to/1Y3qAbN"><img src="https://www.yegor256.com/images/2015/04/book-art-of-testing.jpg" style="width:96px;max-width:100%;" alt="badge" /></a></figure><p>First, “testing is the process of executing a program with the intent of <em>finding errors</em>” (page 6). Pay attention, the intent is to find errors. Not to prove that the product works fine, but to prove that it <em>doesn’t work</em> as intended. The goal of any tester is to show how the product can be broken, how it fails on different inputs, how it crashes under stress, how it misunderstands the user, how it doesn’t satisfy the requirements. This is why Dr. Myers is calling testing “a destructive, even sadistic, process” (page 6). This is what most testers don’t understand.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=wd-SA1HVmLg"><div class="box"> <img src="https://i.ytimg.com/vi/wd-SA1HVmLg/mqdefault.jpg" alt="YouTube video #wd-SA1HVmLg" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>How Do You Know When Your Product is Ready to be Shipped?; 18 November 2016.</div></aside><p>Second, any software <a href="/2017/05/23/unlimited-number-of-bugs.html">has</a> an <em>unlimited amount of bugs</em>. Dr. Myers says that “you cannot test a program to guarantee that it is error free” (page 10) and that “it is impractical, often impossible, to find all the errors in a program” (page 8). This is also what most testers don’t understand. They believe that there is a <a href="/2015/06/18/good-programmers-bug-free.html">limited number</a> of bugs, which they have to find and call it a day. There literally <a href="/2017/05/23/unlimited-number-of-bugs.html">no limit</a>! The amount of bugs is unlimited, in any software product. No matter how small or big, complex or simple, new or old is the product.</p><aside class="quote">They can't find all bugs, no matter how much time we give them</aside><p>Having these axioms in mind, let’s try to decide when testers have to stop. According to Dr. Myers, “one of the most difficult questions to answer when testing a program is determining when to stop, since there is no way of knowing if the error just detected is the last remaining error” (page 135).</p><p>They can’t find all bugs, no matter how much time we give them. And they are motivated to find more and more of them. But at some point of time we must make a decision and release the product. Looks like we will release it with bugs inside? Yes, indeed! We will release a product <em>full of bugs</em>. The only question is how many of them were found already and how critical they were.</p><p>Let’s put it all together. There are too many bugs to be able to find all of them in a reasonable amount of time. However, we have to release a new version, sooner or later. At the same time, testers will always tell us that there are more bugs there and they can find more, just need more time. What to do?</p><p>Dr. Myers says that “since the goal of testing is to find errors, why not make the completion criterion the detection of some predefined number of errors?” (page 136). Indeed, we should predict how many bugs are just enough to find, in order to have a desirable level of <em>confidence</em> that the product is ready to be shipped. Then, ship it, consciously understanding that it still has an unlimited amount of not yet discovered bugs.</p><figure class="badge"><a href="http://amzn.to/266oJr4"><img src="https://www.yegor256.com/images/2015/04/book-object-thinking.jpg" style="width:96px;max-width:100%;" alt="badge" /></a></figure><p>David West in <a href="http://amzn.to/266oJr4">Object Thinking</a> says that “software is released for use, not when it is known to be correct, but when the rate of discovering errors slows down to one that management considers acceptable” (page 13).</p><p>Thus, the only valid criteria for exiting a testing process is the discovery of a <em>forecast</em> amount of bugs.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html&amp;text=When+Do+You+Stop+Testing%3F" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html%3F2015-36&amp;title=When+Do+You+Stop+Testing%3F" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2015/09/10/testing-exit-criteria.html%3F2015-36&amp;t=When+Do+You+Stop+Testing%3F" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>There is a software to be tested. There is a team of testers. There is some money in the budget. There is some time in the schedule. We start right now. Testers are trying to break the product, finding bugs, reporting bugs, communicating with programmers when necessary, doing their best to find what’s wrong. Eventually they stop and say “we’re done.” How do they know when to stop? When there is enough testing? It’s obvious—when there are <em>no more bugs left</em> and the product can be shipped! If you think like this, I have bad news for you. You’re <em>fundamentally wrong</em>.</p><figure class="jb_picture"><img itemprop="image" alt="La fille sur le pont (1999) by Patrice Leconte" src="/images/2015/09/la-fille-sur-le-pont.jpg" longdesc="#3e0b5dd3" /><figcaption id="3e0b5dd3">La fille sur le pont (1999) by Patrice Leconte</figcaption></figure><p>All this is perfectly explained by Glenford Myers in his <a href="http://amzn.to/1Y3qAbN">great book</a> <a href="/2014/08/22/art-of-software-testing.html">The Art of Software Testing</a>. I will just summarize it here again.</p><figure class="badge"><a href="http://amzn.to/1Y3qAbN"><img src="https://www.yegor256.com/images/2015/04/book-art-of-testing.jpg" style="width:96px;max-width:100%;" alt="badge" /></a></figure><p>First, “testing is the process of executing a program with the intent of <em>finding errors</em>” (page 6). Pay attention, the intent is to find errors. Not to prove that the product works fine, but to prove that it <em>doesn’t work</em> as intended. The goal of any tester is to show how the product can be broken, how it fails on different inputs, how it crashes under stress, how it misunderstands the user, how it doesn’t satisfy the requirements. This is why Dr. Myers is calling testing “a destructive, even sadistic, process” (page 6). This is what most testers don’t understand.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=wd-SA1HVmLg"><div class="box"> <img src="https://i.ytimg.com/vi/wd-SA1HVmLg/mqdefault.jpg" alt="YouTube video #wd-SA1HVmLg" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>How Do You Know When Your Product is Ready to be Shipped?; 18 November 2016.</div></aside><p>Second, any software <a href="/2017/05/23/unlimited-number-of-bugs.html">has</a> an <em>unlimited amount of bugs</em>. Dr. Myers says that “you cannot test a program to guarantee that it is error free” (page 10) and that “it is impractical, often impossible, to find all the errors in a program” (page 8). This is also what most testers don’t understand. They believe that there is a <a href="/2015/06/18/good-programmers-bug-free.html">limited number</a> of bugs, which they have to find and call it a day. There literally <a href="/2017/05/23/unlimited-number-of-bugs.html">no limit</a>! The amount of bugs is unlimited, in any software product. No matter how small or big, complex or simple, new or old is the product.</p><aside class="quote">They can't find all bugs, no matter how much time we give them</aside><p>Having these axioms in mind, let’s try to decide when testers have to stop. According to Dr. Myers, “one of the most difficult questions to answer when testing a program is determining when to stop, since there is no way of knowing if the error just detected is the last remaining error” (page 135).</p><p>They can’t find all bugs, no matter how much time we give them. And they are motivated to find more and more of them. But at some point of time we must make a decision and release the product. Looks like we will release it with bugs inside? Yes, indeed! We will release a product <em>full of bugs</em>. The only question is how many of them were found already and how critical they were.</p><p>Let’s put it all together. There are too many bugs to be able to find all of them in a reasonable amount of time. However, we have to release a new version, sooner or later. At the same time, testers will always tell us that there are more bugs there and they can find more, just need more time. What to do?</p><p>Dr. Myers says that “since the goal of testing is to find errors, why not make the completion criterion the detection of some predefined number of errors?” (page 136). Indeed, we should predict how many bugs are just enough to find, in order to have a desirable level of <em>confidence</em> that the product is ready to be shipped. Then, ship it, consciously understanding that it still has an unlimited amount of not yet discovered bugs.</p><figure class="badge"><a href="http://amzn.to/266oJr4"><img src="https://www.yegor256.com/images/2015/04/book-object-thinking.jpg" style="width:96px;max-width:100%;" alt="badge" /></a></figure><p>David West in <a href="http://amzn.to/266oJr4">Object Thinking</a> says that “software is released for use, not when it is known to be correct, but when the rate of discovering errors slows down to one that management considers acceptable” (page 13).</p><p>Thus, the only valid criteria for exiting a testing process is the discovery of a <em>forecast</em> amount of bugs.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2015-06-11 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Wikipedia's Definition of a Software Bug Is Wrong"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;Here is what &lt;a href=&quot;https://en.wikipedia.org/wiki/Software_bug&quot;&gt;Wikipedia says&lt;/a&gt; at the time of this writing:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;A software bug is an error, flaw, failure, or fault in a computer program or system that causes it to produce an incorrect or unexpected result or to behave in unintended ways.&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;I think that’s incomplete. The definition entirely excludes “non-behavioral” defects related to, for example, &lt;em&gt;maintainability&lt;/em&gt; and &lt;em&gt;reusability&lt;/em&gt;.&lt;/p&gt; &lt;!--more--&gt; &lt;p&gt;As you know, every piece of software has &lt;a href=&quot;https://en.wikipedia.org/wiki/Functional_requirement&quot;&gt;functional&lt;/a&gt; and &lt;a href=&quot;https://en.wikipedia.org/wiki/Non-functional_requirement&quot;&gt;non-functional&lt;/a&gt; requirements. Functional requirements tell us &lt;em&gt;what&lt;/em&gt; the software has to do, and non-functional requirements document &lt;em&gt;how&lt;/em&gt; it has to do it. For example, here is a functional requirement:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&lt;span&gt;&lt;/span&gt;The user can generate a PDF report.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;If our software doesn’t generate a PDF report and crashes instead, that’s a functional bug. If instead of a PDF report, it generates an empty page or a plain text document, that’s a functional bug. If there is no “generate PDF report” button at all and the user simply can’t start the PDF generation process, that’s a functional bug.&lt;/p&gt; &lt;p&gt;Here is an example of a non-functional requirement:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&lt;span&gt;&lt;/span&gt;PDF report generation must take less than 100ms.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;If our software generates a perfectly correct PDF report but it takes a minute, that’s a non-functional bug.&lt;/p&gt; &lt;p&gt;So far so good, since the bug definition given by Wikipedia perfectly covers both of them—if they happen, they will cause our software “to &lt;em&gt;produce&lt;/em&gt; an incorrect or unexpected result or to &lt;em&gt;behave&lt;/em&gt; in an unintended way.” The emphasis here is on the words “produce” and “behave.” They presume the software is doing something and we’re observing its behavior.&lt;/p&gt; &lt;p&gt;However, that’s not all of it.&lt;/p&gt; &lt;p&gt;What about maintainability? I may have this kind of non-functional requirement:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;&lt;span&gt;&lt;/span&gt;The source code of the PDF generator must be easy to maintain and extend for an average Java programmer.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;It’s a rather vague requirement, but you get the idea.&lt;/p&gt; &lt;p&gt;Maintainability and reusability are very critical non-functional components of any modern software program, especially taking into account a very high cost of labor in the market. Very often, it’s more important to make sure the software is maintainable than fast. If it’s maintainable and slow, we can find new programmers to &lt;em&gt;improve&lt;/em&gt; the code. If it is fast but unmaintainable, we won’t be able to do anything with it later and will have to &lt;em&gt;rewrite&lt;/em&gt; it from scratch if some new feature is required. Read more about this in &lt;a href=&quot;/2014/10/26/hacker-vs-programmer-mentality.html&quot;&gt;Are You a Hacker or a Designer?&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;The definition of a software bug given by Wikipedia doesn’t cover maintainability and reusability flaws at all. That makes for a common source of confusion—an inconsistent code style is not a bug (see the discussion under &lt;a href=&quot;/2014/08/13/strict-code-quality-control.html&quot;&gt;this post&lt;/a&gt;).&lt;/p&gt; &lt;p&gt;That is wrong.&lt;/p&gt; &lt;p&gt;An inconsistent code style &lt;em&gt;is&lt;/em&gt; a software bug, as is incomplete documentation, lack of documentation, code that’s too complex, the lack of a coding style guide, etc.&lt;/p&gt; &lt;p&gt;I would rewrite the software bug definition paragraph in Wikipedia like this:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;A software bug is an error, flaw, failure, or fault in a computer program or system that causes it to violate at least one of its functional or non-functional requirements.&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;This definition looks more accurate to me.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html" /> <link rel="amphtml" href="https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.amp.html" /> <title>Wikipedia's Definition of a Software Bug Is Wrong </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2015/06/11/wikipedia-bug-definition.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2015/06/11/wikipedia-bug-definition.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html</code></p><h1 itemprop="name headline mainEntityOfPage">Wikipedia's Definition of a Software Bug Is Wrong</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2015-06-11T00:00:00+00:00"> 11 June 2015 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>Here is what <a href="https://en.wikipedia.org/wiki/Software_bug">Wikipedia says</a> at the time of this writing:</p><blockquote><p>A software bug is an error, flaw, failure, or fault in a computer program or system that causes it to produce an incorrect or unexpected result or to behave in unintended ways.</p></blockquote><p>I think that’s incomplete. The definition entirely excludes “non-behavioral” defects related to, for example, <em>maintainability</em> and <em>reusability</em>.</p><p>As you know, every piece of software has <a href="https://en.wikipedia.org/wiki/Functional_requirement">functional</a> and <a href="https://en.wikipedia.org/wiki/Non-functional_requirement">non-functional</a> requirements. Functional requirements tell us <em>what</em> the software has to do, and non-functional requirements document <em>how</em> it has to do it. For example, here is a functional requirement:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>The user can generate a PDF report.</code></pre></figure><p>If our software doesn’t generate a PDF report and crashes instead, that’s a functional bug. If instead of a PDF report, it generates an empty page or a plain text document, that’s a functional bug. If there is no “generate PDF report” button at all and the user simply can’t start the PDF generation process, that’s a functional bug.</p><p>Here is an example of a non-functional requirement:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>PDF report generation must take less than 100ms.</code></pre></figure><p>If our software generates a perfectly correct PDF report but it takes a minute, that’s a non-functional bug.</p><p>So far so good, since the bug definition given by Wikipedia perfectly covers both of them—if they happen, they will cause our software “to <em>produce</em> an incorrect or unexpected result or to <em>behave</em> in an unintended way.” The emphasis here is on the words “produce” and “behave.” They presume the software is doing something and we’re observing its behavior.</p><p>However, that’s not all of it.</p><p>What about maintainability? I may have this kind of non-functional requirement:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>The source code of the PDF generator must be
easy to maintain and extend for an average
Java programmer.</code></pre></figure><p>It’s a rather vague requirement, but you get the idea.</p><p>Maintainability and reusability are very critical non-functional components of any modern software program, especially taking into account a very high cost of labor in the market. Very often, it’s more important to make sure the software is maintainable than fast. If it’s maintainable and slow, we can find new programmers to <em>improve</em> the code. If it is fast but unmaintainable, we won’t be able to do anything with it later and will have to <em>rewrite</em> it from scratch if some new feature is required. Read more about this in <a href="/2014/10/26/hacker-vs-programmer-mentality.html">Are You a Hacker or a Designer?</a>.</p><p>The definition of a software bug given by Wikipedia doesn’t cover maintainability and reusability flaws at all. That makes for a common source of confusion—an inconsistent code style is not a bug (see the discussion under <a href="/2014/08/13/strict-code-quality-control.html">this post</a>).</p><p>That is wrong.</p><p>An inconsistent code style <em>is</em> a software bug, as is incomplete documentation, lack of documentation, code that’s too complex, the lack of a coding style guide, etc.</p><p>I would rewrite the software bug definition paragraph in Wikipedia like this:</p><blockquote><p>A software bug is an error, flaw, failure, or fault in a computer program or system that causes it to violate at least one of its functional or non-functional requirements.</p></blockquote><p>This definition looks more accurate to me.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html&amp;text=Wikipedia%27s+Definition+of+a+Software+Bug+Is+Wrong" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html%3F2015-23&amp;title=Wikipedia%27s+Definition+of+a+Software+Bug+Is+Wrong" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2015/06/11/wikipedia-bug-definition.html%3F2015-23&amp;t=Wikipedia%27s+Definition+of+a+Software+Bug+Is+Wrong" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>Here is what <a href="https://en.wikipedia.org/wiki/Software_bug">Wikipedia says</a> at the time of this writing:</p><blockquote><p>A software bug is an error, flaw, failure, or fault in a computer program or system that causes it to produce an incorrect or unexpected result or to behave in unintended ways.</p></blockquote><p>I think that’s incomplete. The definition entirely excludes “non-behavioral” defects related to, for example, <em>maintainability</em> and <em>reusability</em>.</p><p>As you know, every piece of software has <a href="https://en.wikipedia.org/wiki/Functional_requirement">functional</a> and <a href="https://en.wikipedia.org/wiki/Non-functional_requirement">non-functional</a> requirements. Functional requirements tell us <em>what</em> the software has to do, and non-functional requirements document <em>how</em> it has to do it. For example, here is a functional requirement:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>The user can generate a PDF report.</code></pre></figure><p>If our software doesn’t generate a PDF report and crashes instead, that’s a functional bug. If instead of a PDF report, it generates an empty page or a plain text document, that’s a functional bug. If there is no “generate PDF report” button at all and the user simply can’t start the PDF generation process, that’s a functional bug.</p><p>Here is an example of a non-functional requirement:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>PDF report generation must take less than 100ms.</code></pre></figure><p>If our software generates a perfectly correct PDF report but it takes a minute, that’s a non-functional bug.</p><p>So far so good, since the bug definition given by Wikipedia perfectly covers both of them—if they happen, they will cause our software “to <em>produce</em> an incorrect or unexpected result or to <em>behave</em> in an unintended way.” The emphasis here is on the words “produce” and “behave.” They presume the software is doing something and we’re observing its behavior.</p><p>However, that’s not all of it.</p><p>What about maintainability? I may have this kind of non-functional requirement:</p><figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>The source code of the PDF generator must be
easy to maintain and extend for an average
Java programmer.</code></pre></figure><p>It’s a rather vague requirement, but you get the idea.</p><p>Maintainability and reusability are very critical non-functional components of any modern software program, especially taking into account a very high cost of labor in the market. Very often, it’s more important to make sure the software is maintainable than fast. If it’s maintainable and slow, we can find new programmers to <em>improve</em> the code. If it is fast but unmaintainable, we won’t be able to do anything with it later and will have to <em>rewrite</em> it from scratch if some new feature is required. Read more about this in <a href="/2014/10/26/hacker-vs-programmer-mentality.html">Are You a Hacker or a Designer?</a>.</p><p>The definition of a software bug given by Wikipedia doesn’t cover maintainability and reusability flaws at all. That makes for a common source of confusion—an inconsistent code style is not a bug (see the discussion under <a href="/2014/08/13/strict-code-quality-control.html">this post</a>).</p><p>That is wrong.</p><p>An inconsistent code style <em>is</em> a software bug, as is incomplete documentation, lack of documentation, code that’s too complex, the lack of a coding style guide, etc.</p><p>I would rewrite the software bug definition paragraph in Wikipedia like this:</p><blockquote><p>A software bug is an error, flaw, failure, or fault in a computer program or system that causes it to violate at least one of its functional or non-functional requirements.</p></blockquote><p>This definition looks more accurate to me.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-08-22 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="The Art of Software Testing by Glenford Myers"/> <meta name="twitter:description" property="og:description" content="&lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://amzn.to/1Y3qAbN&quot;&gt;&lt;img src=&quot;https://www.yegor256.com/images/2014/08/art-of-software-testing.png&quot; style=&quot;width:96px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;“&lt;a href=&quot;http://amzn.to/1Y3qAbN&quot;&gt;The Art of Software Testing”&lt;/a&gt;” by Glenford J. Myers, Tom Badgett and Corey Sandler is one of my favorite books concerning testing and software engineering in general. In this article, I will provide an overview of the book, as well as highlight the ideas and quotes that I found to be the most interesting.&lt;/p&gt; &lt;!--more--&gt; &lt;p&gt;There were three editions of the book. The first one was published in 1979, when I was just too young to appreciate it. The second one was published in 2004—I read it first in 2007. The third one was published just two years ago, in 2012. I bought this edition also, and read it like it was my first time. This book is still one of the top books in the software testing domain, despite its age and some content that is rather out-dated.&lt;/p&gt; &lt;h2 id=&quot;out-dated-content&quot;&gt;Out-dated Content&lt;/h2&gt; &lt;p&gt;First, let’s filter out what is not worth reading (in my opinion).&lt;/p&gt; &lt;p&gt;There are eleven chapters, but you can easily skim through nine of them. This is because those chapter discuss concepts that are discussed elsewhere in the book with a more robust level of detail or on a much higher level of abstraction.&lt;/p&gt; &lt;p&gt;For example, Chapter 3 contains an eleven-page checklist to be used by a code reviewer in order to find programming mistakes. This list is definitely not comprehensive and it can’t compete with, say, “&lt;a href=&quot;http://amzn.to/2bNjO8C&quot;&gt;Code Complete&lt;/a&gt;” by Steve McConnell. I believe, this checklist had significant value twenty years ago, but now it is out of date.&lt;/p&gt; &lt;p&gt;Chapter 5 discusses basic principles and strategies of unit testing. However, the discussion is not abstract enough for a short 25-page summary, and is not specific enough for a detailed discussion. Again, twenty years ago this information may have had some value. Nowadays, “&lt;a href=&quot;http://amzn.to/1PBpoDT&quot;&gt;Growing Object-Oriented Software, Guided by Tests&lt;/a&gt;” by Steven Freeman and Nat Pryce is a much better source for this subject.&lt;/p&gt; &lt;p&gt;There are also articles about usability testing, &lt;a href=&quot;/2016/02/09/are-you-still-debugging.html&quot;&gt;debugging&lt;/a&gt;, web application testing, and mobile testing. Here we have the same issue—they are not abstract enough and they are much too outdated to be relevant to the current issues in software testing. I would recommend readers to briefly skim those subjects for background information, but to not read too much into it.&lt;/p&gt; &lt;h2 id=&quot;psychology-of-testing&quot;&gt;Psychology of Testing&lt;/h2&gt; &lt;p&gt;The most important and valuable part of the book is Chapter 2. It is full of priceless quotes that can also be very practical. For example, on page 6:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;Testing is a destructive, even sadistic, process, which explains why most people find it difficult&lt;/p&gt; &lt;/blockquote&gt; &lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://amzn.to/1Y3qAbN&quot;&gt;&lt;img src=&quot;https://www.yegor256.com/images/2014/08/glenford-myers.png&quot; style=&quot;width:200px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;In Chapter 2, Dr. Myers discusses the psychology of testing and a very common and crucial misunderstanding of testing objectives. He claims that it is commonly accepted that the goal of software testing is “to show that a program performs its intended functions correctly” (p.5). Testers are hired to check whether the software functions as expected. They then report back to management whether all tests have successfully passed and whether the program can be delivered to end users.&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;Despite the plethora of software testing tomes available on the market today, many developers seem to have an attitude that is counter to extensive testing&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;This is what Dr. Myers says on the second page, and I can humbly confirm that in all software groups I’ve been worked in thus far, almost everyone, including testers, &lt;a href=&quot;/2016/02/18/holacracy-autocracy.html&quot;&gt;project managers&lt;/a&gt;, and programmers, share this philosophy. They all believe that “testing is the process of demonstrating that errors are not present” (p.5)&lt;/p&gt; &lt;p&gt;However, “these definitions are upside down” (p.6). The psychology of testing should be viewed as the opposite. There are two quotes that support this theory and I feel that they make the entire book.&lt;/p&gt; &lt;p&gt;The first one, on page 6, defines the goal of software testing:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;Testing is the process of executing a program with the intent of finding errors&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;The second one, on the following page, further refines the first goal:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;An unsuccessful test case is one that causes a program to produce the correct results without finding any errors&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;Dr. Myers comes back to these two thoughts in every chapter. He reiterates over and over again that we should change the underlying psychology of how we view testing, in order to change our testing results. We should focus on breaking the software instead of confirming that it works. Because testing is a “sadistic process” (p.6) of breaking things. It is a “destructive process” (p.8).&lt;/p&gt; &lt;p&gt;If you read Chapter2 very carefully and truly understand its underlying ideas, it may change your entire life :) This chapter should be a New Testament of every tester.&lt;/p&gt; &lt;h2 id=&quot;test-completion-criteria&quot;&gt;Test Completion Criteria&lt;/h2&gt; &lt;p&gt;In Chapter 2, Dr. Myers also mentions that a program, no matter how simple, contains an &lt;a href=&quot;/2017/05/23/unlimited-number-of-bugs.html&quot;&gt;unlimited&lt;/a&gt; number of errors. He says that “you cannot test a program to guarantee that it is error free” (p.10) and that “it is impractical, often impossible, to find all the errors in a program” (p.8).&lt;/p&gt; &lt;p&gt;Furthermore, at the end of Chapter 6, he makes an important observation (p.135):&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;One of the most difficult questions to answer when testing a program is determining when to stop, since there is no way of knowing if the error just detected is the last remaining error&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;The problem is &lt;a href=&quot;/2015/09/10/testing-exit-criteria.html&quot;&gt;obvious&lt;/a&gt;. Since any program contains an unlimited number of errors, it doesn’t matter how long we test, we won’t find all of them. So when do we stop? What goals do we set for our testers? And even more importantly, when do we pay them and how much (this question is important to me since I only work with contractors and am required to define measurable and achievable goals)?&lt;/p&gt; &lt;p&gt;The answer Dr. Myers gives is brilliant (p.136):&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;Since the goal of testing is to find errors, why not make the completion criterion the detection of some predefined number of errors?&lt;/p&gt; &lt;/blockquote&gt; &lt;p&gt;He then goes on to discuss exactly how this “predefined number” can be estimated. I find this idea very interesting. I have even applied it to a few projects I’ve had in the last few years. It works. However it can also cause serious psychological problems for the team. Most people simply resent the goal of “testing until you find a required number of bugs.” The most common response is “what if there are no bugs any more?.”&lt;/p&gt; &lt;p&gt;However, after a few fights, the team eventually begins to appreciate the concept and get used to it. So, I can humbly confirm that Dr. Myers is right in his suggestion. You can successful plan testing based on a predefined number of errors.&lt;/p&gt; &lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt; &lt;p&gt;I consider this book a fundamental writing in the area of software testing. This is mostly due to Chapter 2 of the book. In fact, there are just three pages of text that build the foundation of the entire book. They are the skeleton of the other two hundred pages.&lt;/p&gt; &lt;p&gt;Unfortunately, since 1979, this skeleton hasn’t become the backbone of the software testing industry. Most of us are still working against these principles.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/08/22/art-of-software-testing.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2014/08/22/art-of-software-testing.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/08/22/art-of-software-testing.amp.html" /> <title>The Art of Software Testing by Glenford Myers </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2014/08/22/art-of-software-testing.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2014/08/22/art-of-software-testing.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/08/22/art-of-software-testing.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/08/22/art-of-software-testing.html</code></p><h1 itemprop="name headline mainEntityOfPage">The Art of Software Testing by Glenford Myers</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-08-22T00:00:00+00:00"> 22 August 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/08/22/art-of-software-testing.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><figure class="badge"><a href="http://amzn.to/1Y3qAbN"><img src="https://www.yegor256.com/images/2014/08/art-of-software-testing.png" style="width:96px;max-width:100%;" alt="badge" /></a></figure><p>“<a href="http://amzn.to/1Y3qAbN">The Art of Software Testing”</a>” by Glenford J. Myers, Tom Badgett and Corey Sandler is one of my favorite books concerning testing and software engineering in general. In this article, I will provide an overview of the book, as well as highlight the ideas and quotes that I found to be the most interesting.</p><p>There were three editions of the book. The first one was published in 1979, when I was just too young to appreciate it. The second one was published in 2004—I read it first in 2007. The third one was published just two years ago, in 2012. I bought this edition also, and read it like it was my first time. This book is still one of the top books in the software testing domain, despite its age and some content that is rather out-dated.</p><h2 id="out-dated-content">Out-dated Content</h2><p>First, let’s filter out what is not worth reading (in my opinion).</p><p>There are eleven chapters, but you can easily skim through nine of them. This is because those chapter discuss concepts that are discussed elsewhere in the book with a more robust level of detail or on a much higher level of abstraction.</p><p>For example, Chapter 3 contains an eleven-page checklist to be used by a code reviewer in order to find programming mistakes. This list is definitely not comprehensive and it can’t compete with, say, “<a href="http://amzn.to/2bNjO8C">Code Complete</a>” by Steve McConnell. I believe, this checklist had significant value twenty years ago, but now it is out of date.</p><p>Chapter 5 discusses basic principles and strategies of unit testing. However, the discussion is not abstract enough for a short 25-page summary, and is not specific enough for a detailed discussion. Again, twenty years ago this information may have had some value. Nowadays, “<a href="http://amzn.to/1PBpoDT">Growing Object-Oriented Software, Guided by Tests</a>” by Steven Freeman and Nat Pryce is a much better source for this subject.</p><p>There are also articles about usability testing, <a href="/2016/02/09/are-you-still-debugging.html">debugging</a>, web application testing, and mobile testing. Here we have the same issue—they are not abstract enough and they are much too outdated to be relevant to the current issues in software testing. I would recommend readers to briefly skim those subjects for background information, but to not read too much into it.</p><h2 id="psychology-of-testing">Psychology of Testing</h2><p>The most important and valuable part of the book is Chapter 2. It is full of priceless quotes that can also be very practical. For example, on page 6:</p><blockquote><p>Testing is a destructive, even sadistic, process, which explains why most people find it difficult</p></blockquote> <figure class="badge"><a href="http://amzn.to/1Y3qAbN"><img src="https://www.yegor256.com/images/2014/08/glenford-myers.png" style="width:200px;max-width:100%;" alt="badge" /></a></figure><p>In Chapter 2, Dr. Myers discusses the psychology of testing and a very common and crucial misunderstanding of testing objectives. He claims that it is commonly accepted that the goal of software testing is “to show that a program performs its intended functions correctly” (p.5). Testers are hired to check whether the software functions as expected. They then report back to management whether all tests have successfully passed and whether the program can be delivered to end users.</p><blockquote><p>Despite the plethora of software testing tomes available on the market today, many developers seem to have an attitude that is counter to extensive testing</p></blockquote><p>This is what Dr. Myers says on the second page, and I can humbly confirm that in all software groups I’ve been worked in thus far, almost everyone, including testers, <a href="/2016/02/18/holacracy-autocracy.html">project managers</a>, and programmers, share this philosophy. They all believe that “testing is the process of demonstrating that errors are not present” (p.5)</p><p>However, “these definitions are upside down” (p.6). The psychology of testing should be viewed as the opposite. There are two quotes that support this theory and I feel that they make the entire book.</p><p>The first one, on page 6, defines the goal of software testing:</p><blockquote><p>Testing is the process of executing a program with the intent of finding errors</p></blockquote><p>The second one, on the following page, further refines the first goal:</p><blockquote><p>An unsuccessful test case is one that causes a program to produce the correct results without finding any errors</p></blockquote><p>Dr. Myers comes back to these two thoughts in every chapter. He reiterates over and over again that we should change the underlying psychology of how we view testing, in order to change our testing results. We should focus on breaking the software instead of confirming that it works. Because testing is a “sadistic process” (p.6) of breaking things. It is a “destructive process” (p.8).</p><p>If you read Chapter2 very carefully and truly understand its underlying ideas, it may change your entire life :) This chapter should be a New Testament of every tester.</p><h2 id="test-completion-criteria">Test Completion Criteria</h2><p>In Chapter 2, Dr. Myers also mentions that a program, no matter how simple, contains an <a href="/2017/05/23/unlimited-number-of-bugs.html">unlimited</a> number of errors. He says that “you cannot test a program to guarantee that it is error free” (p.10) and that “it is impractical, often impossible, to find all the errors in a program” (p.8).</p><p>Furthermore, at the end of Chapter 6, he makes an important observation (p.135):</p><blockquote><p>One of the most difficult questions to answer when testing a program is determining when to stop, since there is no way of knowing if the error just detected is the last remaining error</p></blockquote><p>The problem is <a href="/2015/09/10/testing-exit-criteria.html">obvious</a>. Since any program contains an unlimited number of errors, it doesn’t matter how long we test, we won’t find all of them. So when do we stop? What goals do we set for our testers? And even more importantly, when do we pay them and how much (this question is important to me since I only work with contractors and am required to define measurable and achievable goals)?</p><p>The answer Dr. Myers gives is brilliant (p.136):</p><blockquote><p>Since the goal of testing is to find errors, why not make the completion criterion the detection of some predefined number of errors?</p></blockquote><p>He then goes on to discuss exactly how this “predefined number” can be estimated. I find this idea very interesting. I have even applied it to a few projects I’ve had in the last few years. It works. However it can also cause serious psychological problems for the team. Most people simply resent the goal of “testing until you find a required number of bugs.” The most common response is “what if there are no bugs any more?.”</p><p>However, after a few fights, the team eventually begins to appreciate the concept and get used to it. So, I can humbly confirm that Dr. Myers is right in his suggestion. You can successful plan testing based on a predefined number of errors.</p><h2 id="summary">Summary</h2><p>I consider this book a fundamental writing in the area of software testing. This is mostly due to Chapter 2 of the book. In fact, there are just three pages of text that build the foundation of the entire book. They are the skeleton of the other two hundred pages.</p><p>Unfortunately, since 1979, this skeleton hasn’t become the backbone of the software testing industry. Most of us are still working against these principles.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/08/22/art-of-software-testing.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/08/22/art-of-software-testing.html&amp;text=The+Art+of+Software+Testing+by+Glenford+Myers" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/08/22/art-of-software-testing.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/08/22/art-of-software-testing.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/08/22/art-of-software-testing.html%3F2014-33&amp;title=The+Art+of+Software+Testing+by+Glenford+Myers" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/08/22/art-of-software-testing.html%3F2014-33&amp;t=The+Art+of+Software+Testing+by+Glenford+Myers" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class="badge"><a href="http://amzn.to/1Y3qAbN"><img src="https://www.yegor256.com/images/2014/08/art-of-software-testing.png" style="width:96px;max-width:100%;" alt="badge" /></a></figure><p>“<a href="http://amzn.to/1Y3qAbN">The Art of Software Testing”</a>” by Glenford J. Myers, Tom Badgett and Corey Sandler is one of my favorite books concerning testing and software engineering in general. In this article, I will provide an overview of the book, as well as highlight the ideas and quotes that I found to be the most interesting.</p><p>There were three editions of the book. The first one was published in 1979, when I was just too young to appreciate it. The second one was published in 2004—I read it first in 2007. The third one was published just two years ago, in 2012. I bought this edition also, and read it like it was my first time. This book is still one of the top books in the software testing domain, despite its age and some content that is rather out-dated.</p><h2 id="out-dated-content">Out-dated Content</h2><p>First, let’s filter out what is not worth reading (in my opinion).</p><p>There are eleven chapters, but you can easily skim through nine of them. This is because those chapter discuss concepts that are discussed elsewhere in the book with a more robust level of detail or on a much higher level of abstraction.</p><p>For example, Chapter 3 contains an eleven-page checklist to be used by a code reviewer in order to find programming mistakes. This list is definitely not comprehensive and it can’t compete with, say, “<a href="http://amzn.to/2bNjO8C">Code Complete</a>” by Steve McConnell. I believe, this checklist had significant value twenty years ago, but now it is out of date.</p><p>Chapter 5 discusses basic principles and strategies of unit testing. However, the discussion is not abstract enough for a short 25-page summary, and is not specific enough for a detailed discussion. Again, twenty years ago this information may have had some value. Nowadays, “<a href="http://amzn.to/1PBpoDT">Growing Object-Oriented Software, Guided by Tests</a>” by Steven Freeman and Nat Pryce is a much better source for this subject.</p><p>There are also articles about usability testing, <a href="/2016/02/09/are-you-still-debugging.html">debugging</a>, web application testing, and mobile testing. Here we have the same issue—they are not abstract enough and they are much too outdated to be relevant to the current issues in software testing. I would recommend readers to briefly skim those subjects for background information, but to not read too much into it.</p><h2 id="psychology-of-testing">Psychology of Testing</h2><p>The most important and valuable part of the book is Chapter 2. It is full of priceless quotes that can also be very practical. For example, on page 6:</p><blockquote><p>Testing is a destructive, even sadistic, process, which explains why most people find it difficult</p></blockquote> <figure class="badge"><a href="http://amzn.to/1Y3qAbN"><img src="https://www.yegor256.com/images/2014/08/glenford-myers.png" style="width:200px;max-width:100%;" alt="badge" /></a></figure><p>In Chapter 2, Dr. Myers discusses the psychology of testing and a very common and crucial misunderstanding of testing objectives. He claims that it is commonly accepted that the goal of software testing is “to show that a program performs its intended functions correctly” (p.5). Testers are hired to check whether the software functions as expected. They then report back to management whether all tests have successfully passed and whether the program can be delivered to end users.</p><blockquote><p>Despite the plethora of software testing tomes available on the market today, many developers seem to have an attitude that is counter to extensive testing</p></blockquote><p>This is what Dr. Myers says on the second page, and I can humbly confirm that in all software groups I’ve been worked in thus far, almost everyone, including testers, <a href="/2016/02/18/holacracy-autocracy.html">project managers</a>, and programmers, share this philosophy. They all believe that “testing is the process of demonstrating that errors are not present” (p.5)</p><p>However, “these definitions are upside down” (p.6). The psychology of testing should be viewed as the opposite. There are two quotes that support this theory and I feel that they make the entire book.</p><p>The first one, on page 6, defines the goal of software testing:</p><blockquote><p>Testing is the process of executing a program with the intent of finding errors</p></blockquote><p>The second one, on the following page, further refines the first goal:</p><blockquote><p>An unsuccessful test case is one that causes a program to produce the correct results without finding any errors</p></blockquote><p>Dr. Myers comes back to these two thoughts in every chapter. He reiterates over and over again that we should change the underlying psychology of how we view testing, in order to change our testing results. We should focus on breaking the software instead of confirming that it works. Because testing is a “sadistic process” (p.6) of breaking things. It is a “destructive process” (p.8).</p><p>If you read Chapter2 very carefully and truly understand its underlying ideas, it may change your entire life :) This chapter should be a New Testament of every tester.</p><h2 id="test-completion-criteria">Test Completion Criteria</h2><p>In Chapter 2, Dr. Myers also mentions that a program, no matter how simple, contains an <a href="/2017/05/23/unlimited-number-of-bugs.html">unlimited</a> number of errors. He says that “you cannot test a program to guarantee that it is error free” (p.10) and that “it is impractical, often impossible, to find all the errors in a program” (p.8).</p><p>Furthermore, at the end of Chapter 6, he makes an important observation (p.135):</p><blockquote><p>One of the most difficult questions to answer when testing a program is determining when to stop, since there is no way of knowing if the error just detected is the last remaining error</p></blockquote><p>The problem is <a href="/2015/09/10/testing-exit-criteria.html">obvious</a>. Since any program contains an unlimited number of errors, it doesn’t matter how long we test, we won’t find all of them. So when do we stop? What goals do we set for our testers? And even more importantly, when do we pay them and how much (this question is important to me since I only work with contractors and am required to define measurable and achievable goals)?</p><p>The answer Dr. Myers gives is brilliant (p.136):</p><blockquote><p>Since the goal of testing is to find errors, why not make the completion criterion the detection of some predefined number of errors?</p></blockquote><p>He then goes on to discuss exactly how this “predefined number” can be estimated. I find this idea very interesting. I have even applied it to a few projects I’ve had in the last few years. It works. However it can also cause serious psychological problems for the team. Most people simply resent the goal of “testing until you find a required number of bugs.” The most common response is “what if there are no bugs any more?.”</p><p>However, after a few fights, the team eventually begins to appreciate the concept and get used to it. So, I can humbly confirm that Dr. Myers is right in his suggestion. You can successful plan testing based on a predefined number of errors.</p><h2 id="summary">Summary</h2><p>I consider this book a fundamental writing in the area of software testing. This is mostly due to Chapter 2 of the book. In fact, there are just three pages of text that build the foundation of the entire book. They are the skeleton of the other two hundred pages.</p><p>Unfortunately, since 1979, this skeleton hasn’t become the backbone of the software testing industry. Most of us are still working against these principles.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-06-21 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="CasperJS Tests in Maven Build"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;I’m a big fan of automated testing in general and integration testing in particular. I strongly believe that effort spent on writing tests are direct investments into &lt;a href=&quot;/2017/12/26/software-quality-formula.html&quot;&gt;quality&lt;/a&gt; and stability of the product under development.&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;http://casperjs.org/&quot;&gt;CasperJS&lt;/a&gt; is a testing framework on top of &lt;a href=&quot;http://phantomjs.org/&quot;&gt;PhantomJS&lt;/a&gt;, which is a headless browser. Using CasperJS, we can ensure that our application responds correctly to requests sent by a regular web browser.&lt;/p&gt; &lt;!--more--&gt; &lt;p&gt;This is a sample CasperJS test, which makes an HTTP request to a home page of a running WAR application and asserts that the response has &lt;code&gt;200&lt;/code&gt; HTTP status code:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;casper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;begin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;home page can be rendered&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;casper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;casper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cli&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;home&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// URL of home page&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;assertHttpStatus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;casper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;I keep this test in the &lt;code&gt;src/test/casperjs/home-page.js&lt;/code&gt; file. Let’s see how CasperJS can be executed automatically on every Maven build.&lt;/p&gt; &lt;p&gt;Here is the test scenario, implemented with a combination of Maven plugins:&lt;/p&gt; &lt;ol&gt; &lt;li&gt; &lt;p&gt;Install PhantomJS&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Install CasperJS&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Reserve a random TCP port&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Start Tomcat on that TCP port (with WAR inside)&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Run CasperJS tests and point them to the running Tomcat&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Shutdown Tomcat&lt;/p&gt; &lt;/li&gt; &lt;/ol&gt; &lt;p&gt;I’m using a combination of plugins. Let’s go through the steps one by one.&lt;/p&gt; &lt;p&gt;BTW, I’m not showing plugin versions in the examples below, primarily because most of them are in active development. Check their versions at &lt;a href=&quot;http://search.maven.org/&quot;&gt;Maven Central&lt;/a&gt; (yes, all of them are available there).&lt;/p&gt; &lt;h2 id=&quot;1-install-phantomjs&quot;&gt;1. Install PhantomJS&lt;/h2&gt; &lt;p&gt;First of all, we have to download the PhantomJS executable. It is a platform-specific binary. Thanks to &lt;a href=&quot;https://github.com/klieber&quot;&gt;Kyle Lieber&lt;/a&gt;, we have an off-the-shelf Maven plugin: &lt;a href=&quot;https://github.com/klieber/phantomjs-maven-plugin&quot;&gt;phantomjs-maven-plugin&lt;/a&gt; that understands what the current platform is and downloads the appropriate binary automatically, placing it into the &lt;code&gt;target&lt;/code&gt; directory.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.github.klieber&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;phantomjs-maven-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;install&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.9.2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;The exact name of the downloaded binary is stored in the &lt;code&gt;${phantomjs.binary}&lt;/code&gt; Maven property.&lt;/p&gt; &lt;h2 id=&quot;2-install-casperjs&quot;&gt;2. Install CasperJS&lt;/h2&gt; &lt;p&gt;Unfortunately, there is no similar plugin for the CasperJS installation (at least I haven’t found any as of yet). That’s why I’m using plain old &lt;code&gt;git&lt;/code&gt; (you should have it installed on your build machine).&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.codehaus.mojo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;exec-maven-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;casperjs-install&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;pre-integration-test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;exec&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executable&amp;gt;&lt;/span&gt;git&lt;span class=&quot;nt&quot;&gt;&amp;lt;/executable&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;arguments&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;clone&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;--depth=1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;https://github.com/n1k0/casperjs.git&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;${project.build.directory}/casperjs&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/arguments&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;h2 id=&quot;3-reserve-tcp-port&quot;&gt;3. Reserve TCP Port&lt;/h2&gt; &lt;p&gt;I need to obtain a random TCP port where Tomcat will be started. The port has to be available on the build machine. I want to be able to run multiple Maven builds in parallel, so that’s why I get a random port on every build.&lt;/p&gt; &lt;p&gt;In other examples, you may see people using fixed port numbers, like &lt;code&gt;5555&lt;/code&gt; or something similar. This is a very bad practice. Always reserve a new random port when you need it.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.codehaus.mojo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;build-helper-maven-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;tomcat-port&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;reserve-network-port&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;portNames&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;portName&amp;gt;&lt;/span&gt;tomcat.port&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portName&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/portNames&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;The plugin reserves a port and sets it value to the &lt;code&gt;${tomcat.port}&lt;/code&gt; Maven property.&lt;/p&gt; &lt;h2 id=&quot;4-start-tomcat&quot;&gt;4. Start Tomcat&lt;/h2&gt; &lt;p&gt;Now, it’s time to start Tomcat with the WAR package inside. I’m using &lt;a href=&quot;http://tomcat.apache.org/maven-plugin-2.0/tomcat7-maven-plugin/&quot;&gt;tomcat7-maven-plugin&lt;/a&gt; that starts a real Tomcat7 server and configures it to serve on the port reserved above.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.tomcat.maven&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;tomcat7-maven-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;path&amp;gt;&lt;/span&gt;/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/path&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;start-tomcat&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;pre-integration-test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;run-war-only&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;port&amp;gt;&lt;/span&gt;${tomcat.port}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/port&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;fork&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/fork&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;Due to the option &lt;code&gt;fork&lt;/code&gt; being set to &lt;code&gt;true&lt;/code&gt;, Tomcat7 continues to run when the plugin execution finishes. That’s exactly what I need.&lt;/p&gt; &lt;h2 id=&quot;5-run-casperjs&quot;&gt;5. Run CasperJS&lt;/h2&gt; &lt;p&gt;Now, it’s time to run CasperJS. Even though there are some plugins exist for this, I’m using plain old &lt;code&gt;exec-maven-plugin&lt;/code&gt;, mostly because it is more configurable.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.codehaus.mojo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;exec-maven-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;casperjs-test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;integration-test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;exec&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executable&amp;gt;&lt;/span&gt; ${project.build.directory}/casperjs/bin/casperjs &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executable&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;workingDirectory&amp;gt;&lt;/span&gt;${basedir}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/workingDirectory&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;arguments&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;--verbose&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;--no-colors&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;--concise&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;--home=http://localhost:${tomcat.port}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;argument&amp;gt;&lt;/span&gt;${basedir}/src/test/casperjs&lt;span class=&quot;nt&quot;&gt;&amp;lt;/argument&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/arguments&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;environmentVariables&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;PHANTOMJS_EXECUTABLE&amp;gt;&lt;/span&gt;${phantomjs.binary}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/PHANTOMJS_EXECUTABLE&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/environmentVariables&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;The environment variable &lt;code&gt;PHANTOMJS_EXECUTABLE&lt;/code&gt; is the undocumented feature that makes this whole scenario possible. It configures the location of the PhantomJS executable, which was downloaded a few steps above.&lt;/p&gt; &lt;h2 id=&quot;6-shutdown-tomcat&quot;&gt;6. Shutdown Tomcat&lt;/h2&gt; &lt;p&gt;In the last step, I shut down the Tomcat server.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.tomcat.maven&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;tomcat7-maven-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;stop-tomcat&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;post-integration-test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;shutdown&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;h2 id=&quot;real-example&quot;&gt;Real Example&lt;/h2&gt; &lt;p&gt;If you want to see how this all works in action, take a look at &lt;a href=&quot;http://www.stateful.co&quot;&gt;stateful.co&lt;/a&gt;. It is a Java Web application hosted at &lt;a href=&quot;http://www.cloudbees.com&quot;&gt;CloudBees&lt;/a&gt;. Its source code is open and available in &lt;a href=&quot;https://github.com/sttc/stateful&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;Its &lt;a href=&quot;https://github.com/sttc/stateful/blob/sttc-1.5/pom.xml&quot;&gt;&lt;code&gt;pom.xml&lt;/code&gt;&lt;/a&gt; contains exactly the same configurations explained above, but joined together.&lt;/p&gt; &lt;p&gt;If you have any questions, please don’t hesitate to ask below.&lt;/p&gt; &lt;p&gt;PS. Also, check this: &lt;a href=&quot;/2014/04/06/phandom.html&quot;&gt;PhantomJS as an HTML Validator&lt;/a&gt;&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/06/21/casperjs-with-maven.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2014/06/21/casperjs-with-maven.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/06/21/casperjs-with-maven.amp.html" /> <title>CasperJS Tests in Maven Build </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2014/06/21/casperjs-with-maven.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2014/06/21/casperjs-with-maven.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/06/21/casperjs-with-maven.html</code></p><h1 itemprop="name headline mainEntityOfPage">CasperJS Tests in Maven Build</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-06-21T00:00:00+00:00"> 21 June 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/06/21/casperjs-with-maven.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>I’m a big fan of automated testing in general and integration testing in particular. I strongly believe that effort spent on writing tests are direct investments into <a href="/2017/12/26/software-quality-formula.html">quality</a> and stability of the product under development.</p><p><a href="http://casperjs.org/">CasperJS</a> is a testing framework on top of <a href="http://phantomjs.org/">PhantomJS</a>, which is a headless browser. Using CasperJS, we can ensure that our application responds correctly to requests sent by a regular web browser.</p><p>This is a sample CasperJS test, which makes an HTTP request to a home page of a running WAR application and asserts that the response has <code>200</code> HTTP status code:</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="nx">casper</span><span class="p">.</span><span class="nx">test</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span>
  <span class="s1">&#39;home page can be rendered&#39;</span><span class="p">,</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">casper</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span>
      <span class="nx">casper</span><span class="p">.</span><span class="nx">cli</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">),</span> <span class="c1">// URL of home page</span>
      <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">assertHttpStatus</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">);</span>
    <span class="nx">casper</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span>
      <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">);</span></code></pre></figure><p>I keep this test in the <code>src/test/casperjs/home-page.js</code> file. Let’s see how CasperJS can be executed automatically on every Maven build.</p><p>Here is the test scenario, implemented with a combination of Maven plugins:</p><ol> <li><p>Install PhantomJS</p></li> <li><p>Install CasperJS</p></li> <li><p>Reserve a random TCP port</p></li> <li><p>Start Tomcat on that TCP port (with WAR inside)</p></li> <li><p>Run CasperJS tests and point them to the running Tomcat</p></li> <li><p>Shutdown Tomcat</p></li> </ol><p>I’m using a combination of plugins. Let’s go through the steps one by one.</p><p>BTW, I’m not showing plugin versions in the examples below, primarily because most of them are in active development. Check their versions at <a href="http://search.maven.org/">Maven Central</a> (yes, all of them are available there).</p><h2 id="1-install-phantomjs">1. Install PhantomJS</h2><p>First of all, we have to download the PhantomJS executable. It is a platform-specific binary. Thanks to <a href="https://github.com/klieber">Kyle Lieber</a>, we have an off-the-shelf Maven plugin: <a href="https://github.com/klieber/phantomjs-maven-plugin">phantomjs-maven-plugin</a> that understands what the current platform is and downloads the appropriate binary automatically, placing it into the <code>target</code> directory.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.github.klieber<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>phantomjs-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>install<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.9.2<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>The exact name of the downloaded binary is stored in the <code>${phantomjs.binary}</code> Maven property.</p><h2 id="2-install-casperjs">2. Install CasperJS</h2><p>Unfortunately, there is no similar plugin for the CasperJS installation (at least I haven’t found any as of yet). That’s why I’m using plain old <code>git</code> (you should have it installed on your build machine).</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>exec-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>casperjs-install<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;executable&gt;</span>git<span class="nt">&lt;/executable&gt;</span>
        <span class="nt">&lt;arguments&gt;</span>
          <span class="nt">&lt;argument&gt;</span>clone<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--depth=1<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>https://github.com/n1k0/casperjs.git<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>${project.build.directory}/casperjs<span class="nt">&lt;/argument&gt;</span>
        <span class="nt">&lt;/arguments&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><h2 id="3-reserve-tcp-port">3. Reserve TCP Port</h2><p>I need to obtain a random TCP port where Tomcat will be started. The port has to be available on the build machine. I want to be able to run multiple Maven builds in parallel, so that’s why I get a random port on every build.</p><p>In other examples, you may see people using fixed port numbers, like <code>5555</code> or something similar. This is a very bad practice. Always reserve a new random port when you need it.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>build-helper-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>tomcat-port<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>reserve-network-port<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;portNames&gt;</span>
          <span class="nt">&lt;portName&gt;</span>tomcat.port<span class="nt">&lt;/portName&gt;</span>
        <span class="nt">&lt;/portNames&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>The plugin reserves a port and sets it value to the <code>${tomcat.port}</code> Maven property.</p><h2 id="4-start-tomcat">4. Start Tomcat</h2><p>Now, it’s time to start Tomcat with the WAR package inside. I’m using <a href="http://tomcat.apache.org/maven-plugin-2.0/tomcat7-maven-plugin/">tomcat7-maven-plugin</a> that starts a real Tomcat7 server and configures it to serve on the port reserved above.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.maven<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;path&gt;</span>/<span class="nt">&lt;/path&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>start-tomcat<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>run-war-only<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;port&gt;</span>${tomcat.port}<span class="nt">&lt;/port&gt;</span>
        <span class="nt">&lt;fork&gt;</span>true<span class="nt">&lt;/fork&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>Due to the option <code>fork</code> being set to <code>true</code>, Tomcat7 continues to run when the plugin execution finishes. That’s exactly what I need.</p><h2 id="5-run-casperjs">5. Run CasperJS</h2><p>Now, it’s time to run CasperJS. Even though there are some plugins exist for this, I’m using plain old <code>exec-maven-plugin</code>, mostly because it is more configurable.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>exec-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>casperjs-test<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;executable&gt;</span>
          ${project.build.directory}/casperjs/bin/casperjs
        <span class="nt">&lt;/executable&gt;</span>
        <span class="nt">&lt;workingDirectory&gt;</span>${basedir}<span class="nt">&lt;/workingDirectory&gt;</span>
        <span class="nt">&lt;arguments&gt;</span>
          <span class="nt">&lt;argument&gt;</span>test<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--verbose<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--no-colors<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--concise<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--home=http://localhost:${tomcat.port}<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>${basedir}/src/test/casperjs<span class="nt">&lt;/argument&gt;</span>
        <span class="nt">&lt;/arguments&gt;</span>
        <span class="nt">&lt;environmentVariables&gt;</span>
          <span class="nt">&lt;PHANTOMJS_EXECUTABLE&gt;</span>${phantomjs.binary}<span class="nt">&lt;/PHANTOMJS_EXECUTABLE&gt;</span>
        <span class="nt">&lt;/environmentVariables&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>The environment variable <code>PHANTOMJS_EXECUTABLE</code> is the undocumented feature that makes this whole scenario possible. It configures the location of the PhantomJS executable, which was downloaded a few steps above.</p><h2 id="6-shutdown-tomcat">6. Shutdown Tomcat</h2><p>In the last step, I shut down the Tomcat server.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.maven<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>stop-tomcat<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>post-integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>shutdown<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><h2 id="real-example">Real Example</h2><p>If you want to see how this all works in action, take a look at <a href="http://www.stateful.co">stateful.co</a>. It is a Java Web application hosted at <a href="http://www.cloudbees.com">CloudBees</a>. Its source code is open and available in <a href="https://github.com/sttc/stateful">GitHub</a>.</p><p>Its <a href="https://github.com/sttc/stateful/blob/sttc-1.5/pom.xml"><code>pom.xml</code></a> contains exactly the same configurations explained above, but joined together.</p><p>If you have any questions, please don’t hesitate to ask below.</p><p>PS. Also, check this: <a href="/2014/04/06/phandom.html">PhantomJS as an HTML Validator</a></p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html&amp;text=CasperJS+Tests+in+Maven+Build" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html%3F2014-24&amp;title=CasperJS+Tests+in+Maven+Build" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/06/21/casperjs-with-maven.html%3F2014-24&amp;t=CasperJS+Tests+in+Maven+Build" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>I’m a big fan of automated testing in general and integration testing in particular. I strongly believe that effort spent on writing tests are direct investments into <a href="/2017/12/26/software-quality-formula.html">quality</a> and stability of the product under development.</p><p><a href="http://casperjs.org/">CasperJS</a> is a testing framework on top of <a href="http://phantomjs.org/">PhantomJS</a>, which is a headless browser. Using CasperJS, we can ensure that our application responds correctly to requests sent by a regular web browser.</p><p>This is a sample CasperJS test, which makes an HTTP request to a home page of a running WAR application and asserts that the response has <code>200</code> HTTP status code:</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="nx">casper</span><span class="p">.</span><span class="nx">test</span><span class="p">.</span><span class="nx">begin</span><span class="p">(</span>
  <span class="s1">&#39;home page can be rendered&#39;</span><span class="p">,</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">casper</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span>
      <span class="nx">casper</span><span class="p">.</span><span class="nx">cli</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">),</span> <span class="c1">// URL of home page</span>
      <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">assertHttpStatus</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">);</span>
    <span class="nx">casper</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span>
      <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">);</span></code></pre></figure><p>I keep this test in the <code>src/test/casperjs/home-page.js</code> file. Let’s see how CasperJS can be executed automatically on every Maven build.</p><p>Here is the test scenario, implemented with a combination of Maven plugins:</p><ol> <li><p>Install PhantomJS</p></li> <li><p>Install CasperJS</p></li> <li><p>Reserve a random TCP port</p></li> <li><p>Start Tomcat on that TCP port (with WAR inside)</p></li> <li><p>Run CasperJS tests and point them to the running Tomcat</p></li> <li><p>Shutdown Tomcat</p></li> </ol><p>I’m using a combination of plugins. Let’s go through the steps one by one.</p><p>BTW, I’m not showing plugin versions in the examples below, primarily because most of them are in active development. Check their versions at <a href="http://search.maven.org/">Maven Central</a> (yes, all of them are available there).</p><h2 id="1-install-phantomjs">1. Install PhantomJS</h2><p>First of all, we have to download the PhantomJS executable. It is a platform-specific binary. Thanks to <a href="https://github.com/klieber">Kyle Lieber</a>, we have an off-the-shelf Maven plugin: <a href="https://github.com/klieber/phantomjs-maven-plugin">phantomjs-maven-plugin</a> that understands what the current platform is and downloads the appropriate binary automatically, placing it into the <code>target</code> directory.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.github.klieber<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>phantomjs-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>install<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.9.2<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>The exact name of the downloaded binary is stored in the <code>${phantomjs.binary}</code> Maven property.</p><h2 id="2-install-casperjs">2. Install CasperJS</h2><p>Unfortunately, there is no similar plugin for the CasperJS installation (at least I haven’t found any as of yet). That’s why I’m using plain old <code>git</code> (you should have it installed on your build machine).</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>exec-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>casperjs-install<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;executable&gt;</span>git<span class="nt">&lt;/executable&gt;</span>
        <span class="nt">&lt;arguments&gt;</span>
          <span class="nt">&lt;argument&gt;</span>clone<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--depth=1<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>https://github.com/n1k0/casperjs.git<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>${project.build.directory}/casperjs<span class="nt">&lt;/argument&gt;</span>
        <span class="nt">&lt;/arguments&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><h2 id="3-reserve-tcp-port">3. Reserve TCP Port</h2><p>I need to obtain a random TCP port where Tomcat will be started. The port has to be available on the build machine. I want to be able to run multiple Maven builds in parallel, so that’s why I get a random port on every build.</p><p>In other examples, you may see people using fixed port numbers, like <code>5555</code> or something similar. This is a very bad practice. Always reserve a new random port when you need it.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>build-helper-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>tomcat-port<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>reserve-network-port<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;portNames&gt;</span>
          <span class="nt">&lt;portName&gt;</span>tomcat.port<span class="nt">&lt;/portName&gt;</span>
        <span class="nt">&lt;/portNames&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>The plugin reserves a port and sets it value to the <code>${tomcat.port}</code> Maven property.</p><h2 id="4-start-tomcat">4. Start Tomcat</h2><p>Now, it’s time to start Tomcat with the WAR package inside. I’m using <a href="http://tomcat.apache.org/maven-plugin-2.0/tomcat7-maven-plugin/">tomcat7-maven-plugin</a> that starts a real Tomcat7 server and configures it to serve on the port reserved above.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.maven<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;path&gt;</span>/<span class="nt">&lt;/path&gt;</span>
  <span class="nt">&lt;/configuration&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>start-tomcat<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>run-war-only<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;port&gt;</span>${tomcat.port}<span class="nt">&lt;/port&gt;</span>
        <span class="nt">&lt;fork&gt;</span>true<span class="nt">&lt;/fork&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>Due to the option <code>fork</code> being set to <code>true</code>, Tomcat7 continues to run when the plugin execution finishes. That’s exactly what I need.</p><h2 id="5-run-casperjs">5. Run CasperJS</h2><p>Now, it’s time to run CasperJS. Even though there are some plugins exist for this, I’m using plain old <code>exec-maven-plugin</code>, mostly because it is more configurable.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>exec-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>casperjs-test<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
      <span class="nt">&lt;configuration&gt;</span>
        <span class="nt">&lt;executable&gt;</span>
          ${project.build.directory}/casperjs/bin/casperjs
        <span class="nt">&lt;/executable&gt;</span>
        <span class="nt">&lt;workingDirectory&gt;</span>${basedir}<span class="nt">&lt;/workingDirectory&gt;</span>
        <span class="nt">&lt;arguments&gt;</span>
          <span class="nt">&lt;argument&gt;</span>test<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--verbose<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--no-colors<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--concise<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>--home=http://localhost:${tomcat.port}<span class="nt">&lt;/argument&gt;</span>
          <span class="nt">&lt;argument&gt;</span>${basedir}/src/test/casperjs<span class="nt">&lt;/argument&gt;</span>
        <span class="nt">&lt;/arguments&gt;</span>
        <span class="nt">&lt;environmentVariables&gt;</span>
          <span class="nt">&lt;PHANTOMJS_EXECUTABLE&gt;</span>${phantomjs.binary}<span class="nt">&lt;/PHANTOMJS_EXECUTABLE&gt;</span>
        <span class="nt">&lt;/environmentVariables&gt;</span>
      <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><p>The environment variable <code>PHANTOMJS_EXECUTABLE</code> is the undocumented feature that makes this whole scenario possible. It configures the location of the PhantomJS executable, which was downloaded a few steps above.</p><h2 id="6-shutdown-tomcat">6. Shutdown Tomcat</h2><p>In the last step, I shut down the Tomcat server.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.maven<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;executions&gt;</span>
    <span class="nt">&lt;execution&gt;</span>
      <span class="nt">&lt;id&gt;</span>stop-tomcat<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;phase&gt;</span>post-integration-test<span class="nt">&lt;/phase&gt;</span>
      <span class="nt">&lt;goals&gt;</span>
        <span class="nt">&lt;goal&gt;</span>shutdown<span class="nt">&lt;/goal&gt;</span>
      <span class="nt">&lt;/goals&gt;</span>
    <span class="nt">&lt;/execution&gt;</span>
  <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></figure><h2 id="real-example">Real Example</h2><p>If you want to see how this all works in action, take a look at <a href="http://www.stateful.co">stateful.co</a>. It is a Java Web application hosted at <a href="http://www.cloudbees.com">CloudBees</a>. Its source code is open and available in <a href="https://github.com/sttc/stateful">GitHub</a>.</p><p>Its <a href="https://github.com/sttc/stateful/blob/sttc-1.5/pom.xml"><code>pom.xml</code></a> contains exactly the same configurations explained above, but joined together.</p><p>If you have any questions, please don’t hesitate to ask below.</p><p>PS. Also, check this: <a href="/2014/04/06/phandom.html">PhantomJS as an HTML Validator</a></p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-04-28 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="XML/XPath Matchers for Hamcrest"/> <meta name="twitter:description" property="og:description" content="&lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://matchers.jcabi.com&quot;&gt;&lt;img src=&quot;http://img.jcabi.com/logo-square.svg&quot; style=&quot;width:64px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/hamcrest/JavaHamcrest&quot;&gt;Hamcrest&lt;/a&gt; is my favorite instrument in unit testing. It replaces the JUnit procedural assertions of &lt;code&gt;org.junit.Assert&lt;/code&gt; with an object-oriented mechanism. However, I will discuss that subject in more detail sometime later.&lt;/p&gt; &lt;p&gt;Now, though, I want to demonstrate a new library published today on GitHub and Maven Central: &lt;a href=&quot;http://matchers.jcabi.com&quot;&gt;jcabi-matchers&lt;/a&gt;. jcabi-matchers is a collection of Hamcrest matchers to make XPath assertions in XML and XHTML documents.&lt;/p&gt; &lt;p&gt;Let’s say, for instance, a class that is undergoing testing produces an XML that needs to contain a single &lt;code&gt;&amp;lt;message&amp;gt;&lt;/code&gt; element with the content &lt;code&gt;&quot;hello, world!&quot;&lt;/code&gt;&lt;/p&gt; &lt;p&gt;This is how that code would look in a unit test:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.jcabi.matchers.XhtmlMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.hamcrest.MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.junit.Test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FooTest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;hasWelcomeMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;createXml&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XhtmlMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasXPaths&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/document[count(message)=1]&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;/document/message[.=&amp;#39;hello, world!&amp;#39;]&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;!--more--&gt; &lt;p&gt;There are two alternatives to the above that I’m aware of, which are do almost the same thing: &lt;a href=&quot;https://code.google.com/p/xml-matchers/&quot;&gt;xml-matchers&lt;/a&gt; by David Ehringer and &lt;a href=&quot;https://github.com/hamcrest/JavaHamcrest/blob/hamcrest-java-1.3/hamcrest-library/src/main/java/org/hamcrest/xml/HasXPath.java&quot;&gt;&lt;code&gt;hasXPath()&lt;/code&gt;&lt;/a&gt; method in Hamcrest itself.&lt;/p&gt; &lt;p&gt;I have tried them both, but faced a number of problems.&lt;/p&gt; &lt;p&gt;First, Hamcrest &lt;code&gt;hasXPath()&lt;/code&gt; works only with an instance of &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html&quot;&gt;&lt;code&gt;Node&lt;/code&gt;&lt;/a&gt;. With this method, converting a &lt;code&gt;String&lt;/code&gt; into &lt;code&gt;Node&lt;/code&gt; becomes a repetitive and routine task in every unit test.&lt;/p&gt; &lt;p&gt;The above is a very strange limitation of Hamcrest in contrast to &lt;a href=&quot;http://matchers.jcabi.com&quot;&gt;jcabi-matchers&lt;/a&gt;, which works with almost anything, from a &lt;code&gt;String&lt;/code&gt; to a &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html&quot;&gt;&lt;code&gt;Reader&lt;/code&gt;&lt;/a&gt; and even an &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html&quot;&gt;&lt;code&gt;InputStream&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;Second, &lt;code&gt;XmlMatchers&lt;/code&gt; from &lt;a href=&quot;https://code.google.com/p/xml-matchers/&quot;&gt;xml-matchers&lt;/a&gt; provides a very inconvenient way for working with namespaces. Before you can use an XPath query with a non-default namespace, you should create an instance of &lt;code&gt;NamespaceContext&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;The library provides &lt;a href=&quot;https://code.google.com/p/xml-matchers/source/browse/trunk/xml-matchers/src/main/java/org/xmlmatchers/namespace/SimpleNamespaceContext.java&quot;&gt;a simple implementation&lt;/a&gt; of this interface, but, still, it is requires extra code in every unit test.&lt;/p&gt; &lt;p&gt;&lt;a href=&quot;http://matchers.jcabi.com&quot;&gt;jcabi-matchers&lt;/a&gt; simplifies namespace handling problems even further, as it pre-defines most popular namespaces, including &lt;code&gt;xhtml&lt;/code&gt;, &lt;code&gt;xs&lt;/code&gt;, &lt;code&gt;xsl&lt;/code&gt;, etc.&lt;/p&gt; &lt;p&gt;The following example works right out-of-the-box—without any extra configuration:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://www.google.com&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getContent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XhtmlMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasXPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;//xhtml:body&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;To summarize, my primary objective with the library was its simplicity of usage.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.amp.html" /> <title>XML/XPath Matchers for Hamcrest </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2014/04/28/xml-xpath-hamcrest-matchers.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html</code></p><h1 itemprop="name headline mainEntityOfPage">XML/XPath Matchers for Hamcrest</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-04-28T00:00:00+00:00"> 28 April 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><figure class="badge"><a href="http://matchers.jcabi.com"><img src="http://img.jcabi.com/logo-square.svg" style="width:64px;max-width:100%;" alt="badge" /></a></figure><p><a href="https://github.com/hamcrest/JavaHamcrest">Hamcrest</a> is my favorite instrument in unit testing. It replaces the JUnit procedural assertions of <code>org.junit.Assert</code> with an object-oriented mechanism. However, I will discuss that subject in more detail sometime later.</p><p>Now, though, I want to demonstrate a new library published today on GitHub and Maven Central: <a href="http://matchers.jcabi.com">jcabi-matchers</a>. jcabi-matchers is a collection of Hamcrest matchers to make XPath assertions in XML and XHTML documents.</p><p>Let’s say, for instance, a class that is undergoing testing produces an XML that needs to contain a single <code>&lt;message&gt;</code> element with the content <code>"hello, world!"</code></p><p>This is how that code would look in a unit test:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">com.jcabi.matchers.XhtmlMatchers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hamcrest.MatcherAssert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FooTest</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hasWelcomeMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">Foo</span><span class="o">().</span><span class="na">createXml</span><span class="o">(),</span>
      <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">hasXPaths</span><span class="o">(</span>
        <span class="s">&quot;/document[count(message)=1]&quot;</span><span class="o">,</span>
        <span class="s">&quot;/document/message[.=&#39;hello, world!&#39;]&quot;</span>
      <span class="o">)</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>There are two alternatives to the above that I’m aware of, which are do almost the same thing: <a href="https://code.google.com/p/xml-matchers/">xml-matchers</a> by David Ehringer and <a href="https://github.com/hamcrest/JavaHamcrest/blob/hamcrest-java-1.3/hamcrest-library/src/main/java/org/hamcrest/xml/HasXPath.java"><code>hasXPath()</code></a> method in Hamcrest itself.</p><p>I have tried them both, but faced a number of problems.</p><p>First, Hamcrest <code>hasXPath()</code> works only with an instance of <a href="http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html"><code>Node</code></a>. With this method, converting a <code>String</code> into <code>Node</code> becomes a repetitive and routine task in every unit test.</p><p>The above is a very strange limitation of Hamcrest in contrast to <a href="http://matchers.jcabi.com">jcabi-matchers</a>, which works with almost anything, from a <code>String</code> to a <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html"><code>Reader</code></a> and even an <a href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html"><code>InputStream</code></a>.</p><p>Second, <code>XmlMatchers</code> from <a href="https://code.google.com/p/xml-matchers/">xml-matchers</a> provides a very inconvenient way for working with namespaces. Before you can use an XPath query with a non-default namespace, you should create an instance of <code>NamespaceContext</code>.</p><p>The library provides <a href="https://code.google.com/p/xml-matchers/source/browse/trunk/xml-matchers/src/main/java/org/xmlmatchers/namespace/SimpleNamespaceContext.java">a simple implementation</a> of this interface, but, still, it is requires extra code in every unit test.</p><p><a href="http://matchers.jcabi.com">jcabi-matchers</a> simplifies namespace handling problems even further, as it pre-defines most popular namespaces, including <code>xhtml</code>, <code>xs</code>, <code>xsl</code>, etc.</p><p>The following example works right out-of-the-box—without any extra configuration:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">&quot;http://www.google.com&quot;</span><span class="o">).</span><span class="na">getContent</span><span class="o">(),</span>
  <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">hasXPath</span><span class="o">(</span><span class="s">&quot;//xhtml:body&quot;</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>To summarize, my primary objective with the library was its simplicity of usage.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html&amp;text=XML%2FXPath+Matchers+for+Hamcrest" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html%3F2014-17&amp;title=XML%2FXPath+Matchers+for+Hamcrest" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/04/28/xml-xpath-hamcrest-matchers.html%3F2014-17&amp;t=XML%2FXPath+Matchers+for+Hamcrest" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class="badge"><a href="http://matchers.jcabi.com"><img src="http://img.jcabi.com/logo-square.svg" style="width:64px;max-width:100%;" alt="badge" /></a></figure><p><a href="https://github.com/hamcrest/JavaHamcrest">Hamcrest</a> is my favorite instrument in unit testing. It replaces the JUnit procedural assertions of <code>org.junit.Assert</code> with an object-oriented mechanism. However, I will discuss that subject in more detail sometime later.</p><p>Now, though, I want to demonstrate a new library published today on GitHub and Maven Central: <a href="http://matchers.jcabi.com">jcabi-matchers</a>. jcabi-matchers is a collection of Hamcrest matchers to make XPath assertions in XML and XHTML documents.</p><p>Let’s say, for instance, a class that is undergoing testing produces an XML that needs to contain a single <code>&lt;message&gt;</code> element with the content <code>"hello, world!"</code></p><p>This is how that code would look in a unit test:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">com.jcabi.matchers.XhtmlMatchers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hamcrest.MatcherAssert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FooTest</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hasWelcomeMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
      <span class="k">new</span> <span class="n">Foo</span><span class="o">().</span><span class="na">createXml</span><span class="o">(),</span>
      <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">hasXPaths</span><span class="o">(</span>
        <span class="s">&quot;/document[count(message)=1]&quot;</span><span class="o">,</span>
        <span class="s">&quot;/document/message[.=&#39;hello, world!&#39;]&quot;</span>
      <span class="o">)</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>There are two alternatives to the above that I’m aware of, which are do almost the same thing: <a href="https://code.google.com/p/xml-matchers/">xml-matchers</a> by David Ehringer and <a href="https://github.com/hamcrest/JavaHamcrest/blob/hamcrest-java-1.3/hamcrest-library/src/main/java/org/hamcrest/xml/HasXPath.java"><code>hasXPath()</code></a> method in Hamcrest itself.</p><p>I have tried them both, but faced a number of problems.</p><p>First, Hamcrest <code>hasXPath()</code> works only with an instance of <a href="http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html"><code>Node</code></a>. With this method, converting a <code>String</code> into <code>Node</code> becomes a repetitive and routine task in every unit test.</p><p>The above is a very strange limitation of Hamcrest in contrast to <a href="http://matchers.jcabi.com">jcabi-matchers</a>, which works with almost anything, from a <code>String</code> to a <a href="http://docs.oracle.com/javase/7/docs/api/java/io/Reader.html"><code>Reader</code></a> and even an <a href="http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html"><code>InputStream</code></a>.</p><p>Second, <code>XmlMatchers</code> from <a href="https://code.google.com/p/xml-matchers/">xml-matchers</a> provides a very inconvenient way for working with namespaces. Before you can use an XPath query with a non-default namespace, you should create an instance of <code>NamespaceContext</code>.</p><p>The library provides <a href="https://code.google.com/p/xml-matchers/source/browse/trunk/xml-matchers/src/main/java/org/xmlmatchers/namespace/SimpleNamespaceContext.java">a simple implementation</a> of this interface, but, still, it is requires extra code in every unit test.</p><p><a href="http://matchers.jcabi.com">jcabi-matchers</a> simplifies namespace handling problems even further, as it pre-defines most popular namespaces, including <code>xhtml</code>, <code>xs</code>, <code>xsl</code>, etc.</p><p>The following example works right out-of-the-box—without any extra configuration:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">&quot;http://www.google.com&quot;</span><span class="o">).</span><span class="na">getContent</span><span class="o">(),</span>
  <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">hasXPath</span><span class="o">(</span><span class="s">&quot;//xhtml:body&quot;</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>To summarize, my primary objective with the library was its simplicity of usage.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-04-18 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Mocking of HTTP Server in Java"/> <meta name="twitter:description" property="og:description" content="&lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://http.jcabi.com&quot;&gt;&lt;img src=&quot;http://img.jcabi.com/logo-square.svg&quot; style=&quot;width:64px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;Recently, I explained a &lt;a href=&quot;/2014/04/11/jcabi-http-intro.html&quot;&gt;fluent Java HTTP client&lt;/a&gt; created (mostly) to make HTTP interactions more object-oriented than with other available clients,including: &lt;a href=&quot;http://hc.apache.org/httpclient-3.x/&quot;&gt;Apache Client&lt;/a&gt;, &lt;a href=&quot;https://jersey.java.net/documentation/latest/client.html&quot;&gt;Jersey Client&lt;/a&gt; and plain old &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html&quot;&gt;&lt;code&gt;HttpURLConnection&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;This client ships in the &lt;a href=&quot;http://http.jcabi.com&quot;&gt;jcabi-http&lt;/a&gt; Maven artifact. However, the client part is not the only benefit of using &lt;a href=&quot;http://http.jcabi.com&quot;&gt;jcabi-http&lt;/a&gt;. Jcabi also includes a server component that can help you in unit and integration testing of your HTTP clients.&lt;/p&gt; &lt;!--more--&gt; &lt;p&gt;Let me show you an example first. In the example, I’m using &lt;a href=&quot;https://github.com/hamcrest&quot;&gt;hamcrest&lt;/a&gt; for assertions.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MkContainer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MkGrizzlyContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MkAnswer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;Simple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hello, world!&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JdkRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;User-agent&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Myself&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertBody&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Matchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;containsString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MkQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;User-agent&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Matchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Myself&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;Now, let’s discover what happens here.&lt;/p&gt; &lt;p&gt;In the first few lines, I create an instance of &lt;a href=&quot;http://http.jcabi.com/apidocs-1.1/com/jcabi/http/mock/MkContainer.html&quot;&gt;&lt;code&gt;MkContainer&lt;/code&gt;&lt;/a&gt;, which literally has four methods: &lt;code&gt;next(MkAnswer)&lt;/code&gt;, &lt;code&gt;start()&lt;/code&gt;, &lt;code&gt;stop()&lt;/code&gt;, and &lt;code&gt;home()&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;It works as an HTTP server with a “first-in-first-out” queue for HTTP answers. We add answers, and the server returns them in response to HTTP requests.&lt;/p&gt; &lt;p&gt;The server starts on &lt;code&gt;start()&lt;/code&gt; call and stops on &lt;code&gt;stop()&lt;/code&gt;. Its method &lt;code&gt;home()&lt;/code&gt; returns a URL of its “home page.” The server then binds itself to a randomly allocated TCP port.&lt;/p&gt; &lt;p&gt;The container finds the first available and unoccupied port.&lt;/p&gt; &lt;p&gt;In the example above, I added just one answer. This means that the container will reply only to the first HTTP request with that answer and that all consecutive requests will cause HTTP responses with status “internal server error &lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html&quot;&gt;500&lt;/a&gt;.”&lt;/p&gt; &lt;p&gt;In lines 5 through 8, I make an HTTP request to the already started server. Also, I make an assertion that the body of the HTTP response contains the text &lt;code&gt;&quot;hello&quot;&lt;/code&gt;. Obviously, this assertion will pass because the server will return &lt;code&gt;&quot;hello, world!&quot;&lt;/code&gt; to my first request:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;JdkRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;User-agent&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Myself&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertBody&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Matchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;containsString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;As you can see, I use &lt;code&gt;container.home()&lt;/code&gt; in order to get the URL of the server. It is recommended that you allow the container to find the first unoccupied TCP port and bind itself to it. Nevertheless, if you need to specify your own port, you can do it with a one-argument method &lt;a href=&quot;http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkContainer.html#start%28int%29&quot;&gt;&lt;code&gt;start(int)&lt;/code&gt;&lt;/a&gt; in &lt;code&gt;MkContainer&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;I use &lt;code&gt;try/finally&lt;/code&gt; to stop the container safely. In unit tests, this is not critical, as you can simplify your code and never stop the container. Besides, the container will be killed together with the JVM. However, for the sake of clarity, I would recommend you stop the container in the &lt;code&gt;finally&lt;/code&gt; block.&lt;/p&gt; &lt;p&gt;On line 12, I ask the stopped container to give me the first request it received. This mechanism is similar conceptually to the “verify” technology of mocking frameworks. For example, &lt;a href=&quot;http://mockito.org/&quot;&gt;Mockito&lt;/a&gt;.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MkQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;User-agent&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Matchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasItem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Myself&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;An instance of &lt;a href=&quot;http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkQuery.html&quot;&gt;&lt;code&gt;MkQuery&lt;/code&gt;&lt;/a&gt; exposes information about the query made. In this example, I get all headers of the HTTP request and making an assertion that the&lt;code&gt;&quot;User-Agent&quot;&lt;/code&gt; header was there and had at least one value equal to &lt;code&gt;&quot;Myself&quot;&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;This mocking technology is used actively in unit and integration tests of &lt;a href=&quot;http://github.com/jcabi/jcabi-github&quot;&gt;jcabi-github&lt;/a&gt;, which is a Java client to GitHub API. In its development, the technology is very important in checking which requests are being sent to the server and validating whether they comply with our requirements. Here, we are using &lt;a href=&quot;http://http.jcabi.com&quot;&gt;jcabi-http&lt;/a&gt; mocking.&lt;/p&gt; &lt;p&gt;As with the client, you need the &lt;a href=&quot;http://repo1.maven.org/maven2/com/jcabi/jcabi-http&quot;&gt;&lt;code&gt;jcabi-http.jar&lt;/code&gt;&lt;/a&gt; dependency (get its latest versions in &lt;a href=&quot;http://search.maven.org/&quot;&gt;Maven Central&lt;/a&gt;):&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.jcabi&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;jcabi-http&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;Besides the above, you need to add one more dependency, which is a Grizzly HTTP server. &lt;a href=&quot;http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkGrizzlyContainer.html&quot;&gt;&lt;code&gt;MkGrizzlyContainer&lt;/code&gt;&lt;/a&gt; is based on it.&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.sun.grizzly&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;grizzly-servlet-webserver&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;If you have any questions or suggestions, please submit them through &lt;a href=&quot;http://github.com/jcabi/jcabi-http/issues&quot;&gt;GitHub issues&lt;/a&gt;. As always, bugs are welcome :)&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.amp.html" /> <title>Mocking of HTTP Server in Java </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2014/04/18/jcabi-http-server-mocking.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2014/04/18/jcabi-http-server-mocking.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html</code></p><h1 itemprop="name headline mainEntityOfPage">Mocking of HTTP Server in Java</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-04-18T00:00:00+00:00"> 18 April 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><figure class="badge"><a href="http://http.jcabi.com"><img src="http://img.jcabi.com/logo-square.svg" style="width:64px;max-width:100%;" alt="badge" /></a></figure><p>Recently, I explained a <a href="/2014/04/11/jcabi-http-intro.html">fluent Java HTTP client</a> created (mostly) to make HTTP interactions more object-oriented than with other available clients,including: <a href="http://hc.apache.org/httpclient-3.x/">Apache Client</a>, <a href="https://jersey.java.net/documentation/latest/client.html">Jersey Client</a> and plain old <a href="http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html"><code>HttpURLConnection</code></a>.</p><p>This client ships in the <a href="http://http.jcabi.com">jcabi-http</a> Maven artifact. However, the client part is not the only benefit of using <a href="http://http.jcabi.com">jcabi-http</a>. Jcabi also includes a server component that can help you in unit and integration testing of your HTTP clients.</p><p>Let me show you an example first. In the example, I’m using <a href="https://github.com/hamcrest">hamcrest</a> for assertions.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">MkContainer</span> <span class="n">container</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MkGrizzlyContainer</span><span class="o">()</span>
  <span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="k">new</span> <span class="n">MkAnswer</span><span class="o">.</span><span class="na">Simple</span><span class="o">(</span><span class="s">&quot;hello, world!&quot;</span><span class="o">))</span>
  <span class="o">.</span><span class="na">start</span><span class="o">();</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="k">new</span> <span class="n">JdkRequest</span><span class="o">(</span><span class="n">container</span><span class="o">.</span><span class="na">home</span><span class="o">())</span>
    <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">,</span> <span class="s">&quot;Myself&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">fetch</span><span class="o">()</span>
    <span class="o">.</span><span class="na">assertBody</span><span class="o">(</span><span class="n">Matchers</span><span class="o">.</span><span class="na">containsString</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">));</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
  <span class="n">container</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="o">}</span>
<span class="n">MkQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">take</span><span class="o">();</span>
<span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
  <span class="n">query</span><span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">),</span>
  <span class="n">Matchers</span><span class="o">.</span><span class="na">hasItem</span><span class="o">(</span><span class="s">&quot;Myself&quot;</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>Now, let’s discover what happens here.</p><p>In the first few lines, I create an instance of <a href="http://http.jcabi.com/apidocs-1.1/com/jcabi/http/mock/MkContainer.html"><code>MkContainer</code></a>, which literally has four methods: <code>next(MkAnswer)</code>, <code>start()</code>, <code>stop()</code>, and <code>home()</code>.</p><p>It works as an HTTP server with a “first-in-first-out” queue for HTTP answers. We add answers, and the server returns them in response to HTTP requests.</p><p>The server starts on <code>start()</code> call and stops on <code>stop()</code>. Its method <code>home()</code> returns a URL of its “home page.” The server then binds itself to a randomly allocated TCP port.</p><p>The container finds the first available and unoccupied port.</p><p>In the example above, I added just one answer. This means that the container will reply only to the first HTTP request with that answer and that all consecutive requests will cause HTTP responses with status “internal server error <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">500</a>.”</p><p>In lines 5 through 8, I make an HTTP request to the already started server. Also, I make an assertion that the body of the HTTP response contains the text <code>"hello"</code>. Obviously, this assertion will pass because the server will return <code>"hello, world!"</code> to my first request:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="k">new</span> <span class="n">JdkRequest</span><span class="o">(</span><span class="n">container</span><span class="o">.</span><span class="na">home</span><span class="o">())</span>
  <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">,</span> <span class="s">&quot;Myself&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">fetch</span><span class="o">()</span>
  <span class="o">.</span><span class="na">assertBody</span><span class="o">(</span><span class="n">Matchers</span><span class="o">.</span><span class="na">containsString</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">));</span></code></pre></figure><p>As you can see, I use <code>container.home()</code> in order to get the URL of the server. It is recommended that you allow the container to find the first unoccupied TCP port and bind itself to it. Nevertheless, if you need to specify your own port, you can do it with a one-argument method <a href="http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkContainer.html#start%28int%29"><code>start(int)</code></a> in <code>MkContainer</code>.</p><p>I use <code>try/finally</code> to stop the container safely. In unit tests, this is not critical, as you can simplify your code and never stop the container. Besides, the container will be killed together with the JVM. However, for the sake of clarity, I would recommend you stop the container in the <code>finally</code> block.</p><p>On line 12, I ask the stopped container to give me the first request it received. This mechanism is similar conceptually to the “verify” technology of mocking frameworks. For example, <a href="http://mockito.org/">Mockito</a>.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">MkQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">take</span><span class="o">();</span>
<span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
  <span class="n">query</span><span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">),</span>
  <span class="n">Matchers</span><span class="o">.</span><span class="na">hasItem</span><span class="o">(</span><span class="s">&quot;Myself&quot;</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>An instance of <a href="http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkQuery.html"><code>MkQuery</code></a> exposes information about the query made. In this example, I get all headers of the HTTP request and making an assertion that the<code>"User-Agent"</code> header was there and had at least one value equal to <code>"Myself"</code>.</p><p>This mocking technology is used actively in unit and integration tests of <a href="http://github.com/jcabi/jcabi-github">jcabi-github</a>, which is a Java client to GitHub API. In its development, the technology is very important in checking which requests are being sent to the server and validating whether they comply with our requirements. Here, we are using <a href="http://http.jcabi.com">jcabi-http</a> mocking.</p><p>As with the client, you need the <a href="http://repo1.maven.org/maven2/com/jcabi/jcabi-http"><code>jcabi-http.jar</code></a> dependency (get its latest versions in <a href="http://search.maven.org/">Maven Central</a>):</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.jcabi<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>jcabi-http<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure><p>Besides the above, you need to add one more dependency, which is a Grizzly HTTP server. <a href="http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkGrizzlyContainer.html"><code>MkGrizzlyContainer</code></a> is based on it.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.sun.grizzly<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>grizzly-servlet-webserver<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure><p>If you have any questions or suggestions, please submit them through <a href="http://github.com/jcabi/jcabi-http/issues">GitHub issues</a>. As always, bugs are welcome :)</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html&amp;text=Mocking+of+HTTP+Server+in+Java" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html%3F2014-15&amp;title=Mocking+of+HTTP+Server+in+Java" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/04/18/jcabi-http-server-mocking.html%3F2014-15&amp;t=Mocking+of+HTTP+Server+in+Java" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class="badge"><a href="http://http.jcabi.com"><img src="http://img.jcabi.com/logo-square.svg" style="width:64px;max-width:100%;" alt="badge" /></a></figure><p>Recently, I explained a <a href="/2014/04/11/jcabi-http-intro.html">fluent Java HTTP client</a> created (mostly) to make HTTP interactions more object-oriented than with other available clients,including: <a href="http://hc.apache.org/httpclient-3.x/">Apache Client</a>, <a href="https://jersey.java.net/documentation/latest/client.html">Jersey Client</a> and plain old <a href="http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html"><code>HttpURLConnection</code></a>.</p><p>This client ships in the <a href="http://http.jcabi.com">jcabi-http</a> Maven artifact. However, the client part is not the only benefit of using <a href="http://http.jcabi.com">jcabi-http</a>. Jcabi also includes a server component that can help you in unit and integration testing of your HTTP clients.</p><p>Let me show you an example first. In the example, I’m using <a href="https://github.com/hamcrest">hamcrest</a> for assertions.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">MkContainer</span> <span class="n">container</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MkGrizzlyContainer</span><span class="o">()</span>
  <span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="k">new</span> <span class="n">MkAnswer</span><span class="o">.</span><span class="na">Simple</span><span class="o">(</span><span class="s">&quot;hello, world!&quot;</span><span class="o">))</span>
  <span class="o">.</span><span class="na">start</span><span class="o">();</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="k">new</span> <span class="n">JdkRequest</span><span class="o">(</span><span class="n">container</span><span class="o">.</span><span class="na">home</span><span class="o">())</span>
    <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">,</span> <span class="s">&quot;Myself&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">fetch</span><span class="o">()</span>
    <span class="o">.</span><span class="na">assertBody</span><span class="o">(</span><span class="n">Matchers</span><span class="o">.</span><span class="na">containsString</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">));</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
  <span class="n">container</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="o">}</span>
<span class="n">MkQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">take</span><span class="o">();</span>
<span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
  <span class="n">query</span><span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">),</span>
  <span class="n">Matchers</span><span class="o">.</span><span class="na">hasItem</span><span class="o">(</span><span class="s">&quot;Myself&quot;</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>Now, let’s discover what happens here.</p><p>In the first few lines, I create an instance of <a href="http://http.jcabi.com/apidocs-1.1/com/jcabi/http/mock/MkContainer.html"><code>MkContainer</code></a>, which literally has four methods: <code>next(MkAnswer)</code>, <code>start()</code>, <code>stop()</code>, and <code>home()</code>.</p><p>It works as an HTTP server with a “first-in-first-out” queue for HTTP answers. We add answers, and the server returns them in response to HTTP requests.</p><p>The server starts on <code>start()</code> call and stops on <code>stop()</code>. Its method <code>home()</code> returns a URL of its “home page.” The server then binds itself to a randomly allocated TCP port.</p><p>The container finds the first available and unoccupied port.</p><p>In the example above, I added just one answer. This means that the container will reply only to the first HTTP request with that answer and that all consecutive requests will cause HTTP responses with status “internal server error <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">500</a>.”</p><p>In lines 5 through 8, I make an HTTP request to the already started server. Also, I make an assertion that the body of the HTTP response contains the text <code>"hello"</code>. Obviously, this assertion will pass because the server will return <code>"hello, world!"</code> to my first request:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="k">new</span> <span class="n">JdkRequest</span><span class="o">(</span><span class="n">container</span><span class="o">.</span><span class="na">home</span><span class="o">())</span>
  <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">,</span> <span class="s">&quot;Myself&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">fetch</span><span class="o">()</span>
  <span class="o">.</span><span class="na">assertBody</span><span class="o">(</span><span class="n">Matchers</span><span class="o">.</span><span class="na">containsString</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">));</span></code></pre></figure><p>As you can see, I use <code>container.home()</code> in order to get the URL of the server. It is recommended that you allow the container to find the first unoccupied TCP port and bind itself to it. Nevertheless, if you need to specify your own port, you can do it with a one-argument method <a href="http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkContainer.html#start%28int%29"><code>start(int)</code></a> in <code>MkContainer</code>.</p><p>I use <code>try/finally</code> to stop the container safely. In unit tests, this is not critical, as you can simplify your code and never stop the container. Besides, the container will be killed together with the JVM. However, for the sake of clarity, I would recommend you stop the container in the <code>finally</code> block.</p><p>On line 12, I ask the stopped container to give me the first request it received. This mechanism is similar conceptually to the “verify” technology of mocking frameworks. For example, <a href="http://mockito.org/">Mockito</a>.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">MkQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="n">container</span><span class="o">.</span><span class="na">take</span><span class="o">();</span>
<span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
  <span class="n">query</span><span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;User-agent&quot;</span><span class="o">),</span>
  <span class="n">Matchers</span><span class="o">.</span><span class="na">hasItem</span><span class="o">(</span><span class="s">&quot;Myself&quot;</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>An instance of <a href="http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkQuery.html"><code>MkQuery</code></a> exposes information about the query made. In this example, I get all headers of the HTTP request and making an assertion that the<code>"User-Agent"</code> header was there and had at least one value equal to <code>"Myself"</code>.</p><p>This mocking technology is used actively in unit and integration tests of <a href="http://github.com/jcabi/jcabi-github">jcabi-github</a>, which is a Java client to GitHub API. In its development, the technology is very important in checking which requests are being sent to the server and validating whether they comply with our requirements. Here, we are using <a href="http://http.jcabi.com">jcabi-http</a> mocking.</p><p>As with the client, you need the <a href="http://repo1.maven.org/maven2/com/jcabi/jcabi-http"><code>jcabi-http.jar</code></a> dependency (get its latest versions in <a href="http://search.maven.org/">Maven Central</a>):</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.jcabi<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>jcabi-http<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure><p>Besides the above, you need to add one more dependency, which is a Grizzly HTTP server. <a href="http://http.jcabi.com/apidocs-1.3/com/jcabi/http/mock/MkGrizzlyContainer.html"><code>MkGrizzlyContainer</code></a> is based on it.</p><figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.sun.grizzly<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>grizzly-servlet-webserver<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></figure><p>If you have any questions or suggestions, please submit them through <a href="http://github.com/jcabi/jcabi-http/issues">GitHub issues</a>. As always, bugs are welcome :)</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, image, jb_picture, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-04-13 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Bugs Are Welcome"/> <meta name="twitter:description" property="og:description" content="&lt;p&gt;The traditional understanding of a software defect (aka “bug”) is that it is something negative and want to avoid in our projects. We want our projects to be “bug-free.” Our customers are asking us to develop software that doesn’t have bugs. And, we, as users, expect software to work without bugs.&lt;/p&gt; &lt;figure class=&quot;jb_picture&quot;&gt;&lt;img itemprop=&quot;image&quot; alt=&quot;Charlie and the Chocolate Factory (2005) by Tim Burton&quot; src=&quot;/images/2014/04/charlie-and-chocolate-factory-chewing-breakfast.png&quot; longdesc=&quot;#75a0d776&quot; /&gt;&lt;figcaption id=&quot;75a0d776&quot;&gt;Charlie and the Chocolate Factory (2005) by Tim Burton&lt;/figcaption&gt;&lt;/figure&gt; &lt;p&gt;But, let’s take a look at bugs from a different angle. In &lt;a href=&quot;https://www.xdsd.org&quot;&gt;XDSD&lt;/a&gt;, we say that “bugs are welcome.” This means we encourage all interested parties to find bugs and report them. We want our team to see bugs as something that we need in our projects. Why?&lt;/p&gt; &lt;!--more--&gt; &lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;https://www.xdsd.org&quot;&gt;&lt;img src=&quot;https://www.xdsd.org/images/logo.svg&quot; style=&quot;width:100px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;Because we understand that there are two categories of bugs: visible and hidden. The more bugs that become visible, the more of them we can fix. More fixed bugs means fewer to annoy our users. By discovering bugs we make them visible.&lt;/p&gt; &lt;p&gt;This is the primary job of a software tester—to make bugs visible.&lt;/p&gt; &lt;aside class=&quot;youtube&quot;&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=7DYr8GYzJ6Q&quot;&gt;&lt;div class=&quot;box&quot;&gt; &lt;img src=&quot;https://i.ytimg.com/vi/7DYr8GYzJ6Q/mqdefault.jpg&quot; alt=&quot;YouTube video #7DYr8GYzJ6Q&quot; /&gt; &lt;div class=&quot;play&quot;&gt;&lt;i class=&quot;icon icon-play&quot;&gt;&lt;/i&gt;&lt;/div&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt;The Philosophy of Bugs (webinar #17); 3 August 2016.&lt;/div&gt;&lt;/aside&gt; &lt;p&gt;Obviously, their visibility affects the &lt;a href=&quot;/2017/12/26/software-quality-formula.html&quot;&gt;quality of the product&lt;/a&gt; in a positive way. This is because we can fix them before our users start complaining.&lt;/p&gt; &lt;p&gt;In order to motivate all team members to make more bugs visible, we pay for their discovery. In &lt;a href=&quot;https://www.xdsd.org&quot;&gt;XDSD&lt;/a&gt; projects, we are pay 15 minutes for every bug found (no matter who finds them and where.)&lt;/p&gt; &lt;h2 id=&quot;we-plan-bugs&quot;&gt;We Plan Bugs&lt;/h2&gt; &lt;p&gt;We go even further. At &lt;a href=&quot;https://www.xdsd.org&quot;&gt;XDSD&lt;/a&gt;, we plan for a number of hidden bugs in every project. We do this by using our experience with previous projects and expert judgment.&lt;/p&gt; &lt;p&gt;Let’s say we’re starting to develop a web system, which is similar to the one we worked on last year. We know that in the previous project our users and team together reported 500 bugs.&lt;/p&gt; &lt;aside class=&quot;youtube&quot;&gt; &lt;a href=&quot;https://www.youtube.com/watch?v=qRZYJGYdrwk&quot;&gt;&lt;div class=&quot;box&quot;&gt; &lt;img src=&quot;https://i.ytimg.com/vi/qRZYJGYdrwk/mqdefault.jpg&quot; alt=&quot;YouTube video #qRZYJGYdrwk&quot; /&gt; &lt;div class=&quot;play&quot;&gt;&lt;i class=&quot;icon icon-play&quot;&gt;&lt;/i&gt;&lt;/div&gt; &lt;/div&gt;&lt;/a&gt; &lt;div&gt;XDSD: management without meetings; 13 February 2016.&lt;/div&gt;&lt;/aside&gt; &lt;p&gt;It’s logical to assume that the new project will have a similar number of bugs. Thus, our task is to make those 500 bugs visible before they hit the production platform and our users call us to complain about them. Therefore, we’re making it one of the project goals: “discover 500 bugs.”&lt;/p&gt; &lt;p&gt;Of course, our estimate may be wrong. Nevertheless, we have historical records for a few dozen projects, and in all of them the number is close to 500. So, finding 500 bugs in a project is usually a reality—we can use it as a target.&lt;/p&gt; &lt;h2 id=&quot;what-is-a-bug&quot;&gt;What Is a Bug?&lt;/h2&gt; &lt;p&gt;Let us try to define a bug (or software defect) in a non-ambiguous manner. Something can be reported as a bug and subsequently paid for &lt;a href=&quot;https://en.wikipedia.org/wiki/If_and_only_if&quot;&gt;iff&lt;/a&gt;:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;it is &lt;a href=&quot;http://en.wikipedia.org/wiki/Reproducibility&quot;&gt;reproducible&lt;/a&gt;&lt;/li&gt; &lt;li&gt;it refers to functionality already implemented&lt;/li&gt; &lt;li&gt;it can be fixed in a reasonable amount of time&lt;/li&gt; &lt;li&gt;it doesn’t duplicate a bug already reported&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Reproducibility of a bug is very important. Consequently, it is the responsibility of a &lt;a href=&quot;/2018/04/24/right-way-to-report-bugs.html&quot;&gt;bug reporter&lt;/a&gt; to make sure the bug is reproducible. Until it is proven that the bug can be reproduced—it’s not a bug for which payment can be made.&lt;/p&gt; &lt;p&gt;A bug is not a task; it has to refer to an existing functionality. Additionally, an explanation must exist for how and when the existing functionality doesn’t work as expected.&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/04/13/bugs-are-welcome.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2014/04/13/bugs-are-welcome.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/04/13/bugs-are-welcome.amp.html" /> <title>Bugs Are Welcome </title> <meta name='og:image' content='https://www.yegor256.com/images/2014/04/charlie-and-chocolate-factory-chewing-breakfast.png'/><meta name='twitter:image' content='https://www.yegor256.com/images/2014/04/charlie-and-chocolate-factory-chewing-breakfast.png'/><meta name='og:image:width' content='847'/> <meta name='twitter:image:width' content='847'/><meta name='og:image:height' content='449'/> <meta name='twitter:image:height' content='449'/><meta name='twitter:card' content='summary'/><meta name='twitter:image:alt' content='Charlie and the Chocolate Factory (2005) by Tim Burton'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2014/04/13/bugs-are-welcome.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2014/04/13/bugs-are-welcome.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/04/13/bugs-are-welcome.html</code></p><h1 itemprop="name headline mainEntityOfPage">Bugs Are Welcome</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-04-13T00:00:00+00:00"> 13 April 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/04/13/bugs-are-welcome.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><p>The traditional understanding of a software defect (aka “bug”) is that it is something negative and want to avoid in our projects. We want our projects to be “bug-free.” Our customers are asking us to develop software that doesn’t have bugs. And, we, as users, expect software to work without bugs.</p><figure class="jb_picture"><img itemprop="image" alt="Charlie and the Chocolate Factory (2005) by Tim Burton" src="/images/2014/04/charlie-and-chocolate-factory-chewing-breakfast.png" longdesc="#75a0d776" /><figcaption id="75a0d776">Charlie and the Chocolate Factory (2005) by Tim Burton</figcaption></figure><p>But, let’s take a look at bugs from a different angle. In <a href="https://www.xdsd.org">XDSD</a>, we say that “bugs are welcome.” This means we encourage all interested parties to find bugs and report them. We want our team to see bugs as something that we need in our projects. Why?</p><figure class="badge"><a href="https://www.xdsd.org"><img src="https://www.xdsd.org/images/logo.svg" style="width:100px;max-width:100%;" alt="badge" /></a></figure><p>Because we understand that there are two categories of bugs: visible and hidden. The more bugs that become visible, the more of them we can fix. More fixed bugs means fewer to annoy our users. By discovering bugs we make them visible.</p><p>This is the primary job of a software tester—to make bugs visible.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=7DYr8GYzJ6Q"><div class="box"> <img src="https://i.ytimg.com/vi/7DYr8GYzJ6Q/mqdefault.jpg" alt="YouTube video #7DYr8GYzJ6Q" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>The Philosophy of Bugs (webinar #17); 3 August 2016.</div></aside><p>Obviously, their visibility affects the <a href="/2017/12/26/software-quality-formula.html">quality of the product</a> in a positive way. This is because we can fix them before our users start complaining.</p><p>In order to motivate all team members to make more bugs visible, we pay for their discovery. In <a href="https://www.xdsd.org">XDSD</a> projects, we are pay 15 minutes for every bug found (no matter who finds them and where.)</p><h2 id="we-plan-bugs">We Plan Bugs</h2><p>We go even further. At <a href="https://www.xdsd.org">XDSD</a>, we plan for a number of hidden bugs in every project. We do this by using our experience with previous projects and expert judgment.</p><p>Let’s say we’re starting to develop a web system, which is similar to the one we worked on last year. We know that in the previous project our users and team together reported 500 bugs.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=qRZYJGYdrwk"><div class="box"> <img src="https://i.ytimg.com/vi/qRZYJGYdrwk/mqdefault.jpg" alt="YouTube video #qRZYJGYdrwk" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>XDSD: management without meetings; 13 February 2016.</div></aside><p>It’s logical to assume that the new project will have a similar number of bugs. Thus, our task is to make those 500 bugs visible before they hit the production platform and our users call us to complain about them. Therefore, we’re making it one of the project goals: “discover 500 bugs.”</p><p>Of course, our estimate may be wrong. Nevertheless, we have historical records for a few dozen projects, and in all of them the number is close to 500. So, finding 500 bugs in a project is usually a reality—we can use it as a target.</p><h2 id="what-is-a-bug">What Is a Bug?</h2><p>Let us try to define a bug (or software defect) in a non-ambiguous manner. Something can be reported as a bug and subsequently paid for <a href="https://en.wikipedia.org/wiki/If_and_only_if">iff</a>:</p><ul> <li>it is <a href="http://en.wikipedia.org/wiki/Reproducibility">reproducible</a></li> <li>it refers to functionality already implemented</li> <li>it can be fixed in a reasonable amount of time</li> <li>it doesn’t duplicate a bug already reported</li></ul><p>Reproducibility of a bug is very important. Consequently, it is the responsibility of a <a href="/2018/04/24/right-way-to-report-bugs.html">bug reporter</a> to make sure the bug is reproducible. Until it is proven that the bug can be reproduced—it’s not a bug for which payment can be made.</p><p>A bug is not a task; it has to refer to an existing functionality. Additionally, an explanation must exist for how and when the existing functionality doesn’t work as expected.</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html&amp;text=Bugs+Are+Welcome" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html%3F2014-15&amp;title=Bugs+Are+Welcome" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/04/13/bugs-are-welcome.html%3F2014-15&amp;t=Bugs+Are+Welcome" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>The traditional understanding of a software defect (aka “bug”) is that it is something negative and want to avoid in our projects. We want our projects to be “bug-free.” Our customers are asking us to develop software that doesn’t have bugs. And, we, as users, expect software to work without bugs.</p><figure class="jb_picture"><img itemprop="image" alt="Charlie and the Chocolate Factory (2005) by Tim Burton" src="/images/2014/04/charlie-and-chocolate-factory-chewing-breakfast.png" longdesc="#75a0d776" /><figcaption id="75a0d776">Charlie and the Chocolate Factory (2005) by Tim Burton</figcaption></figure><p>But, let’s take a look at bugs from a different angle. In <a href="https://www.xdsd.org">XDSD</a>, we say that “bugs are welcome.” This means we encourage all interested parties to find bugs and report them. We want our team to see bugs as something that we need in our projects. Why?</p><figure class="badge"><a href="https://www.xdsd.org"><img src="https://www.xdsd.org/images/logo.svg" style="width:100px;max-width:100%;" alt="badge" /></a></figure><p>Because we understand that there are two categories of bugs: visible and hidden. The more bugs that become visible, the more of them we can fix. More fixed bugs means fewer to annoy our users. By discovering bugs we make them visible.</p><p>This is the primary job of a software tester—to make bugs visible.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=7DYr8GYzJ6Q"><div class="box"> <img src="https://i.ytimg.com/vi/7DYr8GYzJ6Q/mqdefault.jpg" alt="YouTube video #7DYr8GYzJ6Q" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>The Philosophy of Bugs (webinar #17); 3 August 2016.</div></aside><p>Obviously, their visibility affects the <a href="/2017/12/26/software-quality-formula.html">quality of the product</a> in a positive way. This is because we can fix them before our users start complaining.</p><p>In order to motivate all team members to make more bugs visible, we pay for their discovery. In <a href="https://www.xdsd.org">XDSD</a> projects, we are pay 15 minutes for every bug found (no matter who finds them and where.)</p><h2 id="we-plan-bugs">We Plan Bugs</h2><p>We go even further. At <a href="https://www.xdsd.org">XDSD</a>, we plan for a number of hidden bugs in every project. We do this by using our experience with previous projects and expert judgment.</p><p>Let’s say we’re starting to develop a web system, which is similar to the one we worked on last year. We know that in the previous project our users and team together reported 500 bugs.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=qRZYJGYdrwk"><div class="box"> <img src="https://i.ytimg.com/vi/qRZYJGYdrwk/mqdefault.jpg" alt="YouTube video #qRZYJGYdrwk" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>XDSD: management without meetings; 13 February 2016.</div></aside><p>It’s logical to assume that the new project will have a similar number of bugs. Thus, our task is to make those 500 bugs visible before they hit the production platform and our users call us to complain about them. Therefore, we’re making it one of the project goals: “discover 500 bugs.”</p><p>Of course, our estimate may be wrong. Nevertheless, we have historical records for a few dozen projects, and in all of them the number is close to 500. So, finding 500 bugs in a project is usually a reality—we can use it as a target.</p><h2 id="what-is-a-bug">What Is a Bug?</h2><p>Let us try to define a bug (or software defect) in a non-ambiguous manner. Something can be reported as a bug and subsequently paid for <a href="https://en.wikipedia.org/wiki/If_and_only_if">iff</a>:</p><ul> <li>it is <a href="http://en.wikipedia.org/wiki/Reproducibility">reproducible</a></li> <li>it refers to functionality already implemented</li> <li>it can be fixed in a reasonable amount of time</li> <li>it doesn’t duplicate a bug already reported</li></ul><p>Reproducibility of a bug is very important. Consequently, it is the responsibility of a <a href="/2018/04/24/right-way-to-report-bugs.html">bug reporter</a> to make sure the bug is reproducible. Until it is proven that the bug can be reproduced—it’s not a bug for which payment can be made.</p><p>A bug is not a task; it has to refer to an existing functionality. Additionally, an explanation must exist for how and when the existing functionality doesn’t work as expected.</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> <!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="" /> <meta name="keywords" content="next, path, output, content, previous, url, relative_path, id, collection, excerpt, draft, categories, layout, title, date, tags, description, keywords, slug, ext" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-04-06 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="PhantomJS as an HTML Validator"/> <meta name="twitter:description" property="og:description" content="&lt;figure class=&quot;badge&quot;&gt;&lt;a href=&quot;http://www.phandom.org&quot;&gt;&lt;img src=&quot;http://img.phandom.org/logo-256x256.png&quot; style=&quot;width:64px;max-width:100%;&quot; alt=&quot;badge&quot; /&gt;&lt;/a&gt;&lt;/figure&gt; &lt;p&gt;I created &lt;a href=&quot;http://www.phandom.org&quot;&gt;phandom.org&lt;/a&gt; a few months ago, but yesterday finally found the time to make some needed changes to it. So, now is a good time to explain how I’m using Phandom in some of my unit tests.&lt;/p&gt; &lt;p&gt;Before I get started, though, I should say a few words about &lt;a href=&quot;http://phantomjs.org/&quot;&gt;&lt;code&gt;phantomjs&lt;/code&gt;&lt;/a&gt;, which is a JavaScript interface for WebKit. WebKit, on the other hand, is a web browser without a user interface. WebKit is a C++ library that enables manipulation of HTML content, through DOM calls. For example, this is a simple JavaScript located code in &lt;code&gt;example.js&lt;/code&gt;:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;page&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;webpage&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://google.com&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loaded!&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;phantom&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;We run &lt;code&gt;phantomjs&lt;/code&gt; from the command line with the following code:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span&gt;&lt;/span&gt;$ phantomjs example.js&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;PhantomJS creates a &lt;code&gt;page&lt;/code&gt; object (provided by &lt;a href=&quot;https://github.com/ariya/phantomjs/wiki/API-Reference-WebPage&quot;&gt;webpage&lt;/a&gt; module inside &lt;code&gt;phantomjs&lt;/code&gt;), and then asks it to &lt;code&gt;open()&lt;/code&gt; a Web page. The object communicates with WebKit and converts this call into DOM instructions. After which, the page loads. The PhantomJS engine then terminates on line 6.&lt;/p&gt; &lt;!--more--&gt; &lt;p&gt;WebKit renders a web page with all necessary components such as CSS, JavaScript, ActionScript, etc, just as any standard Web browser would.&lt;/p&gt; &lt;p&gt;So far so good, and this is the traditional way of using PhantomJS. Now, on to giving you an idea of how &lt;a href=&quot;http://www.phandom.org&quot;&gt;Phandom&lt;/a&gt; (which stands for “PhantomJS DOM”) works inside Java unit tests:&lt;/p&gt; &lt;p&gt;To test this, let’s give &lt;code&gt;phantomjs&lt;/code&gt; an HTML page and ask him to render it. When the page is ready, we’ll ask &lt;code&gt;phantomjs&lt;/code&gt; to show us how this HTML looks in WebKit. If we see the elements we need and desire,—we’re good to go. Let’s use the following example:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.rexsl.test.XhtmlMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.hamcrest.MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.phandom.Phandom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DocumentTest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rendersValidHtml&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Document&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Document&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// This is the method we&amp;#39;re testing. It is supposed&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// to return a valid HTML without broken JavaScript&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// and with all required HTML elements.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MatcherAssert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assertThat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XhtmlMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;xhtml&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Phandom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;dom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XhtmlMatchers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;hasXPath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;//p[.=&amp;#39;Hello, world!&amp;#39;]&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;When we use the above code, here is what happens. First, we get HTML &lt;code&gt;html&lt;/code&gt; as a &lt;code&gt;String&lt;/code&gt; from &lt;code&gt;doc&lt;/code&gt; object, and then pass it to &lt;a href=&quot;http://www.phandom.org/apidocs-0.2.1/org/phandom/Phandom.html&quot;&gt;&lt;code&gt;Phandom&lt;/code&gt;&lt;/a&gt; as an argument. Then, on line 13, we call the &lt;code&gt;Phandom.dom()&lt;/code&gt; method to get an instance of the class &lt;code&gt;org.w3c.dom.Document&lt;/code&gt;.&lt;/p&gt; &lt;p&gt;If our HTML contains any broken JavaScript code, method &lt;code&gt;dom()&lt;/code&gt; produces a runtime exception and the unit test fail. If HTML is clean and WebKit is able to render it without problems, the test passes.&lt;/p&gt; &lt;p&gt;I’m using this mechanism in a few different projects,and it works quite well. Therefore, I highly recommend it.&lt;/p&gt; &lt;p&gt;Of course, you shouldn’t forget that you must have &lt;code&gt;phantomjs&lt;/code&gt; installed on your build machine. In order to avoid unit test failures when &lt;code&gt;phantomjs&lt;/code&gt; is not available or present, I’ve created the following supplementary method:&lt;/p&gt; &lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DocumentTest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nd&quot;&gt;@Test&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rendersValidHtml&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Assume&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;assumeTrue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Phandom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;installed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// the rest of the unit test method body...&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt; &lt;p&gt;Enjoy and feel free to report any bugs or problems you encounter to: &lt;a href=&quot;https://github.com/yegor256/phandom/issues&quot;&gt;GitHub issues&lt;/a&gt; :)&lt;/p&gt; "/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/04/06/phandom.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?c401938d07c"/> <link rel="apple-touch-icon" href="/favicon.ico?c401938d07c"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?c401938d07c"/> <link rel="stylesheet" href="/css/icons.css?c401938d07c"/> <link rel="canonical" href="https://www.yegor256.com/2014/04/06/phandom.html" /> <link rel="amphtml" href="https://www.yegor256.com/2014/04/06/phandom.amp.html" /> <title>PhantomJS as an HTML Validator </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li /2014/04/06/phandom.html><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li /2014/04/06/phandom.html><a href="/contents.html" title="The contents of the entire blog">All&#160;292</a></li> <li /2014/04/06/phandom.html><a href="/webinars.html" title="My webinars">Webinars</a></li> <li /2014/04/06/phandom.html><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li /2014/04/06/phandom.html><a href="/books.html" title="The books I wrote">Books</a></li> <li /2014/04/06/phandom.html><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li /2014/04/06/phandom.html><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li /2014/04/06/phandom.html class="highlighted"><a href="/trainings.html" title="On-site trainings">Trainings</a></li> <li /2014/04/06/phandom.html><a href="/award.html" title="Software quality award">Award</a></li> <li /2014/04/06/phandom.html><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li /2014/04/06/phandom.html><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li /2014/04/06/phandom.html><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/04/06/phandom.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/04/06/phandom.html</code></p><h1 itemprop="name headline mainEntityOfPage">PhantomJS as an HTML Validator</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-04-06T00:00:00+00:00"> 6 April 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/04/06/phandom.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><figure class="badge"><a href="http://www.phandom.org"><img src="http://img.phandom.org/logo-256x256.png" style="width:64px;max-width:100%;" alt="badge" /></a></figure><p>I created <a href="http://www.phandom.org">phandom.org</a> a few months ago, but yesterday finally found the time to make some needed changes to it. So, now is a good time to explain how I’m using Phandom in some of my unit tests.</p><p>Before I get started, though, I should say a few words about <a href="http://phantomjs.org/"><code>phantomjs</code></a>, which is a JavaScript interface for WebKit. WebKit, on the other hand, is a web browser without a user interface. WebKit is a C++ library that enables manipulation of HTML content, through DOM calls. For example, this is a simple JavaScript located code in <code>example.js</code>:</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kd">var</span> <span class="nx">page</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpage&#39;</span><span class="p">).</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">page</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span>
  <span class="s1">&#39;http://google.com&#39;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;loaded!&#39;</span><span class="p">);</span>
    <span class="nx">phantom</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">);</span></code></pre></figure><p>We run <code>phantomjs</code> from the command line with the following code:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ phantomjs example.js</code></pre></figure><p>PhantomJS creates a <code>page</code> object (provided by <a href="https://github.com/ariya/phantomjs/wiki/API-Reference-WebPage">webpage</a> module inside <code>phantomjs</code>), and then asks it to <code>open()</code> a Web page. The object communicates with WebKit and converts this call into DOM instructions. After which, the page loads. The PhantomJS engine then terminates on line 6.</p><p>WebKit renders a web page with all necessary components such as CSS, JavaScript, ActionScript, etc, just as any standard Web browser would.</p><p>So far so good, and this is the traditional way of using PhantomJS. Now, on to giving you an idea of how <a href="http://www.phandom.org">Phandom</a> (which stands for “PhantomJS DOM”) works inside Java unit tests:</p><p>To test this, let’s give <code>phantomjs</code> an HTML page and ask him to render it. When the page is ready, we’ll ask <code>phantomjs</code> to show us how this HTML looks in WebKit. If we see the elements we need and desire,—we’re good to go. Let’s use the following example:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">com.rexsl.test.XhtmlMatchers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hamcrest.MatcherAssert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.phandom.Phandom</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentTest</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rendersValidHtml</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Document</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Document</span><span class="o">();</span>
    <span class="c1">// This is the method we&#39;re testing. It is supposed</span>
    <span class="c1">// to return a valid HTML without broken JavaScript</span>
    <span class="c1">// and with all required HTML elements.</span>
    <span class="n">String</span> <span class="n">html</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="na">html</span><span class="o">();</span>
    <span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
      <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">xhtml</span><span class="o">(</span><span class="k">new</span> <span class="n">Phandom</span><span class="o">(</span><span class="n">html</span><span class="o">).</span><span class="na">dom</span><span class="o">()),</span>
      <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">hasXPath</span><span class="o">(</span><span class="s">&quot;//p[.=&#39;Hello, world!&#39;]&quot;</span><span class="o">)</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>When we use the above code, here is what happens. First, we get HTML <code>html</code> as a <code>String</code> from <code>doc</code> object, and then pass it to <a href="http://www.phandom.org/apidocs-0.2.1/org/phandom/Phandom.html"><code>Phandom</code></a> as an argument. Then, on line 13, we call the <code>Phandom.dom()</code> method to get an instance of the class <code>org.w3c.dom.Document</code>.</p><p>If our HTML contains any broken JavaScript code, method <code>dom()</code> produces a runtime exception and the unit test fail. If HTML is clean and WebKit is able to render it without problems, the test passes.</p><p>I’m using this mechanism in a few different projects,and it works quite well. Therefore, I highly recommend it.</p><p>Of course, you shouldn’t forget that you must have <code>phantomjs</code> installed on your build machine. In order to avoid unit test failures when <code>phantomjs</code> is not available or present, I’ve created the following supplementary method:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentTest</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rendersValidHtml</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Assume</span><span class="o">.</span><span class="na">assumeTrue</span><span class="o">(</span><span class="n">Phandom</span><span class="o">.</span><span class="na">installed</span><span class="o">());</span>
    <span class="c1">// the rest of the unit test method body...</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Enjoy and feel free to report any bugs or problems you encounter to: <a href="https://github.com/yegor256/phandom/issues">GitHub issues</a> :)</p></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/04/06/phandom.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/04/06/phandom.html&amp;text=PhantomJS+as+an+HTML+Validator" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=https://www.yegor256.com/2014/04/06/phandom.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/04/06/phandom.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2014/04/06/phandom.html%3F2014-14&amp;title=PhantomJS+as+an+HTML+Validator" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/04/06/phandom.html%3F2014-14&amp;t=PhantomJS+as+an+HTML+Validator" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div > <figure class="badge"><a href="http://www.phandom.org"><img src="http://img.phandom.org/logo-256x256.png" style="width:64px;max-width:100%;" alt="badge" /></a></figure><p>I created <a href="http://www.phandom.org">phandom.org</a> a few months ago, but yesterday finally found the time to make some needed changes to it. So, now is a good time to explain how I’m using Phandom in some of my unit tests.</p><p>Before I get started, though, I should say a few words about <a href="http://phantomjs.org/"><code>phantomjs</code></a>, which is a JavaScript interface for WebKit. WebKit, on the other hand, is a web browser without a user interface. WebKit is a C++ library that enables manipulation of HTML content, through DOM calls. For example, this is a simple JavaScript located code in <code>example.js</code>:</p><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kd">var</span> <span class="nx">page</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;webpage&#39;</span><span class="p">).</span><span class="nx">create</span><span class="p">();</span>
<span class="nx">page</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span>
  <span class="s1">&#39;http://google.com&#39;</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;loaded!&#39;</span><span class="p">);</span>
    <span class="nx">phantom</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">);</span></code></pre></figure><p>We run <code>phantomjs</code> from the command line with the following code:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>$ phantomjs example.js</code></pre></figure><p>PhantomJS creates a <code>page</code> object (provided by <a href="https://github.com/ariya/phantomjs/wiki/API-Reference-WebPage">webpage</a> module inside <code>phantomjs</code>), and then asks it to <code>open()</code> a Web page. The object communicates with WebKit and converts this call into DOM instructions. After which, the page loads. The PhantomJS engine then terminates on line 6.</p><p>WebKit renders a web page with all necessary components such as CSS, JavaScript, ActionScript, etc, just as any standard Web browser would.</p><p>So far so good, and this is the traditional way of using PhantomJS. Now, on to giving you an idea of how <a href="http://www.phandom.org">Phandom</a> (which stands for “PhantomJS DOM”) works inside Java unit tests:</p><p>To test this, let’s give <code>phantomjs</code> an HTML page and ask him to render it. When the page is ready, we’ll ask <code>phantomjs</code> to show us how this HTML looks in WebKit. If we see the elements we need and desire,—we’re good to go. Let’s use the following example:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kn">import</span> <span class="nn">com.rexsl.test.XhtmlMatchers</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hamcrest.MatcherAssert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.phandom.Phandom</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentTest</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rendersValidHtml</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Document</span> <span class="n">doc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Document</span><span class="o">();</span>
    <span class="c1">// This is the method we&#39;re testing. It is supposed</span>
    <span class="c1">// to return a valid HTML without broken JavaScript</span>
    <span class="c1">// and with all required HTML elements.</span>
    <span class="n">String</span> <span class="n">html</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="na">html</span><span class="o">();</span>
    <span class="n">MatcherAssert</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span>
      <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">xhtml</span><span class="o">(</span><span class="k">new</span> <span class="n">Phandom</span><span class="o">(</span><span class="n">html</span><span class="o">).</span><span class="na">dom</span><span class="o">()),</span>
      <span class="n">XhtmlMatchers</span><span class="o">.</span><span class="na">hasXPath</span><span class="o">(</span><span class="s">&quot;//p[.=&#39;Hello, world!&#39;]&quot;</span><span class="o">)</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>When we use the above code, here is what happens. First, we get HTML <code>html</code> as a <code>String</code> from <code>doc</code> object, and then pass it to <a href="http://www.phandom.org/apidocs-0.2.1/org/phandom/Phandom.html"><code>Phandom</code></a> as an argument. Then, on line 13, we call the <code>Phandom.dom()</code> method to get an instance of the class <code>org.w3c.dom.Document</code>.</p><p>If our HTML contains any broken JavaScript code, method <code>dom()</code> produces a runtime exception and the unit test fail. If HTML is clean and WebKit is able to render it without problems, the test passes.</p><p>I’m using this mechanism in a few different projects,and it works quite well. Therefore, I highly recommend it.</p><p>Of course, you shouldn’t forget that you must have <code>phantomjs</code> installed on your build machine. In order to avoid unit test failures when <code>phantomjs</code> is not available or present, I’ve created the following supplementary method:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DocumentTest</span> <span class="o">{</span>
  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">rendersValidHtml</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">Assume</span><span class="o">.</span><span class="na">assumeTrue</span><span class="o">(</span><span class="n">Phandom</span><span class="o">.</span><span class="na">installed</span><span class="o">());</span>
    <span class="c1">// the rest of the unit test method body...</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Enjoy and feel free to report any bugs or problems you encounter to: <a href="https://github.com/yegor256/phandom/issues">GitHub issues</a> :)</p></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html> </article></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?c401938d07c"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
